{"version":3,"file":"kendo.treelist.min.js","names":["factory","define","amd","$","undefined$1","data","kendo","encode","htmlEncode","kendoDom","dom","kendoDomElement","element","kendoTextElement","text","kendoHtmlElement","html","outerWidth","_outerWidth","keys","outerHeight","_outerHeight","ui","DataBoundWidget","DataSource","ObservableArray","Query","Model","browser","support","kendoTemplate","template","activeElement","_activeElement","touchDevice","touch","isArray","Array","extend","map","grep","inArray","isPlainObject","push","prototype","STRING","CHANGE","ITEM_CHANGE","ERROR","PROGRESS","DOT","NS","CLICK","BEFORE_EDIT","EDIT","PAGE","SAVE","SAVE_CHANGES","EXPAND","COLLAPSE","CELL_CLOSE","REMOVE","DATA_CELL","FILTER_CELL","DATABINDING","DATABOUND","CANCEL","TABINDEX","FILTERMENUINIT","FILTERMENUOPEN","COLUMNHIDE","COLUMNSHOW","COLUMNREORDER","COLUMNRESIZE","COLUMNMENUINIT","COLUMNMENUOPEN","COLUMNLOCK","COLUMNUNLOCK","FILTER","NAVIGATE","SORT","PARENTIDFIELD","DRAGSTART","DRAG","DROP","DRAGEND","NAVROW","NAVCELL","NAVHEADER","NORECORDSCLASS","ITEMROW","isRtl","CHECKBOX","CHECKBOXINPUT","SELECTED","filterRowRegExp","RegExp","classNames","wrapper","header","button","alt","editCell","editRow","dirtyCell","group","toolbar","gridToolbar","gridHeader","gridHeaderWrap","gridContent","gridContentWrap","gridFilter","footerTemplate","focused","loading","refresh","retry","selected","status","link","filterable","icon","iconFilter","iconCollapse","iconExpand","iconHidden","iconPlaceHolder","input","dropPositions","dropTop","dropBottom","dropAdd","dropMiddle","dropDenied","dragStatus","dragClue","dragClueText","headerCellInner","columnTitle","defaultCommands","create","imageClass","className","methodName","createchild","destroy","edit","update","canceledit","cancel","save","excel","pdf","search","ref","message","TreeView","Class","init","options","that","this","defaultParentId","idField","parentIdField","childrenMap","dataItem","dataItemId","dataItemParentId","dataLength","length","_childrenMap","i","idsMap","_idMap","dataMaps","_dataMaps","children","ids","rootNodes","removeCollapsedSubtreesFromRootNodes","prunedTree","result","maxDepth","Infinity","removeCollapsedSubtrees","concat","rootNode","childIdx","expanded","isUndefined","TreeQuery","constructor","process","inPlace","total","filteredChildrenMap","view","prunedData","query","sort","normalizeGroup","normalizeSort","filterCallback","filter","skip","take","toArray","processFromRootNodes","range","TreeListModel","id","parentId","fields","type","nullable","value","fn","call","_loaded","get","accept","set","field","initiator","loaded","shouldSerialize","is","object","not","func","base","model","TreeListDataSource","_getDataMaps","schema","modelBase","_addRange","_createNewModel","fromModel","_modelParentIdField","_isPageable","_shouldWrap","_push","operation","_readData","_getData","_data","newData","toJSON","_replaceData","source","target","sourceLength","_readAggregates","_aggregateResult","reader","aggregates","_defaultParentId","read","_modelOptions","_skip","_page","_collapsedTotal","remove","root","_removeChildData","_removeFromDataMaps","removePristine","pageable","_getChildrenMap","items","_subtree","shouldRemovePristine","removedItems","_removeItems","pushDestroy","insert","index","newModel","_insertInDataMaps","_filterCallback","item","parent","_modelIdField","parentSubtree","_parentNode","unshift","parentNode","len","_observeView","_createTreeView","_initIdsMap","_idsMap","_getIdsMap","_getFilteredChildrenMap","filteredChildren","_setFilteredChildrenMap","_initDataMaps","_initChildrenMapForParent","_defaultTreeModelOptions","modelOptions","_defaultDataItemType","ObservableObject","_calculateAggregates","subtree","pageableChildrenMap","aggregate","bind","_queryProcess","_processPageableQuery","hasLoadedChildren","hasChildren","slice","_processTreeQuery","_replaceWithObservedData","_processDataItemsState","_replaceItemsInDataMaps","dataToAggregate","_dataToAggregate","_replaceInMapWithObservedData","_calculateCollapsedTotal","firstDataItem","_parentNodes","observableArray","parents","directParent","itemType","viewIndex","_insertInIdsMap","_replaceInMap","replacement","itemInArray","itemIndex","indexOf","dataToReplace","replacementArray","itemToReplace","itemToReplaceId","dataItemIndex","observableItem","_getById","at","key","_insertInChildrenMap","itemId","splice","_removeFromIdsMap","_removeFromChildrenMap","_indexInChildrenMap","_itemIndexInMap","dataMap","uid","_isLastItemInView","_defaultPageableQueryOptions","page","pageSize","serverPaging","_updateTotalForAction","action","_updateCollapsedTotalForAction","parseInt","isNaN","_setFilterTotal","filterTotal","setDefaultValue","collapsedTotal","filteredData","_dataWithoutCollapsedSubtrees","_removeCollapsedSubtrees","_processDataItemState","_queueRequest","callback","_modelLoaded","childNodes","_modelError","e","_error","success","requestParams","_observe","_total","load","method","remote","serverSorting","serverFiltering","serverGrouping","serverAggregates","defaultPromise","Deferred","resolve","promise","done","fail","contains","child","rootId","_byParentId","defaultId","current","defaults","allChildNodes","directChildren","_rootNode","_pageableRootNodes","node","nodesWithoutParentInView","_nodesWithoutParentInView","_parentNodesNotInView","_parentInView","level","_pageableModelLevel","baseFilter","_pageableQueryOptions","_flatData","cancelChanges","_restorePageSizeAfterAddChild","_modelCanceled","_changesCanceled","_setAddChildPageSize","queryOptions","_addChildPageSize","_query","sync","then","_syncEnd","isCellVisible","style","display","sortCells","cells","indexAttr","attr","a","b","indexA","indexB","leafDataCells","container","rows","find","el","hasClass","add","last","createPlaceholders","spans","columnsWidth","cols","colWidth","width","idx","TreeListPager","Pager","name","totalPages","dataSource","_filter","Math","ceil","_createDataSource","Editor","Observable","events","_fields","columns","_initContainer","createEditable","renderForm","form","Form","buttonsTemplate","formData","change","editable","Editable","clearContainer","_isEditable","column","isColumnEditable","format","editor","editorOptions","label","title","end","close","empty","removeAttr","PopupEditor","_attachHandlers","cycleForm","open","window","modal","resizable","draggable","visible","formContent","append","_appendTemplate","_appendButtons","Tree","render","appendTo","Window","unescape","class","commandRenderer","closeHandler","_cancelProxy","_cancel","on","_saveProxy","_save","userTriggered","_detachHandlers","off","trigger","center","IncellEditor","TreeList","_events","_dataSource","_aria","_columns","_layout","_navigatable","_selectable","_sortable","_resizable","_filterable","_filterRow","_attachEvents","_toolbar","_scrollable","_reorderable","_columnMenu","_minScreenSupport","_draggable","_pageable","autoBind","fetch","_hasLockedColumns","widget","addClass","_resizeHandler","resize","notify","reorderable","move","_dragging","HierarchicalDragAndDrop","$angular","autoScroll","holdToDrag","itemSelector","allowedContainers","hintText","row","join","destination","dest","src","itemFromTarget","first","tr","closest","prevRow","prev","nextRow","next","sameLevel","content","dragstart","css","drag","drop","removeClass","dragend","originalSrcParentId","originalSrcIndex","position","isPrevented","insertBefore","insertAfter","dropHintContainer","eq","dropPositionFrom","dropHint","contents","dropHintElement","isAfterText","prevAll","nodeType","arguments","nodeData","referenceNode","insertAction","indexOffset","destIndex","nodeDataIndex","originalDestIndex","_unbindDataSource","_unbindDataChange","_destroyed","pop","_bindDataChange","_bindDataSource","_changeHandler","unbind","_refreshHandler","itemFor","tbody","_itemFor","table","lockedContent","lockedTable","scrollable","scrollables","thead","_wheelScroll","scrollLeft","scrollTop","touchScroller","movable","_touchScroller","sender","x","y","ctrlKey","delta","wheelDeltaY","lockedDiv","currentTarget","scrollHeight","clientHeight","preventDefault","one","_progress","messages","_showStatus","_render","error","currentIndex","isCurrentInHeader","_cancelEditor","_adjustHeight","navigatable","_isActiveInTable","max","cellIndex","_restoreCurrent","_checkBoxSelection","_deselectCheckRows","_angularFooters","command","footer","allAggregates","footerRows","_footerItems","_angularFooter","angular","elements","col","_items","dataItems","n","tmp","_showNoRecordsTemplate","scrollableNoGridHeightStyles","height","_contentTree","_lockedContentTree","noRows","hide","_hideStatus","_hideNoRecordsTempalte","show","contentWrap","pagerHeight","pager","scrollbar","initialHeight","newHeight","offsetWidth","clientWidth","_resize","size","force","_applyLockedContainersWidth","hideMinScreenCols","minScreenResizeHandler","_iterateMinScreenCols","screenWidth","any","minWidth","minScreenWidth","hideColumn","showColumn","hidden","innerWidth","screen","_destroyColumnAttachments","_errorHandler","_progressHandler","_navigatableTables","_current","_draggableInstance","selectable","_userEvents","_destroyEditor","_destroyPager","_autoExpandable","_dataSourceFetchProxy","lockedHeader","_statusTree","_headerTree","_lockedHeaderColsTree","_lockedContentColsTree","_lockedHeaderTree","sortable","columnMenu","requestFailed","commands","hierarchy","renderAllRows","rowTemplate","altRowTemplate","getOptions","deepExtend","initialData","transport","setOptions","currentOptions","before","_setEvents","each","th","filterMenu","_toggle","expand","_isIncellEditable","closeCell","afterModelLoaded","_toggleData","_syncLockedContentHeight","always","_togglePageableData","_renderProgress","_refreshPager","collapse","_toggleChildren","event","tables","headerTables","_openHeaderMenu","_tableClick","_tableFocus","_tableBlur","_tableKeyDown","altKey","keyCode","DOWN","click","stopImmediatePropagation","td","lockedColumnOffset","leafColumns","lockedColumns","active","_setCurrent","focusTable","newCurrent","preventTrigger","isIncellEditable","_updateCurrentAttr","_scrollCurrent","_lastCellIndex","tableContainer","isInLockedContainer","isInContent","scrollableContainer","_scrollTo","_relatedRow","_findCurrentCell","elementToLowercase","tagName","toLowerCase","isHorizontal","elementOffsetDir","containerScroll","containerOffsetDir","elementOffset","abs","offsetLeft","bottomDistance","ieCorrection","firefoxCorrection","msie","edge","mozilla","webkit","version","_elementId","_currentDataIndex","lockedColumnsCount","_prevVerticalCell","rowIndex","cellSelector","parentColumnsCells","_nextVerticalCell","childColumnsCells","rowSpan","tmpIndex","currentRowCells","hiddenColumns","_verticalContainer","up","step","floor","headerId","replace","handled","canHandle","isDefaultPrevented","UP","_moveUp","shiftKey","_moveDown","LEFT","RIGHT","_handleExpand","_moveRight","_handleCollapse","_moveLeft","PAGEDOWN","_handlePageDown","PAGEUP","_handlePageUp","ENTER","F2","_handleEnterKey","ESC","_handleEscKey","HOME","_handleHome","END","_handleEnd","TAB","_handleTabKey","stopPropagation","ctrl","rowContainer","isInLockedTable","isInBody","currentTable","blur","cancelRow","has","focusable","_handleEditing","cell","_tabNext","_preventPageSizeRestore","back","switchRow","nextAll","editContainer","isEdited","editedCell","isIE","incellEditing","nextFocusableCellRowIndex","nextFocusableCellIndex","currentFocusedCellRowIndex","currentFocusedCellIndex","opera","triggerHandler","focus","saveRow","isHeader","headerTable","isInput","isInputElement","setTimeout","_setTabIndex","retryButton","UserEvents","press","_onPress","allowSelection","_commandClick","_search","_attachCellEditingEventHandlers","icons","multiple","isLockedCell","clearTimeout","_closeCellTimeout","relatedTarget","_commandByName","j","currentName","commandName","parentsUntil","_searchTimeOut","searchFields","expression","filters","logic","getColumnsFields","operator","_ensureExpandableColumn","expandable","visibleColumns","expandableColumns","encoded","lockedCols","Error","nonLockedColumns","normalizeColumns","_columnTemplates","_columnAttributes","_includeChildren","includeChildren","_checkboxClick","_headerCheckboxClick","dirtyCellTemplate","_createDirtyColumnTemplate","dirtyIndicatorTemplate","_createIndicatorTemplate","headerTemplate","convertStyle","properties","declaration","split","trim","camelCase","attributes","headerAttributes","_clearSortClasses","this$1$1","layoutTemplateFunction","layout","addBack","rtl","_initVirtualTrees","_renderCols","_renderHeader","_headerColsTree","_contentColsTree","buttons","_buildCommands","_lockedColumns","_nonLockedColumns","_templateColumns","_flushCache","_renderOptions","maps","hasFooterTemplate","viewChildrenMap","_dataToRender","_renderedModelLevel","uidAttr","select","_","_absoluteIndex","_angularItems","_clearRenderMap","buttonClass","_viewChildrenMap","_hasFooterTemplate","_trs","editedColumn","editedColumnIndex","contentResized","_muteAngularRebind","_togglePagerVisibility","_setExpanderElement","expander","hiddenDivClass","toggle","progress","parentNotInView","parentNotInViewId","childId","parentsCopy","parentsNotInView","_markNodeAsNonRenderable","parentIndex","_skipRenderingMap","nodeId","_adjustRowsHeight","table1","table2","rows2","containers","containersLength","heights","offsetHeight1","offsetHeight","offsetHeight2","_ths","cellClasses","headerContent","leafs","ths","scope","role","colSpan","_cols","_clearColsCache","_retrieveFirstColumn","_updateFirstColumnClass","_updateRowSpans","visibleChildColumns","_setColumnDataIndexes","_updateColumnCellIndex","offset","updateCellIndex","_setParentsVisibility","predicate","p","columnParents","_prepareColumns","parentCell","parentRow","parentColumn","childRow","totalColSpan","_renderHeaderTree","tree","hasMultiColumnHeaders","rowsToRender","filterThs","_hasFilterRow","_filterThs","_syncLockedHeaderHeight","_updateFilterThs","refColumn","refIndex","currIndex","filterRowThs","thIndex","lockedWidth","nonLockedWidth","wrapperWidth","modelId","_edit","rowOptions","isAlt","_trFromTemplate","_tds","_td","_footerId","isFunction","parseRowTemplate","nodeName","toLocaleLowerCase","parseAttributes","test","nodeValue","_createCellElement","_isTextNode","spaceElements","iconElement","noop","c","renderer","editedColumnField","editColumn","iconClass","columnHasEditCommand","dirty","dirtyFields","isDirtyColumn","_cellContent","dirtyIndicator","_evalColumnTemplate","templateSettings","_customTemplateSettings","_dirtyIndicatorTemplate","columnTemplate","dirtyField","paramName","charAt","expr","Template","_handleCommand","_button","_positionResizeHandle","left","headerWrap","leftMargin","invisibleSpace","leftBorderWidth","resizeHandle","rtlCorrection","cellWidth","which","indicatorWidth","columnResizeHandleWidth","halfResizeHandle","parseFloat","scrollWidth","top","val","locked","autoFitColumn","isLocked","visibleLocked","contentTable","footerTable","oldColumnWidth","newColumnWidth","totalWidth","oldWidth","newWidth","_adjustLockedHorizontalScrollBar","_syncLockedScroll","diff","lockedHeigth","tableHeigth","syncTableHeight","treelist","Resizable","handle","start","startLocation","location","columnWidth","rtlModifier","resizeend","sortableInstance","sortHandler","_sort","kendoColumnSorter","filterMenuInstance","filterInit","filterOpen","filterHandler","mode","kendoFilterMenu","settings","existingInstance","suggestDataSource","operators","customDataSource","cellOptions","enabled","values","delay","inputWidth","suggestionOperator","minLength","dataTextField","showOperators","kendoFilterCell","hasFiltering","columnsWithoutFiltering","_change","selectedValues","_uncheckCheckBoxes","_checkRows","_toggleHeaderCheckState","_isLocked","useAllItems","multi","Selectable","parseOptions","aria","continuousItems","_continuousItems","_selectableTarget","SPACEBAR","clear","_lastActive","selectRange","_firstSelectee","lockedItems","nonLockedItems","apply","related","clearSelection","prop","preventChange","checkBox","checked","parentGrid","getKendoTreeList","isSelecting","selector","ds","_sortHandler","setDataSource","getByUid","_isPopupEditable","_editMode","_createEditor","_cancelEdit","args","addRow","inlineEditing","_isInlineEditable","showNewModelInView","_insertAt","_firstEditableColumnIndex","removeRow","document","_shouldRestorePageSize","leafCols","fieldRenderer","_createIncellEditor","_editCell","isCancel","ns","row1","row2","adjustRowHeight","saveChanges","_toggleColumnVisibility","_findColumn","_adjustTablesWidth","Draggable","guid","hint","prepend","Reorderable","dragOverContainers","_allowDragOverContainers","inSameContainer","targetParentContainerIndex","flatColumnsInDomOrder","sourceIndex","targetIndex","oldIndex","newIndex","reorderColumn","lockable","_reorderTrees","destSources","destContainer","destDomTree","sources","sourcesContainer","sourcesDomTree","depth","sourcesLeafs","destLeafs","reorderTaget","destThs","sourceDOM","sourceChildren","destColumn","findReorderTarget","_insertTree","domTr","_reorderHeader","rowsToAdd","destTarget","sourcesDepth","targetDepth","sourceLocked","destLocked","destRows","updateRowSpans","removeEmptyRows","rowspan","lockChanged","nonLockedColumnsLength","lockColumn","unlockColumn","menu","menuOptions","initHandler","_columnMenuInit","openHandler","_columnMenuOpen","hasLockableColumns","compare","pane","owner","closeCallback","filtering","kendoColumnMenu","_createPager","alwaysVisible","masterColumns","parentColumns","columnParent","targetLocked","findParentColumnWithChildren","parentIds","isVisible","headers","flatColumns","headerRows","parentCellsWithChildren","prevCells","getAttribute","colSpanAttr","inserted","columnPosition","cellCounts","allColumns","temp","containerDOMtree","emptyRows","shouldRemove","direct","focusElement","ExcelMixin","PDFMixin","_drawPDF","treeList","paperSize","_drawPDF_autoPageBreak","allPages","_initPDFProgress","doc","drawing","Group","startingPage","exportPage","_drawPDFShadow","avoidLinks","pageNum","pageNumber","err","reject","deferred","clone","progressBar","kendoProgressBar","chunkCount","min","origBody","cont","overflow","paddingRight","body","draw","_destructive","drawDOM","renderPage","plugin","jQuery"],"sources":["kendo.treelist.js"],"mappings":"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","sourcesContent":["(function (factory) {\n    typeof define === 'function' && define.amd ? define(['kendo.dom', 'kendo.data', 'kendo.columnsorter', 'kendo.editable', 'kendo.window', 'kendo.filtermenu', 'kendo.columnmenu', 'kendo.selectable', 'kendo.resizable', 'kendo.treeview.draganddrop', 'kendo.pager', 'kendo.filtercell', 'kendo.textbox', 'kendo.form'], factory) :\n    factory();\n})((function () {\n    var __meta__ = {\n        id: \"treelist\",\n        name: \"TreeList\",\n        category: \"web\",\n        description: \"The TreeList widget displays self-referencing data and offers rich support for interacting with data, sorting, filtering, and selection.\",\n        depends: [ \"dom\", \"data\", \"pager\" ],\n        features: [ {\n            id: \"treelist-sorting\",\n            name: \"Sorting\",\n            description: \"Support for column sorting\",\n            depends: [ \"columnsorter\" ]\n        }, {\n            id: \"treelist-filtering\",\n            name: \"Filtering\",\n            description: \"Support for record filtering\",\n            depends: [ \"filtermenu\" ]\n        }, {\n            id: \"treelist-columnmenu\",\n            name: \"Column menu\",\n            description: \"Support for header column menu\",\n            depends: [ \"columnmenu\" ]\n        }, {\n            id: \"treelist-editing\",\n            name: \"Editing\",\n            description: \"Support for record editing\",\n            depends: [ \"editable\", \"window\", \"textbox\", \"form\" ]\n        }, {\n            id: \"treelist-selection\",\n            name: \"Selection\",\n            description: \"Support for row selection\",\n            depends: [ \"selectable\" ]\n        }, {\n            id: \"treelist-column-resize\",\n            name: \"Column resizing\",\n            description: \"Support for column resizing\",\n            depends: [ \"resizable\" ]\n        }, {\n            id: \"treelist-dragging\",\n            name: \"Drag & Drop\",\n            description: \"Support for drag & drop of rows\",\n            depends: [ \"treeview.draganddrop\" ]\n        }, {\n            id: \"treelist-excel-export\",\n            name: \"Excel export\",\n            description: \"Export data as Excel spreadsheet\",\n            depends: [ \"excel\" ]\n        }, {\n            id: \"treelist-pdf-export\",\n            name: \"PDF export\",\n            description: \"Export data as PDF\",\n            depends: [ \"pdf\", \"drawing\" ]\n        }, {\n            id: \"treelist-paging\",\n            name: \"Paging\",\n            description: \"Support for treelist paging\",\n            depends: [ \"pager\" ]\n        } ]\n    };\n\n    (function($, undefined$1) {\n        var data = kendo.data;\n        var encode = kendo.htmlEncode;\n        var kendoDom = kendo.dom;\n        var kendoDomElement = kendoDom.element;\n        var kendoTextElement = kendoDom.text;\n        var kendoHtmlElement = kendoDom.html;\n        var outerWidth = kendo._outerWidth;\n        var keys = kendo.keys;\n        var outerHeight = kendo._outerHeight;\n        var ui = kendo.ui;\n        var DataBoundWidget = ui.DataBoundWidget;\n        var DataSource = data.DataSource;\n        var ObservableArray = data.ObservableArray;\n        var Query = data.Query;\n        var Model = data.Model;\n        var browser = kendo.support.browser;\n        var kendoTemplate = kendo.template;\n        var activeElement = kendo._activeElement;\n        var touchDevice = kendo.support.touch;\n\n        var isArray = Array.isArray;\n        var extend = $.extend;\n        var map = $.map;\n        var grep = $.grep;\n        var inArray = $.inArray;\n        var isPlainObject = $.isPlainObject;\n\n        var push = Array.prototype.push;\n\n        var STRING = \"string\";\n        var CHANGE = \"change\";\n        var ITEM_CHANGE = \"itemChange\";\n        var ERROR = \"error\";\n        var PROGRESS = \"progress\";\n        var DOT = \".\";\n        var NS = \".kendoTreeList\";\n        var CLICK = \"click\";\n        var INPUT = \"input\";\n        var BEFORE_EDIT = \"beforeEdit\";\n        var EDIT = \"edit\";\n        var PAGE = \"page\";\n        var PAGE_CHANGE = \"pageChange\";\n        var SAVE = \"save\";\n        var SAVE_CHANGES = \"saveChanges\";\n        var EXPAND = \"expand\";\n        var COLLAPSE = \"collapse\";\n        var CELL_CLOSE = \"cellClose\";\n        var REMOVE = \"remove\";\n        var DATA_CELL = \"td:not(.k-group-cell):not(.k-hierarchy-cell):visible\";\n        var FILTER_CELL = \".k-filter-row th:not(.k-group-cell):not(.k-hierarchy-cell):visible\";\n        var DATABINDING = \"dataBinding\";\n        var DATABOUND = \"dataBound\";\n        var CANCEL = \"cancel\";\n        var TABINDEX = \"tabIndex\";\n        var FILTERMENUINIT = \"filterMenuInit\";\n        var FILTERMENUOPEN = \"filterMenuOpen\";\n        var COLUMNHIDE = \"columnHide\";\n        var COLUMNSHOW = \"columnShow\";\n        var HEADERCELLS = \"th.k-header\";\n        var COLUMNREORDER = \"columnReorder\";\n        var COLUMNRESIZE = \"columnResize\";\n        var COLUMNMENUINIT = \"columnMenuInit\";\n        var COLUMNMENUOPEN = \"columnMenuOpen\";\n        var COLUMNLOCK = \"columnLock\";\n        var COLUMNUNLOCK = \"columnUnlock\";\n        var FILTER = \"filter\";\n        var NAVIGATE = \"navigate\";\n        var SORT = \"sort\";\n        var PARENTIDFIELD = \"parentId\";\n        var DRAGSTART = \"dragstart\";\n        var DRAG = \"drag\";\n        var DROP = \"drop\";\n        var DRAGEND = \"dragend\";\n        var NAVROW = \"tr:visible\";\n        var NAVCELL = \"td:visible\";\n        var NAVHEADER = \"th:visible\";\n        var NORECORDSCLASS = \"k-grid-norecords\";\n        var ITEMROW = \"tr:not(.k-footer-template):visible\";\n        var isRtl = false;\n        var HEIGHT = \"height\";\n        var INCELL = \"incell\";\n        var INLINE = \"inline\";\n        var POPUP = \"popup\";\n        var TABLE = \"table\";\n        var CHECKBOX = \"k-checkbox\";\n        var CHECKBOXINPUT = \"input[data-role='checkbox'].\" + CHECKBOX;\n        var SELECTCOLUMNTMPL = '<input class=\"' + CHECKBOX + ' k-checkbox-md k-rounded-md\" data-role=\"checkbox\" aria-label=\"Select row\" aria-checked=\"false\" type=\"checkbox\">';\n        var SELECTCOLUMNHEADERTMPL = '<input class=\"' + CHECKBOX + ' k-checkbox-md k-rounded-md\" data-role=\"checkbox\" aria-label=\"Select all rows\" aria-checked=\"false\" type=\"checkbox\">';\n        var SELECTED = \"k-selected\";\n        var whitespaceRegExp = \"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\";\n        var filterRowRegExp = new RegExp(\"(^|\" + whitespaceRegExp + \")\" + \"(k-filter-row)\" + \"(\" + whitespaceRegExp + \"|$)\");\n\n        var classNames = {\n            wrapper: \"k-treelist k-grid k-widget k-grid-display-block\",\n            header: \"k-header\",\n            button: \"k-button\",\n            alt: \"k-alt\",\n            editCell: \"k-edit-cell\",\n            editRow: \"k-grid-edit-row\",\n            dirtyCell: \"k-dirty-cell\",\n            group: \"k-treelist-group\",\n            toolbar: \"k-toolbar\",\n            gridToolbar: \"k-grid-toolbar\",\n            gridHeader: \"k-grid-header\",\n            gridHeaderWrap: \"k-grid-header-wrap\",\n            gridContent: \"k-grid-content\",\n            gridContentWrap: \"k-grid-content\",\n            gridFilter: \"k-grid-filter\",\n            footerTemplate: \"k-footer-template\",\n            focused: \"k-focus\",\n            loading: \"k-i-loading\",\n            refresh: \"k-i-reload\",\n            retry: \"k-request-retry\",\n            selected: \"k-selected\",\n            status: \"k-status\",\n            link: \"k-link\",\n            filterable: \"k-filterable\",\n            icon: \"k-icon\",\n            iconFilter: \"k-i-filter\",\n            iconCollapse: \"k-i-collapse\",\n            iconExpand: \"k-i-expand\",\n            iconHidden: \"k-i-none\",\n            iconPlaceHolder: \"k-icon k-i-none\",\n            input: \"k-input\",\n            dropPositions: \"k-i-insert-up k-i-insert-down k-i-plus k-i-insert-middle\",\n            dropTop: \"k-i-insert-up\",\n            dropBottom: \"k-i-insert-down\",\n            dropAdd: \"k-i-plus\",\n            dropMiddle: \"k-i-insert-middle\",\n            dropDenied: \"k-i-cancel\",\n            dragStatus: \"k-drag-status\",\n            dragClue: \"k-drag-clue\",\n            dragClueText: \"k-clue-text\",\n            headerCellInner: \"k-cell-inner\",\n            columnTitle: \"k-column-title\"\n        };\n\n        var defaultCommands = {\n            create: {\n                imageClass: \"k-i-plus\",\n                className: \"k-grid-add\",\n                methodName: \"addRow\"\n            },\n            createchild: {\n                imageClass: \"k-i-plus\",\n                className: \"k-grid-add\",\n                methodName: \"addRow\"\n            },\n            destroy: {\n                imageClass: \"k-i-close\",\n                className: \"k-grid-delete\",\n                methodName: \"removeRow\"\n            },\n            edit: {\n                imageClass: \"k-i-edit\",\n                className: \"k-grid-edit\",\n                methodName: \"editRow\"\n            },\n            update: {\n                imageClass: \"k-i-check\",\n                className: \"k-button-solid-primary k-grid-update\",\n                methodName: \"saveRow\"\n            },\n            canceledit: {\n                imageClass: \"k-i-cancel\",\n                className: \"k-grid-cancel\",\n                methodName: \"_cancelEdit\"\n            },\n            cancel: {\n                imageClass: \"k-icon k-i-cancel\",\n                text: \"Cancel changes\",\n                className: \"k-grid-cancel-changes\",\n                methodName: \"cancelChanges\"\n            },\n            save: {\n                imageClass: \"k-icon k-i-check\",\n                text: \"Save changes\",\n                className: \"k-grid-save-changes\",\n                methodName: \"saveChanges\"\n            },\n            excel: {\n                imageClass: \"k-i-file-excel\",\n                className: \"k-grid-excel\",\n                methodName: \"saveAsExcel\"\n            },\n            pdf: {\n                imageClass: \"k-i-file-pdf\",\n                className: \"k-grid-pdf\",\n                methodName: \"saveAsPDF\"\n            },\n            search: {\n                template: function (ref) {\n                    var message = ref.message;\n\n                    return \"<span class='k-spacer'></span>\" +\n                \"<span class='k-searchbox k-input k-input-md k-rounded-md k-input-solid k-grid-search'>\" +\n                    \"<span class='k-input-icon k-icon k-i-search'></span>\" +\n                    \"<input autocomplete='off' placeholder='\" + message + \"' title='\" + message + \"' class='k-input-inner' />\" +\n                \"</span>\";\n        }\n            }\n        };\n\n        var TreeView = kendo.Class.extend({\n            init: function(data, options) {\n                var that = this;\n\n                that.data = data || [];\n                that.options = extend(that.options, options);\n            },\n\n            options: {\n                defaultParentId: null,\n                idField: \"id\",\n                parentIdField: PARENTIDFIELD\n            },\n\n            childrenMap: function() {\n                var that = this;\n                var childrenMap = {};\n                var dataLength = that.data.length;\n                var dataItem;\n                var dataItemId;\n                var dataItemParentId;\n                var idField = that.options.idField;\n                var parentIdField = that.options.parentIdField;\n\n                if (that._childrenMap) {\n                    return that._childrenMap;\n                }\n\n                for (var i = 0; i < dataLength; i++) {\n                    dataItem = this.data[i];\n                    dataItemId = dataItem[idField];\n                    dataItemParentId = dataItem[parentIdField];\n\n                    childrenMap[dataItemId] = childrenMap[dataItemId] || [];\n                    childrenMap[dataItemParentId] = childrenMap[dataItemParentId] || [];\n\n                    childrenMap[dataItemParentId].push(dataItem);\n                }\n\n                that._childrenMap = childrenMap;\n\n                return childrenMap;\n            },\n\n            idsMap: function() {\n                var that = this;\n                var idsMap = {};\n                var data = that.data;\n                var dataLength = data.length;\n                var dataItem;\n                var idField = that.options.idField;\n\n                if (that._idMap) {\n                    return that._idMap;\n                }\n\n                for (var i = 0; i < dataLength; i++) {\n                    dataItem = data[i];\n                    idsMap[dataItem[idField]] = dataItem;\n                }\n\n                that.idsMap = idsMap;\n                return idsMap;\n            },\n\n            dataMaps: function() {\n                var that = this;\n                var childrenMap = {};\n                var data = that.data;\n                var dataLength = data.length;\n                var idsMap = {};\n                var dataItem;\n                var dataItemId;\n                var dataItemParentId;\n                var idField = that.options.idField;\n                var parentIdField = that.options.parentIdField;\n\n                if (that._dataMaps) {\n                    return that._dataMaps;\n                }\n\n                for (var i = 0; i < dataLength; i++) {\n                    dataItem = data[i];\n                    dataItemId = dataItem[idField];\n                    dataItemParentId = dataItem[parentIdField];\n\n                    idsMap[dataItemId] = dataItem;\n\n                    childrenMap[dataItemId] = childrenMap[dataItemId] || [];\n                    childrenMap[dataItemParentId] = childrenMap[dataItemParentId] || [];\n                    childrenMap[dataItemParentId].push(dataItem);\n                }\n\n                that._dataMaps = {\n                    children: childrenMap,\n                    ids: idsMap\n                };\n\n                return that._dataMaps;\n            },\n\n            rootNodes: function() {\n                var that = this;\n                var data = that.data;\n                var defaultParentId = that.options.defaultParentId;\n                var dataLength = data.length;\n                var rootNodes = [];\n                var dataItem;\n                var parentIdField = that.options.parentIdField;\n\n                for (var i = 0; i < dataLength; i++) {\n                    dataItem = data[i];\n\n                    if (dataItem[parentIdField] === defaultParentId) {\n                        rootNodes.push(dataItem);\n                    }\n                }\n\n                return rootNodes;\n            },\n\n            removeCollapsedSubtreesFromRootNodes: function(options) {\n                options = options || {};\n                var that = this;\n                var rootNodes = that.rootNodes();\n                var result = [];\n                var prunedTree;\n\n                that._childrenMap = options.childrenMap = options.childrenMap || that.childrenMap();\n                options.maxDepth = options.maxDepth || Infinity;\n\n                for (var i = 0; i < rootNodes.length; i++) {\n                    prunedTree = that.removeCollapsedSubtrees(rootNodes[i], options);\n                    result = result.concat(prunedTree);\n                }\n\n                return result;\n            },\n\n            removeCollapsedSubtrees: function(rootNode, options) {\n                options = options || {};\n                var that = this;\n                var result = [];\n                var childIdx;\n                var prunedTree;\n                var childrenMap = options.childrenMap || {};\n                var maxDepth = options.maxDepth || Infinity;\n                var idField = that.options.idField;\n                var children = childrenMap[rootNode[idField]] || [];\n                var expanded = isUndefined(rootNode.expanded) ? options.expanded : rootNode.expanded;\n\n                result.push(rootNode);\n\n                if (children && expanded) {\n                    for (childIdx = 0; childIdx < children.length; childIdx++) {\n                        if (result.length >= maxDepth) {\n                            break;\n                        }\n\n                        prunedTree = that.removeCollapsedSubtrees(children[childIdx], options);\n                        result = result.concat(prunedTree);\n                    }\n                }\n\n                return result;\n            }\n        });\n\n        var TreeQuery = function(data) {\n            this.data = data || [];\n        };\n\n        TreeQuery.prototype = new Query();\n        TreeQuery.prototype.constructor = TreeQuery;\n\n        TreeQuery.process = function(data, options, inPlace) {\n            options = options || {};\n            var query = new TreeQuery(data);\n            var group = options.group;\n            var sort = Query.normalizeGroup(group || []).concat(Query.normalizeSort(options.sort || []));\n            var filterCallback = options.filterCallback;\n            var filter = options.filter;\n            var skip = options.skip;\n            var take = options.take;\n            var total;\n            var childrenMap;\n            var filteredChildrenMap;\n            var view;\n            var prunedData;\n\n            if (sort && inPlace) {\n                query = query.sort(sort, undefined$1, undefined$1, inPlace);\n            }\n\n            if (filter) {\n                query = query.filter(filter);\n\n                if (filterCallback) {\n                    query = filterCallback(query);\n                }\n\n                total = query.toArray().length;\n            }\n\n            if (sort && !inPlace) {\n                query = query.sort(sort);\n\n                if (group) {\n                    data = query.toArray();\n                }\n            }\n\n            if (options.processFromRootNodes) {\n                view = new TreeView(query.toArray(), options);\n\n                if (filter) {\n                    filteredChildrenMap = view.childrenMap();\n                }\n\n                prunedData = view.removeCollapsedSubtreesFromRootNodes({\n                    // filtering or sorting requires changes to childrenMap\n                    childrenMap: filter || (sort && sort.length) ? undefined$1 : options.childrenMap,\n                    expanded: options.expanded,\n                    maxDepth: (skip + take) || Infinity\n                });\n\n                childrenMap = view.childrenMap();\n\n                query = new TreeQuery(prunedData);\n            }\n\n            if (skip !== undefined$1 && take !== undefined$1) {\n                query = query.range(skip, take);\n            }\n\n            if (group) {\n                query = query.group(group, data);\n            }\n\n            return {\n                total: total,\n                data: query.toArray(),\n                childrenMap: childrenMap,\n                filteredChildrenMap: filteredChildrenMap\n            };\n        };\n\n        var TreeListModel = Model.define({\n            id: \"id\",\n\n            parentId: PARENTIDFIELD,\n\n            fields: {\n                id: { type: \"number\" },\n                parentId: { type: \"number\", nullable: true }\n            },\n\n            init: function(value) {\n                Model.fn.init.call(this, value);\n\n                this._loaded = false;\n\n                if (!this.parentIdField) {\n                    this.parentIdField = PARENTIDFIELD;\n                }\n\n                this.parentId = this.get(this.parentIdField);\n            },\n\n            accept: function(data) {\n                Model.fn.accept.call(this, data);\n\n                this.parentId = this.get(this.parentIdField);\n            },\n\n            set: function(field, value, initiator) {\n                if (field == PARENTIDFIELD && this.parentIdField != PARENTIDFIELD) {\n                    this[this.parentIdField] = value;\n                }\n\n                Model.fn.set.call(this, field, value, initiator);\n\n                if (field == this.parentIdField) {\n                    this.parentId = this.get(this.parentIdField);\n                }\n            },\n\n            loaded: function(value) {\n                if (value !== undefined$1) {\n                    this._loaded = value;\n                } else {\n                    return this._loaded;\n                }\n            },\n\n            shouldSerialize: function(field) {\n                return Model.fn.shouldSerialize.call(this, field) && field !== \"_loaded\" && field != \"_error\" && field != \"_edit\" && !(this.parentIdField !== \"parentId\" && field === \"parentId\");\n            }\n        });\n\n        TreeListModel.parentIdField = PARENTIDFIELD;\n\n        TreeListModel.define = function(base, options) {\n            if (options === undefined$1) {\n                options = base;\n                base = TreeListModel;\n            }\n\n            var parentId = options.parentId || PARENTIDFIELD;\n\n            options.parentIdField = parentId;\n\n            var model = Model.define(base, options);\n\n            if (parentId) {\n                model.parentIdField = parentId;\n            }\n\n            return model;\n        };\n\n        function is(field) {\n            return function(object) {\n                return object[field];\n            };\n        }\n\n        function not(func) {\n            return function(object) {\n                return !func(object);\n            };\n        }\n\n        var TreeListDataSource = DataSource.extend({\n            init: function(options) {\n                options = options || {};\n                var that = this;\n                that._dataMaps = that._getDataMaps();\n\n                options.schema = extend(true, {}, {\n                    modelBase: TreeListModel,\n                    model: TreeListModel\n                }, options.schema);\n\n                DataSource.fn.init.call(this, options);\n            },\n\n            _addRange: function() {\n                // empty override for performance - the treelist does not support virtualization\n            },\n\n            _createNewModel: function(data) {\n                var that = this;\n                var model = {};\n                var fromModel = data instanceof Model;\n                var parentIdField = this._modelParentIdField();\n\n                if (fromModel) {\n                    model = data;\n                }\n\n                model = DataSource.fn._createNewModel.call(this, model);\n\n                if (!fromModel) {\n                    if (data.parentId) {\n                        data[model.parentIdField] = data.parentId;\n                    } else if (that._isPageable() && data[parentIdField]) {\n                        data[model.parentIdField] = data[parentIdField];\n                    }\n\n                    model.accept(data);\n                }\n\n                return model;\n            },\n\n            _shouldWrap: function() {\n                return true;\n            },\n\n            _push: function(result, operation) {\n                var data = DataSource.fn._readData.call(this, result);\n\n                if (!data) {\n                    data = result;\n                }\n\n                this[operation](data);\n            },\n\n            _getData: function() {\n                // do not use .data(), which wraps the data items\n                return this._data || [];\n            },\n\n            _readData: function(newData) {\n                var that = this;\n                var data = that._isPageable() ? that._getData().toJSON() : that.data();\n\n                newData = DataSource.fn._readData.call(this, newData);\n\n                this._replaceData(((data.toJSON ? data.toJSON() : data)).concat(newData), data);\n\n                if (newData instanceof ObservableArray) {\n                    return newData;\n                }\n\n                return data;\n            },\n\n            _replaceData: function(source, target) {\n                var sourceLength = source.length;\n\n                for (var i = 0; i < sourceLength; i++) {\n                    target[i] = source[i];\n                }\n\n                target.length = sourceLength;\n            },\n\n            _readAggregates: function(data) {\n                var result = extend(this._aggregateResult, this.reader.aggregates(data));\n                if (\"\" in result) {\n                    result[this._defaultParentId()] = result[\"\"];\n                    delete result[\"\"];\n                }\n\n                return result;\n            },\n\n            read: function(data) {\n                var that = this;\n\n                if (that._isPageable()) {\n                    that._dataMaps = {};\n                    if (!that._modelOptions().expanded) {\n                        that._skip = 0;\n                        that._page = 1;\n                        that._collapsedTotal = undefined$1;\n                    }\n                }\n\n                return DataSource.fn.read.call(that, data);\n            },\n\n            remove: function(root) {\n                this._removeChildData(root);\n\n                this._removeFromDataMaps(root);\n\n                return DataSource.fn.remove.call(this, root);\n            },\n\n            _removeChildData: function(model, removePristine) {\n                var that = this;\n                var pageable = that._isPageable();\n                var data = pageable ? this._getData() : this.data();\n                var childrenMap = pageable ? that._getChildrenMap() || that.childrenMap(data) : that._childrenMap(data);\n                var items = this._subtree(childrenMap, model.id);\n                var shouldRemovePristine = isUndefined(removePristine) ? false : removePristine;\n\n                var removedItems = this._removeItems(items, shouldRemovePristine);\n\n                that._removeFromDataMaps(removedItems);\n            },\n\n            pushDestroy: function(items) {\n                var that = this;\n\n                if (!isArray(items)) {\n                    items = [items];\n                }\n\n                for (var i = 0; i < items.length; i++) {\n                    that._removeChildData(items[i], true);\n                    that._removeFromDataMaps(items[i]);\n                }\n\n                DataSource.fn.pushDestroy.call(that, items);\n            },\n\n            insert: function(index, model) {\n                var that = this;\n                var newModel = that._createNewModel(model);\n\n                that._insertInDataMaps(newModel);\n\n                return DataSource.fn.insert.call(that, index, newModel);\n            },\n\n            _filterCallback: function(query) {\n                var that = this;\n                var i, item;\n                var map = {};\n                var result = [];\n                var data = query.toArray();\n                var idField = that._modelIdField();\n                var parentIdField = that._modelParentIdField();\n                var pageable = that._isPageable();\n                var parentSubtree = [];\n                var parent;\n\n                for (i = 0; i < data.length; i++) {\n                    item = data[i];\n\n                    if (pageable) {\n                        // return view from root nodes to child nodes\n                        parentSubtree = [];\n\n                        if (!map[item[idField]]) {\n                            map[item[idField]] = true;\n                            parentSubtree.push(item);\n                        }\n\n                        parent = that._parentNode(item);\n\n                        while (parent) {\n                            if (!map[parent[idField]]) {\n                                map[parent[idField]] = true;\n                                parentSubtree.unshift(parent);\n                                parent = that._parentNode(parent);\n                            } else {\n                                // the parent chain is already processed\n                                break;\n                            }\n                        }\n\n                        if (parentSubtree.length) {\n                            result = result.concat(parentSubtree);\n                        }\n                    } else {\n                        while (item) {\n                            if (!map[item[idField]]) {\n                                map[item[idField]] = true;\n                                result.push(item);\n                            }\n\n                            if (!map[item[parentIdField]]) {\n                                map[item[parentIdField]] = true;\n                                item = this.parentNode(item);\n\n                                if (item) {\n                                    result.push(item);\n                                }\n                            } else {\n                                break;\n                            }\n                        }\n                    }\n                }\n\n                return new Query(result);\n            },\n\n            _subtree: function(map, id) {\n                var that = this;\n                var result = map[id] || [];\n                var defaultParentId = that._defaultParentId();\n                var idField = that._modelIdField();\n\n                for (var i = 0, len = result.length; i < len; i++) {\n                    if (result[i][idField] !== defaultParentId) {\n                        result = result.concat(that._subtree(map, result[i][idField]));\n                    }\n                }\n\n                return result;\n            },\n\n            // builds hash id -> children\n            _childrenMap: function(data) {\n                var map = {};\n                var i, item, id, parentId;\n\n                data = this._observeView(data);\n\n                for (i = 0; i < data.length; i++) {\n                    item = data[i];\n                    id = item.id;\n                    parentId = item.parentId;\n\n                    map[id] = map[id] || [];\n                    map[parentId] = map[parentId] || [];\n                    map[parentId].push(item);\n                }\n\n                return map;\n            },\n\n            childrenMap: function(data) {\n                var view = this._createTreeView(data);\n                var map = view.childrenMap();\n                return map;\n            },\n\n            _getChildrenMap: function() {\n                var that = this;\n                var dataMaps = that._getDataMaps();\n                return dataMaps.children;\n            },\n\n            _initIdsMap: function(data) {\n                var that = this;\n                var dataMaps = that._getDataMaps();\n\n                if (isUndefined(dataMaps.ids)) {\n                    dataMaps.ids = that._idsMap(data);\n                }\n\n                return dataMaps.ids;\n            },\n\n            _idsMap: function(data) {\n                var view = this._createTreeView(data);\n                var map = view.idsMap();\n                return map;\n            },\n\n            _getIdsMap: function() {\n                var that = this;\n                var dataMaps = that._getDataMaps();\n                return dataMaps.ids || {};\n            },\n\n            _getFilteredChildrenMap: function() {\n                var that = this;\n                var dataMaps = that._getDataMaps();\n                return dataMaps.filteredChildren;\n            },\n\n            _setFilteredChildrenMap: function(map) {\n                var that = this;\n                var dataMaps = that._getDataMaps();\n                dataMaps.filteredChildren = map;\n            },\n\n            _initDataMaps: function(data) {\n                var that = this;\n                var view = that._createTreeView(data);\n\n                that._dataMaps = view.dataMaps();\n\n                return that._dataMaps;\n            },\n\n            _initChildrenMapForParent: function(parent) {\n                var that = this;\n                var data = that._getData();\n                var childrenMap = that._getChildrenMap();\n                var idField = that._modelIdField();\n                var parentIdField = that._modelParentIdField();\n                var parentId = (parent || {})[idField];\n\n                if (childrenMap && parent) {\n                    childrenMap[parentId] = [];\n\n                    for (var i = 0; i < data.length; i++) {\n                        if (data[i][parentIdField] === parentId) {\n                            childrenMap[parentId].push(data[i]);\n                        }\n                    }\n                }\n            },\n\n            _getDataMaps: function() {\n                var that = this;\n                that._dataMaps = that._dataMaps || {};\n                return that._dataMaps;\n            },\n\n            _createTreeView: function(data, options) {\n                var view = new TreeView(data, extend(options, this._defaultTreeModelOptions()));\n                return view;\n            },\n\n            _defaultTreeModelOptions: function() {\n                var that = this;\n                var modelOptions = that._modelOptions();\n\n                return {\n                    defaultParentId: that._defaultParentId(),\n                    idField: that._modelIdField(),\n                    parentIdField: that._modelParentIdField(),\n                    expanded: modelOptions.expanded\n                };\n            },\n\n            _defaultDataItemType: function() {\n                return this.reader.model || kendo.data.ObservableObject;\n            },\n\n            _calculateAggregates: function(data, options) {\n                options = options || {};\n                var that = this;\n                var result = {};\n                var item, subtree, i;\n                var filter = options.filter;\n                var skip = options.skip;\n                var take = options.take;\n                var maxDepth = !isUndefined(skip) && !isUndefined(take) ? (skip + take) : Infinity;\n                var pageable = that._isPageable();\n                var filteredChildrenMap = options.filteredChildrenMap;\n                var childrenMap = options.childrenMap;\n                var pageableChildrenMap;\n\n                if (pageable) {\n                    if (isUndefined(options.aggregate)) {\n                        return result;\n                    }\n\n                    if (filteredChildrenMap) {\n                        pageableChildrenMap = filteredChildrenMap;\n                    } else if (childrenMap) {\n                        pageableChildrenMap = childrenMap;\n                    } else {\n                        pageableChildrenMap = that.childrenMap(that._getData());\n                    }\n                }\n\n                if (!pageable && filter) {\n                    data = Query.process(data, {\n                        filter: filter,\n                        filterCallback: this._filterCallback.bind(this)\n                    }).data;\n                }\n\n                var map = pageable ? pageableChildrenMap : that._childrenMap(data);\n\n                // calculate aggregates for each subtree\n                result[this._defaultParentId()] = new Query(this._subtree(map, this._defaultParentId())).aggregate(options.aggregate);\n\n                for (i = 0; i < data.length; i++) {\n                    if (i >= maxDepth) {\n                        break;\n                    }\n\n                    item = data[i];\n                    subtree = this._subtree(map, item.id);\n\n                    result[item.id] = new Query(subtree).aggregate(options.aggregate);\n                }\n\n                return result;\n            },\n\n            _queryProcess: function(data, options) {\n                var that = this;\n                var result = {};\n                options = options || {};\n                options.filterCallback = this._filterCallback.bind(this);\n\n                if (that._isPageable()) {\n                    return that._processPageableQuery(data, options);\n                } else {\n                    var defaultParentId = this._defaultParentId();\n                    result = Query.process(data, options);\n                    var map = this._childrenMap(result.data);\n                    var hasLoadedChildren, i, item, children;\n\n                    data = map[defaultParentId] || [];\n\n                    for (i = 0; i < data.length; i++) {\n                        item = data[i];\n\n                        if (item.id === defaultParentId) {\n                            continue;\n                        }\n\n                        children = map[item.id];\n                        hasLoadedChildren = !!(children && children.length);\n\n                        if (!item.loaded()) {\n                            item.loaded(hasLoadedChildren || !item.hasChildren);\n                        }\n\n                        if (item.loaded() || item.hasChildren !== true) {\n                            item.hasChildren = hasLoadedChildren;\n                        }\n\n                        if (hasLoadedChildren) {\n                            //cannot use splice due to IE8 bug\n                            data = data.slice(0, i + 1).concat(children, data.slice(i + 1));\n                        }\n                    }\n\n                    result.data = data;\n                }\n\n                return result;\n            },\n\n            _processPageableQuery: function(data, options) {\n                var that = this;\n                var dataMaps = that._getDataMaps();\n                var result;\n                var filteredChildrenMap;\n\n                if (that._getData() !== data || !dataMaps.children || !dataMaps.ids) {\n                    dataMaps = that._initDataMaps(that._getData());\n                }\n\n                options.childrenMap = dataMaps.children || {};\n                options.idsMap = dataMaps.ids || {};\n\n                result = that._processTreeQuery(data, options);\n\n                that._replaceWithObservedData(result.data, data);\n\n                that._processDataItemsState(result.data, result.childrenMap);\n\n                that._replaceItemsInDataMaps(result.data);\n\n                result.dataToAggregate = that._dataToAggregate(result.data, options);\n\n                if (options.filter || that.filter()) {\n                    filteredChildrenMap = result.filteredChildrenMap;\n                    that._replaceInMapWithObservedData(filteredChildrenMap, data);\n                    that._setFilteredChildrenMap(filteredChildrenMap);\n                    options.filteredChildrenMap = filteredChildrenMap;\n                    that._calculateCollapsedTotal(result.data);\n                } else {\n                    that._collapsedTotal = undefined$1;\n                }\n\n                return result;\n            },\n\n            _dataToAggregate: function(data) {\n                var that = this;\n                var firstDataItem = data[0] || {};\n                var firstItemParents = that._parentNodes(firstDataItem);\n                var dataToAggregate = firstItemParents.concat(data);\n\n                return dataToAggregate;\n            },\n\n            _replaceItemsInDataMaps: function(observableArray) {\n                var that = this;\n                var view = isArray(observableArray) ? observableArray : [observableArray];\n                var itemType = that._defaultDataItemType();\n                var defaultParentId = that._defaultParentId();\n                var idField = that._modelIdField();\n                var parentIdField = that._modelParentIdField();\n                var dataMaps = that._getDataMaps();\n                var item;\n                var parents;\n                var directParent;\n\n                for (var viewIndex = 0; viewIndex < view.length; viewIndex++) {\n                    item = view[viewIndex];\n\n                    if (!(item instanceof itemType)) {\n                        continue;\n                    }\n\n                    that._insertInIdsMap(item);\n\n                    parents = that._parentNodes(item);\n                    directParent = parents && parents.length ? parents[parents.length - 1] : undefined$1;\n\n                    if (item[parentIdField] === defaultParentId) {\n                        that._replaceInMap(dataMaps.children, defaultParentId, item, itemType);\n                    } else if (directParent) {\n                        that._replaceInMap(dataMaps.children, directParent[idField], item, itemType);\n                    }\n                }\n            },\n\n            _replaceInMap: function(map, id, replacement, itemType) {\n                var idField = this._modelIdField();\n                map[id] = map[id] || [];\n                itemType = itemType || this._defaultDataItemType();\n\n                var itemInArray = map[id].filter(function(element) {\n                    return replacement[idField] === element[idField];\n                })[0];\n\n                var itemIndex = itemInArray ? map[id].indexOf(itemInArray) : -1;\n\n                if (itemIndex !== -1 && !(itemInArray instanceof itemType)) {\n                    map[id][itemIndex] = replacement;\n                }\n            },\n\n            _replaceWithObservedData: function(dataToReplace, replacementArray) {\n                var that = this;\n                var idsMap = that._getDataMaps().ids || {};\n                var idField = that._modelIdField();\n                var itemType = that._defaultDataItemType();\n                var itemToReplace;\n                var itemToReplaceId;\n                var dataItem;\n                var dataItemIndex;\n                var observableItem;\n\n                for (var i = 0; i < dataToReplace.length; i++) {\n                    itemToReplace = dataToReplace[i];\n                    itemToReplaceId = itemToReplace[idField];\n\n                    if (!(itemToReplace instanceof itemType)) {\n                        if (!(idsMap[itemToReplaceId] instanceof itemType)) {\n                            dataItem = that._getById(itemToReplaceId);\n                            dataItemIndex = replacementArray.indexOf(dataItem);\n\n                            if (dataItem && dataItemIndex !== -1) {\n                                observableItem = replacementArray.at(dataItemIndex);\n                                dataToReplace[i] = observableItem;\n                            }\n                        } else {\n                            dataToReplace[i] = idsMap[itemToReplaceId];\n                        }\n                    }\n                }\n            },\n\n            _replaceInMapWithObservedData: function(map, replacementArray) {\n                var that = this;\n\n                for (var key in map) {\n                    that._replaceWithObservedData(map[key], replacementArray);\n                }\n            },\n\n            _insertInDataMaps: function(item) {\n                var that = this;\n\n                if (that._isPageable()) {\n                    that._insertInIdsMap(item);\n                    that._insertInChildrenMap(item);\n                }\n            },\n\n            _insertInIdsMap: function(item) {\n                var that = this;\n                var idsMap = that._getIdsMap();\n                var idField = that._modelIdField();\n\n                if (!isUndefined(item[idField])) {\n                    idsMap[item[idField]] = item;\n                }\n            },\n\n            _insertInChildrenMap: function(item, index) {\n                var that = this;\n                var childrenMap = that._getChildrenMap() || {};\n                var idField = that._modelIdField();\n                var parentIdField = that._modelParentIdField();\n                var itemId = item[idField];\n                var parentId = item[parentIdField];\n                index = index || 0;\n\n                childrenMap[itemId] = childrenMap[itemId] || [];\n                childrenMap[parentId] = childrenMap[parentId] || [];\n                childrenMap[parentId].splice(index, 0, item);\n            },\n\n            _removeFromDataMaps: function(items) {\n                var that = this;\n                items = isArray(items) ? items : [items];\n\n                if (that._isPageable()) {\n                    for (var i = 0; i < items.length; i++) {\n                        that._removeFromIdsMap(items[i]);\n                        that._removeFromChildrenMap(items[i]);\n                    }\n                }\n            },\n\n            _removeFromIdsMap: function(item) {\n                var that = this;\n                var idsMap = that._getIdsMap();\n                var idField = that._modelIdField();\n\n                if (!isUndefined(item[idField])) {\n                    idsMap[item[idField]] = undefined$1;\n                }\n            },\n\n            _removeFromChildrenMap: function(item) {\n                var that = this;\n                var childrenMap = that._getChildrenMap() || {};\n                var parentIdField = that._modelParentIdField();\n                var parentId = item[parentIdField];\n\n                childrenMap[parentId] = childrenMap[parentId] || [];\n\n                var itemIndex = that._indexInChildrenMap(item);\n\n                if (itemIndex !== -1) {\n                    childrenMap[parentId].splice(itemIndex, 1);\n                }\n            },\n\n            _indexInChildrenMap: function(item) {\n                var that = this;\n                return that._itemIndexInMap(item, that._getChildrenMap());\n            },\n\n            _itemIndexInMap: function(item, dataMap) {\n                var that = this;\n                var map = dataMap || {};\n                var parentIdField = that._modelParentIdField();\n                var parentId = item[parentIdField];\n\n                map[parentId] = map[parentId] || [];\n\n                var itemInArray = map[parentId].filter(function(element) {\n                    return item.uid === element.uid;\n                })[0];\n\n                var itemIndex = itemInArray ? map[parentId].indexOf(itemInArray) : -1;\n\n                return itemIndex;\n            },\n\n            _getById: function(id) {\n                var that = this;\n                var idField = that._modelIdField();\n                var data = that._getData();\n\n                for (var i = 0; i < data.length; i++) {\n                    if (data[i][idField] === id) {\n                        return data[i];\n                    }\n                }\n            },\n\n            _isLastItemInView: function(dataItem) {\n                var view = this.view();\n                return view.length && view[view.length - 1] === dataItem;\n            },\n\n            _defaultPageableQueryOptions: function() {\n                var that = this;\n                var dataMaps = that._getDataMaps();\n                var options = {\n                    skip: that.skip(),\n                    take: that.take(),\n                    page: that.page(),\n                    pageSize: that.pageSize(),\n                    sort: that.sort(),\n                    filter: that.filter(),\n                    group: that.group(),\n                    aggregate: that.aggregate(),\n                    filterCallback: that._filterCallback.bind(that),\n                    childrenMap: dataMaps.children,\n                    idsMap: dataMaps.ids\n                };\n\n                return options;\n            },\n\n            _isPageable: function() {\n                var pageSize = this.pageSize();\n                return (!isUndefined(pageSize) && pageSize > 0 && !this.options.serverPaging);\n            },\n\n            _updateTotalForAction: function(action, items) {\n                var that = this;\n\n                DataSource.fn._updateTotalForAction.call(that, action, items);\n\n                if (that._isPageable()) {\n                    that._updateCollapsedTotalForAction(action, items);\n                }\n            },\n\n            _updateCollapsedTotalForAction: function(action, items) {\n                var that = this;\n                var total = parseInt(that._collapsedTotal, 10);\n\n                if (!isNumber(that._collapsedTotal)) {\n                    that._calculateCollapsedTotal();\n                    return;\n                }\n\n                if (action === \"add\") {\n                    total += items.length;\n                } else if (action === \"remove\") {\n                    total -= items.length;\n                } else if (action !== \"itemchange\" && action !== \"sync\" && !that.options.serverPaging) {\n                    total = that._calculateCollapsedTotal();\n                } else if (action === \"sync\") {\n                    total = that._calculateCollapsedTotal();\n                }\n\n                that._collapsedTotal = total;\n            },\n\n            _setFilterTotal: function(filterTotal, setDefaultValue) {\n                var that = this;\n\n                DataSource.fn._setFilterTotal.call(that, filterTotal, setDefaultValue);\n\n            },\n\n            collapsedTotal: function() {\n                var that = this;\n\n                if (!isUndefined(that._collapsedTotal)) {\n                    return that._collapsedTotal;\n                }\n\n                return that._calculateCollapsedTotal();\n            },\n\n            _calculateCollapsedTotal: function(filteredData) {\n                var that = this;\n                var data = that._dataWithoutCollapsedSubtrees(filteredData);//\n\n                if (data.length) {\n                    that._collapsedTotal = data.length;\n                }\n\n                return that._collapsedTotal;\n            },\n\n            _dataWithoutCollapsedSubtrees: function(filteredData) {\n                return this._removeCollapsedSubtrees(filteredData || this._getData());\n            },\n\n            _removeCollapsedSubtrees: function(data) {\n                var that = this;\n                var view = that._createTreeView(data);\n                var result = view.removeCollapsedSubtreesFromRootNodes({\n                    expanded: that._modelOptions().expanded,\n                    childrenMap: that.filter() ? that._getFilteredChildrenMap() : that._getChildrenMap()\n                });\n\n                return result;\n            },\n\n            _processTreeQuery: function(data, options) {\n                var result = TreeQuery.process(data, extend(options, this._defaultTreeModelOptions(), {\n                    processFromRootNodes: true\n                }));\n\n                return result;\n            },\n\n            _processDataItemsState: function(data, childrenMap) {\n                var dataLength = data.length;\n                var i;\n\n                for (i = 0; i < dataLength; i++) {\n                    this._processDataItemState(data[i], childrenMap);\n                }\n            },\n\n            _processDataItemState: function(dataItem, childrenMap) {\n                var defaultParentId = this._defaultParentId();\n\n                if (dataItem.id === defaultParentId) {\n                    return;\n                }\n\n                var children = childrenMap[dataItem.id] || [];\n                var hasLoadedChildren = !!(children && children.length);\n\n                if (!dataItem.loaded) {\n                    return;\n                }\n\n                if (!dataItem.loaded()) {\n                    dataItem.loaded(hasLoadedChildren || !dataItem.hasChildren);\n                }\n\n                if (dataItem.loaded() || dataItem.hasChildren !== true) {\n                    dataItem.hasChildren = hasLoadedChildren;\n                }\n            },\n\n            _queueRequest: function(options, callback) {\n                // allow simultaneous requests (loading multiple items at the same time)\n                callback.call(this);\n            },\n\n            _modelLoaded: function(id) {\n                var model = this.get(id);\n                model.loaded(true);\n                model.hasChildren = this.childNodes(model).length > 0;\n            },\n\n            _modelError: function(id, e) {\n                this.get(id)._error = e;\n            },\n\n            success: function(data, requestParams) {\n                if (!requestParams || typeof requestParams.id == \"undefined\") {\n                    this._data = this._observe([]);\n                }\n\n                DataSource.fn.success.call(this, data, requestParams);\n    \t\t\tthis._total = this._data.length;\n            },\n\n            load: function(model) {\n                var method = \"_query\";\n                var remote = this.options.serverSorting || this.options.serverPaging || this.options.serverFiltering || this.options.serverGrouping || this.options.serverAggregates;\n                var defaultPromise = $.Deferred().resolve().promise();\n\n                if (model.loaded()) {\n                    if (remote) {\n                        return defaultPromise;\n                    }\n                } else if (model.hasChildren) {\n                    method = \"read\";\n                    this._removeChildData(model);\n                }\n\n                return this[method]({ id: model.id })\n                    .done(this._modelLoaded.bind(this, model.id))\n                    .fail(this._modelError.bind(this, model.id));\n            },\n\n            contains: function(root, child) {\n                var that = this;\n                var idField = that._modelIdField();\n                var parentIdField = that._modelParentIdField();\n                var rootId = root[idField];\n                var pageable = that._isPageable();\n\n                while (child) {\n                    if (child[parentIdField] === rootId) {\n                        return true;\n                    }\n\n                    child = pageable ? that._parentNode(child) : that.parentNode(child);\n                }\n\n                return false;\n            },\n\n            _byParentId: function(id, defaultId) {\n                var result = [];\n                var view = this.view();\n                var current;\n\n                if (id === defaultId) {\n                    return [];\n                }\n\n                for (var i = 0; i < view.length; i++) {\n                    current = view.at(i);\n\n                    if (current.parentId == id) {\n                        result.push(current);\n                    }\n                }\n\n                return result;\n            },\n\n            _defaultParentId: function() {\n                return this.reader.model.fn.defaults[this.reader.model.parentIdField];\n            },\n\n            _modelOptions: function() {\n                var modelOptions = ((this.options.schema || {}).model || {});\n                return modelOptions;\n            },\n\n            _modelIdField: function() {\n                var modelOptions = this._modelOptions();\n                return modelOptions.id || \"id\";\n            },\n\n            _modelParentIdField: function() {\n                var modelOptions = this._modelOptions();\n                return modelOptions.parentId || PARENTIDFIELD;\n            },\n\n            childNodes: function(model) {\n                return this._byParentId(model.id, this._defaultParentId());\n            },\n\n            allChildNodes: function(model, result) {\n                var directChildren = this.data().filter(function(item) {\n                    return item.parentId === model.id;\n                });\n\n                for (var i = 0; i < directChildren.length; i++) {\n                    result.push(directChildren[i]);\n                    this.allChildNodes(directChildren[i], result);\n                }\n            },\n\n            rootNodes: function() {\n                return this._byParentId(this._defaultParentId());\n            },\n\n            _rootNode: function(child) {\n                return this._parentNodes(child)[0];\n            },\n\n            _pageableRootNodes: function(options) {\n                options = options || {};\n                var that = this;\n                var defaultParentId = that._defaultParentId();\n                var parentIdField = that._modelParentIdField();\n                var result = [];\n                var nodesWithoutParentInView = that._nodesWithoutParentInView(options);\n                var node;\n                var root;\n\n                for (var i = 0; i < nodesWithoutParentInView.length; i++) {\n                    node = nodesWithoutParentInView[i];\n\n                    if (node[parentIdField] === defaultParentId) {\n                        result.push(node);\n                    } else {\n                        root = that._rootNode(node);\n\n                        if (root && result.indexOf(root) === -1) {\n                            result.push(root);\n                        }\n                    }\n                }\n\n                return result;\n            },\n\n            parentNode: function(model) {\n                return this.get(model.parentId);\n            },\n\n            _parentNode: function(child) {\n                var that = this;\n                var parentIdField = that._modelParentIdField();\n                var idsMap = that._initIdsMap(that._getData());\n                var parentId = child[parentIdField];\n                var parent = idsMap[parentId] || that._getById(parentId);\n\n                return parent;\n            },\n\n            _parentNodes: function(child) {\n                var that = this;\n                var parent = that._parentNode(child);\n                var parents = [];\n\n                while (parent) {\n                    parents.unshift(parent);\n                    parent = that._parentNode(parent);\n                }\n\n                return parents;\n            },\n\n            _parentNodesNotInView: function() {\n                var that = this;\n                var view = that.view();\n                var result = [];\n                var defaultParentId = that._defaultParentId();\n                var idField = that._modelIdField();\n                var parentIdField = that._modelParentIdField();\n                var parentInView;\n                var parents = [];\n                var directParent;\n                var dataItem;\n                var dataItemId;\n                var dataItemParentId;\n\n                for (var i = 0; i < view.length; i++) {\n                    dataItem = view[i];\n                    dataItemId = dataItem[idField];\n                    dataItemParentId = dataItem[parentIdField];\n                    parentInView = that._parentInView(dataItemParentId);\n\n                    if (!parentInView && dataItemParentId !== defaultParentId) {\n                        parents = that._parentNodes(dataItem);\n\n                        directParent = parents && parents.length ? parents[parents.length - 1] : that._getById(dataItemParentId);\n\n                        if (directParent && result.indexOf(directParent) === -1) {\n                            result.push(directParent);\n                        }\n                    }\n                }\n\n                return result;\n            },\n\n            _nodesWithoutParentInView: function(options) {\n                options = options || {};\n                var that = this;\n                var view = that.view();\n                var childrenMap = options.childrenMap || that.childrenMap(that._getData());\n                var idField = that._modelIdField();\n                var parentIdField = that._modelParentIdField();\n                var dataItem;\n                var parentInView;\n                var children = [];\n                var result = [];\n\n                for (var i = 0; i < view.length; i++) {\n                    dataItem = view[i];\n                    children = childrenMap[dataItem[idField]];\n                    parentInView = that._parentInView(dataItem[parentIdField]);\n\n                    if (!parentInView) {\n                        result.push(dataItem);\n                    }\n                }\n\n                return result;\n            },\n\n            _parentInView: function(parentId) {\n                var view = this.view();\n\n                for (var i = 0; i < view.length; i++) {\n                    if (view[i].id === parentId) {\n                        return view[i];\n                    }\n                }\n            },\n\n            level: function(model) {\n                var result = -1;\n\n                if (!(model instanceof TreeListModel)) {\n                    model = this.get(model);\n                }\n\n                do {\n                    model = this.parentNode(model);\n                    result++;\n                } while (model);\n\n                return result;\n            },\n\n            _pageableModelLevel: function(model) {\n                var that = this;\n\n                if (!model || !that._isPageable()) {\n                    return 0;\n                }\n\n                var parents = that._parentNodes(model);\n\n                return parents.length;\n            },\n\n            filter: function(value) {\n                var baseFilter = DataSource.fn.filter;\n\n                if (value === undefined$1) {\n                    return baseFilter.call(this, value);\n                }\n\n                baseFilter.call(this, value);\n            },\n\n            _pageableQueryOptions: function(options) {\n                var dataMaps = this._getDataMaps();\n\n                options.childrenMap = dataMaps.children;\n                options.idsMap = dataMaps.ids;\n\n                return options;\n            },\n\n            _flatData: function(data, skip) {\n                skip = this._isPageable() ? true : skip;\n                return DataSource.fn._flatData.call(this, data, skip);\n            },\n\n            data: function(data) {\n                var that = this;\n                var result = DataSource.fn.data.call(that, data);\n\n                if (that._isPageable()) {\n                    that._initDataMaps(that._getData());\n                    that._calculateCollapsedTotal();\n                }\n\n                return result;\n            },\n\n            cancelChanges: function(model) {\n                var that = this;\n\n                DataSource.fn.cancelChanges.call(that, model);\n\n                that._restorePageSizeAfterAddChild();\n            },\n\n            _modelCanceled: function(model) {\n                var that = this;\n\n                if (that._isPageable()) {\n                    that._removeFromDataMaps(model);\n                }\n            },\n\n            _changesCanceled: function() {\n                var that = this;\n\n                if (that._isPageable()) {\n                    that._initDataMaps(that._getData());\n                }\n            },\n\n            _setAddChildPageSize: function() {\n                var that = this;\n                var queryOptions = {};\n\n                if (that._isPageable()) {\n                    // increase the page size to make the new item visible in view\n                    that._addChildPageSize = that.pageSize() + 1;\n\n                    queryOptions = that._defaultPageableQueryOptions();\n                    queryOptions.take = that._addChildPageSize;\n                    queryOptions.pageSize = that._addChildPageSize;\n                    that._query(queryOptions);\n                }\n            },\n\n            _restorePageSizeAfterAddChild: function() {\n                var that = this;\n                var queryOptions = {};\n\n                if (that._isPageable()) {\n                    if (!isUndefined(that._addChildPageSize)) {\n                        queryOptions = that._defaultPageableQueryOptions();\n                        queryOptions.take = that._addChildPageSize - 1;\n                        queryOptions.pageSize = that._addChildPageSize - 1;\n                        that._query(queryOptions);\n                    }\n                }\n\n                that._addChildPageSize = undefined$1;\n            },\n\n            sync: function() {\n                var that = this;\n\n                return DataSource.fn.sync.call(that)\n                    .then(function() {\n                        that._restorePageSizeAfterAddChild();\n                    });\n            },\n\n            _syncEnd: function() {\n                var that = this;\n\n                if (that._isPageable()) {\n                    that._initDataMaps(that._getData());\n                }\n            }\n        });\n\n        TreeListDataSource.create = function(options) {\n            if (Array.isArray(options)) {\n                options = { data: options };\n            } else if (options instanceof ObservableArray) {\n                options = { data: options.toJSON() };\n            }\n\n            return options instanceof TreeListDataSource ? options : new TreeListDataSource(options);\n        };\n\n        function isCellVisible() {\n            return this.style.display !== \"none\";\n        }\n\n        function sortCells(cells) {\n            var indexAttr = kendo.attr(\"index\");\n            return cells.sort(function(a, b) {\n                a = $(a);\n                b = $(b);\n\n                var indexA = a.attr(indexAttr);\n                var indexB = b.attr(indexAttr);\n\n                if (indexA === undefined$1) {\n                    indexA = $(a).index();\n                }\n                if (indexB === undefined$1) {\n                    indexB = $(b).index();\n                }\n\n                indexA = parseInt(indexA, 10);\n                indexB = parseInt(indexB, 10);\n                return indexA > indexB ? 1 : (indexA < indexB ? -1 : 0);\n            });\n        }\n\n        function leafDataCells(container) {\n            var rows = container.find(\">tr:not(.k-filter-row)\");\n\n            var filter = function() {\n                var el = $(this);\n                return !el.hasClass(\"k-group-cell\") && !el.hasClass(\"k-hierarchy-cell\");\n            };\n\n            var cells = $();\n            if (rows.length > 1) {\n                cells = rows.find(\"th[data-index]\")\n                    .filter(filter);\n            }\n\n            cells = cells.add(rows.last().find(\"th\").filter(filter));\n\n            return sortCells(cells);\n        }\n\n        function createPlaceholders(options) {\n            var spans = [];\n            var className = options.className;\n\n            for (var i = 0, level = options.level; i < level; i++) {\n                spans.push(kendoDomElement(\"span\", { className: className }));\n            }\n\n            return spans;\n        }\n\n        function columnsWidth(cols) {\n            var colWidth, width = 0;\n\n            for (var idx = 0, length = cols.length; idx < length; idx++) {\n                colWidth = cols[idx].style.width;\n                if (colWidth && colWidth.indexOf(\"%\") == -1) {\n                    width += parseInt(colWidth, 10);\n                }\n            }\n\n            return width;\n        }\n\n        function syncTableHeight(table1, table2) {\n           table1 = table1[0];\n           table2 = table2[0];\n\n           if (table1.rows.length && table2.rows.length && table1.rows.length !== table2.rows.length) {\n               var lockedHeigth = table1.offsetHeight;\n               var tableHeigth = table2.offsetHeight;\n\n               var row;\n               var diff;\n               if (lockedHeigth > tableHeigth) {\n                   row = table2.rows[table2.rows.length - 1];\n\n                   if (filterRowRegExp.test(row.className)) {\n                       row = table2.rows[table2.rows.length - 2];\n                   }\n\n                   diff = lockedHeigth - tableHeigth;\n               } else {\n                   row = table1.rows[table1.rows.length - 1];\n\n                    if (filterRowRegExp.test(row.className)) {\n                        row = table1.rows[table1.rows.length - 2];\n                    }\n\n                   diff = tableHeigth - lockedHeigth;\n               }\n               row.style.height = row.offsetHeight + diff + \"px\";\n           }\n        }\n\n        var TreeListPager = ui.Pager.extend({\n            options: {\n                name: \"TreeListPager\"\n            },\n\n            totalPages: function() {\n                var that = this;\n                var dataSource = that.dataSource;\n\n                if (dataSource && dataSource._filter) {\n                    return ui.Pager.fn.totalPages.call(that);\n                }\n\n                return Math.ceil((that._collapsedTotal() || 0) / (that.pageSize() || 1));\n            },\n\n            _createDataSource: function(options) {\n                this.dataSource = kendo.data.TreeListDataSource.create(options.dataSource);\n            },\n\n            _collapsedTotal: function() {\n                var dataSource = this.dataSource;\n                return dataSource ? (dataSource.collapsedTotal() || 0) : 0;\n            }\n        });\n\n        var Editor = kendo.Observable.extend({\n            init: function(element, options) {\n                kendo.Observable.fn.init.call(this);\n\n                options = this.options = extend(true, {}, this.options, options);\n\n                this.element = element;\n\n                this.bind(this.events, options);\n\n                this.model = this.options.model;\n\n                this.fields = this._fields(this.options.columns);\n\n                this._initContainer();\n\n                this.createEditable();\n            },\n\n            options: {\n                renderForm: false\n            },\n\n            events: [],\n\n            _initContainer: function() {\n                this.wrapper = this.element;\n            },\n\n            createEditable: function() {\n                var options = this.options;\n\n                if (options.renderForm) {\n                    this.form = new ui.Form(this.wrapper.find(\".k-treelist-form\"), {\n                        items: this.fields,\n                        buttonsTemplate: function () { return ''; },\n                        formData: this.model,\n                        change: options.change\n                    });\n\n                    this.editable = this.form.editable;\n                } else {\n                    this.editable = new ui.Editable(this.wrapper, {\n                        fields: this.fields,\n                        target: options.target,\n                        clearContainer: options.clearContainer,\n                        model: this.model,\n                        change: options.change\n                    });\n                }\n            },\n\n            _isEditable: function(column) {\n                return isColumnEditable(column, this.model);\n            },\n\n            _fields: function(columns) {\n                var fields = [];\n                var idx, length, column;\n\n                for (idx = 0, length = columns.length; idx < length; idx++) {\n                    column = columns[idx];\n\n                    if (this._isEditable(column)) {\n                        fields.push({\n                            field: column.field,\n                            format: column.format,\n                            editor: column.editor,\n                            editorOptions: extend(true, { format: column.format }, column.editorOptions),\n                            label: column.title || column.field || \"\"\n                        });\n                    }\n                }\n\n                return fields;\n            },\n\n            end: function() {\n                return this.editable.end();\n            },\n\n            close: function() {\n                this.destroy();\n            },\n\n            destroy: function() {\n                this.editable.destroy();\n                this.editable.element\n                    .find(\"[\" + kendo.attr(\"container-for\") + \"]\")\n                    .empty()\n                    .end()\n                    .removeAttr(kendo.attr(\"role\"));\n\n                this.model = this.wrapper = this.element = this.columns = this.editable = null;\n            }\n        });\n\n        var PopupEditor = Editor.extend({\n            init: function(element, options) {\n                Editor.fn.init.call(this, element, options);\n\n                this._attachHandlers();\n                kendo.cycleForm(this.wrapper);\n\n                this.open();\n            },\n\n            events: [\n                CANCEL,\n                SAVE\n            ],\n\n            options: {\n                window: {\n                    modal: true,\n                    resizable: false,\n                    draggable: true,\n                    title: \"Edit\",\n                    visible: false\n                }\n            },\n\n            _initContainer: function() {\n                var options = this.options;\n                var formContent = [];\n\n                this.wrapper = $('<div class=\"k-popup-edit-form\"/>')\n                    .attr(kendo.attr(\"uid\"), this.model.uid)\n                    .append('<div class=\"k-edit-form-container\"/>');\n\n                if (options.template) {\n                    this._appendTemplate(formContent);\n                    this.fields = [];\n                } else {\n                    this.options.renderForm = true;\n                    formContent.push(kendoHtmlElement('<div class=\"k-treelist-form\"></div>'));\n                }\n                this._appendButtons(formContent);\n\n                new kendoDom.Tree(this.wrapper.children()[0]).render(formContent);\n\n                this.wrapper.appendTo(options.appendTo);\n\n                this.window = new ui.Window(this.wrapper, options.window);\n            },\n\n            _appendTemplate: function(form) {\n                var template = this.options.template;\n\n                if (typeof template === STRING) {\n                    template = kendo.unescape(template);\n                }\n\n                template = kendo.template(template)(this.model);\n\n                form.push(kendoHtmlElement(template));\n            },\n\n            _appendButtons: function(form) {\n                form.push(kendoDomElement(\"div\", {\n                    \"class\": \"k-edit-buttons\"\n                }, this.options.commandRenderer()));\n            },\n\n            _attachHandlers: function() {\n                var closeHandler = this._cancelProxy = this._cancel.bind(this);\n                this.wrapper.on(CLICK + NS, \".k-grid-cancel\", this._cancelProxy);\n\n                this._saveProxy = this._save.bind(this);\n                this.wrapper.on(CLICK + NS, \".k-grid-update\", this._saveProxy);\n\n                this.window.bind(\"close\", function(e) {\n                    if (e.userTriggered) {\n                        closeHandler(e);\n                    }\n                });\n            },\n\n            _detachHandlers: function() {\n                this._cancelProxy = null;\n                this._saveProxy = null;\n                this.wrapper.off(NS);\n            },\n\n            _cancel: function(e) {\n                this.trigger(CANCEL, e);\n            },\n\n            _save: function() {\n                this.trigger(SAVE);\n            },\n\n            open: function() {\n                this.window.center().open();\n            },\n\n            close: function() {\n                this.window.bind(\"deactivate\", this.destroy.bind(this)).close();\n            },\n\n            destroy: function() {\n                if (this.form) {\n                    this.form.destroy();\n                }\n\n                this.window.destroy();\n                this.window = null;\n                this._detachHandlers();\n\n                Editor.fn.destroy.call(this);\n            }\n        });\n\n        var IncellEditor = Editor.extend({\n            destroy: function() {\n                var that = this;\n\n                that.editable.destroy();\n\n                that.editable.element\n                    .off()\n                    .empty()\n                    .removeAttr(kendo.attr(\"role\"));\n\n                that.model = that.wrapper = that.element = that.columns = that.editable = null;\n            }\n        });\n\n        var TreeList = DataBoundWidget.extend({\n            init: function(element, options, events) {\n                DataBoundWidget.fn.init.call(this, element, options);\n\n                if (events) {\n                    this._events = events;\n                }\n\n                isRtl = kendo.support.isRtl(element);\n                this._dataSource(this.options.dataSource);\n                this._aria();\n                this._columns();\n                this._layout();\n                this._navigatable();\n                this._selectable();\n                this._sortable();\n                this._resizable();\n                this._filterable();\n                this._filterRow();\n                this._attachEvents();\n                this._toolbar();\n                this._scrollable();\n                this._reorderable();\n                this._columnMenu();\n                this._minScreenSupport();\n                this._draggable();\n                this._pageable();\n\n                if (this.options.autoBind) {\n                    this.dataSource.fetch();\n                }\n\n                if (this._hasLockedColumns) {\n                    var widget = this;\n                    this.wrapper.addClass(\"k-grid-lockedcolumns\");\n                    this._resizeHandler = function() { widget.resize(); };\n                    $(window).on(\"resize\" + NS, this._resizeHandler);\n                }\n\n                kendo.notify(this);\n            },\n\n            _draggable: function() {\n                var that = this;\n                var editable = this.options.editable;\n                var dataSource = that.dataSource;\n                var idField = dataSource._modelIdField();\n                var parentIdField = dataSource._modelParentIdField();\n                var pageable = that._isPageable();\n                var reorderable;\n\n                if (!editable || !editable.move) {\n                    return;\n                }\n\n                reorderable = editable.move.reorderable;\n\n                this._dragging = new kendo.ui.HierarchicalDragAndDrop(this.wrapper, {\n                    $angular: this.$angular,\n                    autoScroll: true,\n                    holdToDrag: touchDevice,\n                    filter: \"tbody>tr\",\n                    itemSelector: \"tr\",\n                    allowedContainers: this.wrapper,\n                    hintText: function(row) {\n                        var text = function() { return $(this).text(); };\n                        var separator = \"<span class='k-drag-separator'></span>\";\n                        return row.children(\"td\").map(text).toArray().join(separator);\n                    },\n                    contains: (function(source, destination) {\n                        var dest = this.dataItem(destination);\n                        var src = this.dataItem(source);\n\n                        return src == dest || this.dataSource.contains(src, dest);\n                    }).bind(this),\n                    itemFromTarget: function(target) {\n                        var tr = target.closest(\"tr\");\n                        var prevRow = tr.prev();\n                        var nextRow = tr.next();\n                        var first;\n                        var last;\n\n                        if (prevRow) {\n                            first = !that.sameLevel(prevRow, tr);\n                        }\n\n                        if (nextRow) {\n                            last = !that.sameLevel(nextRow, tr);\n                        }\n\n                        return {\n                            item: tr,\n                            content: tr,\n                            first: first,\n                            last: last\n                        };\n                    },\n                    dragstart: (function(source) {\n                        this.wrapper.addClass(\"k-treelist-dragging\");\n\n                        if (this.wrapper.find('.k-grid-content').length) {\n                            this.wrapper.find('.k-grid-content table, .k-grid-content-locked table').css(\"position\", \"relative\");\n                        }\n\n                        var model = this.dataItem(source);\n\n                        return this.trigger(DRAGSTART, { source: model });\n                    }).bind(this),\n                    drag: (function(e) {\n                        e.source = this.dataItem(e.source);\n\n                        this.trigger(DRAG, e);\n                    }).bind(this),\n                    drop: (function(e) {\n                        e.source = this.dataItem(e.source);\n                        e.destination = this.dataItem(e.destination);\n\n                        this.wrapper.removeClass(\"k-treelist-dragging\");\n\n                        if (this.wrapper.find('.k-grid-content').length) {\n                            this.wrapper.find('.k-grid-content table, .k-grid-content-locked table').css(\"position\", \"static\");\n                        }\n\n                        return this.trigger(DROP, e);\n                    }).bind(this),\n                    dragend: (function(e) {\n                        var dest = this.dataItem(e.destination);\n                        var src = this.dataItem(e.source);\n                        var originalSrcParentId = src[parentIdField];\n                        var originalSrcIndex = dataSource._indexInChildrenMap(src);\n                        var position = e.position;\n\n                        if (position == \"over\") {\n                            if (pageable) {\n                                dataSource._removeFromChildrenMap(src);\n                                src[parentIdField] = dest ? dest[idField] : null;\n\n                                dataSource._initChildrenMapForParent(dest);\n\n                                // src.set() below will not work as the parent id is already set\n                                src[parentIdField] = originalSrcParentId;\n                            }\n\n                            var isPrevented = src.set(\"parentId\", dest ? dest.id : null);\n\n                            if (pageable && isPrevented) {\n                                dataSource._removeFromChildrenMap(src);\n                                src[parentIdField] = originalSrcParentId;\n                                dataSource._removeFromChildrenMap(src);\n                                dataSource._insertInChildrenMap(src, originalSrcIndex);\n                            }\n\n\n                        } else {\n                            if (position == \"before\") {\n                                that.insertBefore(src, dest);\n                            } else if (position == \"after\") {\n                                that.insertAfter(src, dest);\n                            }\n                        }\n\n                        e.source = src;\n                        e.destination = dest;\n\n                        this.trigger(DRAGEND, e);\n                    }).bind(this),\n                    reorderable: reorderable,\n                    dropHintContainer: function(item) {\n                        return item.children(\"td:visible\").eq(0);\n                    },\n                    dropPositionFrom: function(dropHint) {\n                        var contents;\n                        var length;\n                        var i;\n                        var dropHintElement;\n                        var isAfterText = false;\n\n                        if (dropHint.parent().find('.k-i-none').length) {\n                            return dropHint.prevAll(\".k-i-none\").length > 0 ? \"after\" : \"before\";\n                        } else {\n                            contents = dropHint.parent().contents();\n                            length = contents.length;\n                            dropHintElement = dropHint[0];\n\n                            for (i = 0; i < length; i++) {\n                                if (contents[i] === dropHintElement) {\n                                    break;\n                                }\n\n                                if (contents[i].nodeType === 3) {\n                                    isAfterText = true;\n                                }\n                            }\n\n                            return isAfterText ? \"after\" : \"before\";\n                        }\n                    }\n                });\n            },\n\n            sameLevel: function() {\n               return arguments[0].find(\".\" + classNames.iconHidden).length === arguments[1].find(\".\" + classNames.iconHidden).length;\n            },\n\n            insertAfter: function(nodeData, referenceNode) {\n                this.insertAction(nodeData, referenceNode, 1);\n            },\n\n            insertBefore: function(nodeData, referenceNode) {\n                this.insertAction(nodeData, referenceNode, 0);\n            },\n\n            insertAction: function(nodeData, referenceNode, indexOffset) {\n                var that = this;\n                var dataSource = that.dataSource;\n                var parentIdField = dataSource._modelParentIdField();\n                var referenceNodeIndex;\n                var nodeDataIndex = dataSource.indexOf(nodeData);\n                var pageable = that._isPageable();\n                var originalDestIndex = dataSource._indexInChildrenMap(referenceNode);\n                var destIndex;\n                var childrenMap = dataSource._getChildrenMap() || {};\n                var parentId = nodeData[parentIdField];\n\n                that._unbindDataSource();\n                that._unbindDataChange();\n\n                if (pageable) {\n                    dataSource._removeFromChildrenMap(nodeData);\n                }\n\n                if (nodeData[parentIdField] != referenceNode[parentIdField]) {\n                     nodeData.set(\"parentId\", referenceNode && referenceNode.parentId ? referenceNode.parentId : null);\n                }\n\n                dataSource._data.splice(nodeDataIndex, 1);\n                referenceNodeIndex = dataSource.indexOf(referenceNode);\n                destIndex = referenceNodeIndex + indexOffset;\n\n                if (pageable) {\n                    originalDestIndex += indexOffset;\n\n                    if (childrenMap[parentId].length <= originalDestIndex) {\n                        originalDestIndex = childrenMap[parentId].length;\n                    }\n                    dataSource._insertInChildrenMap(nodeData, originalDestIndex);\n                }\n\n                dataSource._data.splice(destIndex, 0, nodeData);\n                dataSource._destroyed.pop();\n                that._bindDataChange();\n                that._bindDataSource();\n                that.refresh();\n            },\n\n            _bindDataChange: function() {\n                var dataSource = this.dataSource;\n                if (dataSource._data && dataSource._changeHandler) {\n                    dataSource._data.bind(CHANGE, dataSource._changeHandler);\n                    dataSource._data.trigger(CHANGE);\n                }\n            },\n\n            _unbindDataChange: function() {\n                var dataSource = this.dataSource;\n                if (dataSource._data && dataSource._changeHandler) {\n                    dataSource._data.unbind(CHANGE, dataSource._changeHandler);\n                }\n            },\n\n            _bindDataSource: function() {\n                var that = this;\n                var dataSource = that.dataSource;\n\n                if (dataSource) {\n                    dataSource.bind(CHANGE, that._refreshHandler);\n                }\n            },\n\n            _unbindDataSource: function() {\n                var that = this;\n                var dataSource = that.dataSource;\n\n                if (dataSource) {\n                    dataSource.unbind(CHANGE, that._refreshHandler);\n                }\n            },\n\n            itemFor: function(model) {\n                if (typeof model == \"number\") {\n                    model = this.dataSource.get(model);\n                }\n\n                return this.tbody.find(\"[\" + kendo.attr(\"uid\") + \"=\" + model.uid + \"]\");\n            },\n\n            _itemFor: function(model) {\n                var that = this;\n                var table = that.lockedContent ? that.lockedTable : that.table;\n\n                if (typeof model == \"number\") {\n                    model = this.dataSource.get(model);\n                }\n\n                return table.find(\"[\" + kendo.attr(\"uid\") + \"=\" + model.uid + \"]\");\n            },\n\n            _scrollable: function() {\n                if (this.options.scrollable) {\n                    var scrollables = this.thead.closest(\".k-grid-header-wrap\");\n                    var lockedContent = $(this.lockedContent)\n                        .on(\"DOMMouseScroll\" + NS + \" mousewheel\" + NS, this._wheelScroll.bind(this));\n\n                    this.content.on(\"scroll\" + NS, function() {\n                        kendo.scrollLeft(scrollables, this.scrollLeft);\n                        lockedContent.scrollTop(this.scrollTop);\n                    });\n\n\n                    var touchScroller = kendo.touchScroller(this.content);\n\n                    if (touchScroller && touchScroller.movable) {\n                        this._touchScroller = touchScroller;\n\n                        touchScroller.movable.bind(\"change\", function(e) {\n                            kendo.scrollLeft(scrollables, -e.sender.x);\n                            if (lockedContent) {\n                                lockedContent.scrollTop(-e.sender.y);\n                            }\n                        });\n                    }\n                }\n            },\n\n            _wheelScroll: function(e) {\n                if (e.ctrlKey) {\n                    return;\n                }\n\n                var delta = kendo.wheelDeltaY(e);\n                var lockedDiv = $(e.currentTarget);\n\n                if (delta) {\n                    if (lockedDiv[0].scrollHeight > lockedDiv[0].clientHeight &&\n                        (lockedDiv[0].scrollTop < lockedDiv[0].scrollHeight - lockedDiv[0].clientHeight && delta < 0 ||\n                        lockedDiv[0].scrollTop > 0 && delta > 0)) {\n                        e.preventDefault();\n                    }\n                    //In Firefox DOMMouseScroll event cannot be canceled\n                    lockedDiv.one(\"wheel\" + NS, false);\n\n                    this.content.scrollTop(this.content.scrollTop() + (-delta));\n                }\n            },\n\n            _progress: function() {\n                var messages = this.options.messages;\n\n                if (!this.tbody.find(\"tr\").length) {\n                    this._showStatus(\n                        kendo.template(\n                            function (ref) {\n                                var className = ref.className;\n                                var messages = ref.messages;\n\n                                return (\"<span class='\" + className + \"'></span> \" + (encode(messages.loading)));\n                    }\n                        )({\n                            className: classNames.icon + \" \" + classNames.loading,\n                            messages: messages\n                        })\n                    );\n                }\n            },\n\n            _error: function(e) {\n                if (!this.dataSource.rootNodes().length) {\n                    this._render({ error: e });\n                }\n            },\n\n            refresh: function(e) {\n                var that = this;\n                e = e || {};\n\n                if (e.action == \"itemchange\" && this.editor) {\n                    return;\n                }\n\n                if (this.trigger(DATABINDING)) {\n                    return;\n                }\n                var current = $(this.current());\n                var isCurrentInHeader = false;\n                var currentIndex;\n\n                this._cancelEditor();\n\n                this._render();\n\n                this._adjustHeight();\n\n                if (this.options.navigatable) {\n                    if (this._isActiveInTable() || this.editor) {\n                        isCurrentInHeader = current.is(\"th\");\n                        currentIndex = Math.max(this.cellIndex(current), 0);\n                    }\n                    this._restoreCurrent(currentIndex, isCurrentInHeader);\n                }\n\n                if (that._checkBoxSelection) {\n                    that._deselectCheckRows(that.items(), true);\n                }\n\n                this.trigger(DATABOUND);\n            },\n\n            _angularFooters: function(command) {\n                var i, footer, aggregates;\n                var allAggregates = this.dataSource.aggregates();\n                var footerRows = this._footerItems();\n\n                for (i = 0; i < footerRows.length; i++) {\n                    footer = footerRows.eq(i);\n                    aggregates = allAggregates[footer.attr(\"data-parentId\")];\n\n                    this._angularFooter(command, footer.find(\"td\").get(), aggregates);\n                }\n            },\n\n            _angularFooter: function(command, cells, aggregates) {\n                var columns = this.columns;\n                this.angular(command, function() {\n                    return {\n                        elements: cells,\n                        data: map(columns, function(col) {\n                            return {\n                                column: col,\n                                aggregate: aggregates && aggregates[col.field]\n                            };\n                        })\n                    };\n                });\n            },\n\n            items: function() {\n                if (this._hasLockedColumns) {\n                    return this._items(this.tbody).add(this._items(this.lockedTable));\n                } else {\n                    return this._items(this.tbody);\n                }\n            },\n\n            _items: function(container) {\n                return container.find(\"tr[data-uid]\").filter(function() {\n                    return !$(this).hasClass(classNames.footerTemplate);\n                });\n            },\n\n            _footerItems: function() {\n                var container = this.tbody;\n                if (this._hasLockedColumns) {\n                    container = container.add(this.lockedTable);\n                }\n\n                return container.find(\"tr\").filter(function() {\n                    return $(this).hasClass(classNames.footerTemplate);\n                });\n            },\n\n            dataItems: function() {\n                var dataItems = kendo.ui.DataBoundWidget.fn.dataItems.call(this);\n                if (this._hasLockedColumns) {\n                    var n = dataItems.length, tmp = new Array(2 * n);\n                    for (var i = n; --i >= 0;) {\n                        tmp[i] = tmp[i + n] = dataItems[i];\n                    }\n                    dataItems = tmp;\n                }\n\n                return dataItems;\n            },\n\n            _showNoRecordsTemplate: function() {\n                var wrapper = '<div class=\"{0}\">{1}</div>';\n                var defaultTemplate = '<div class=\"k-grid-norecords-template\"{1}>{0}</div>';\n                var scrollableNoGridHeightStyles = (this.options.scrollable && !this.wrapper[0].style.height) ? ' style=\"margin:0 auto;position:static;\"' : '';\n                var template;\n\n                this._contentTree.render([]);\n                if (this._hasLockedColumns) {\n                    this._lockedContentTree.render([]);\n                }\n\n                template = kendo.format(defaultTemplate, this.options.messages.noRows, scrollableNoGridHeightStyles);\n\n                $(kendo.template(function () { return kendo.format(wrapper, NORECORDSCLASS, template); })({})).insertAfter(this.table);\n            },\n\n            _showStatus: function(message) {\n                var status = this.element.find(\".k-status\");\n                var content = $(this.content).add(this.lockedContent);\n\n                if (!status.length) {\n                    status = $(\"<div class='k-status' role='alert' aria-live='polite' />\").appendTo(this.element);\n                }\n\n                this._contentTree.render([]);\n                if (this._hasLockedColumns) {\n                    this._lockedContentTree.render([]);\n                }\n\n                content.hide();\n\n                status.html(message);\n            },\n\n            _hideStatus: function() {\n                this.element.find(\".k-status\").remove();\n                this._hideNoRecordsTempalte();\n\n                $(this.content).add(this.lockedContent).show();\n            },\n\n            _hideNoRecordsTempalte: function() {\n                this.element.find(\".\" + NORECORDSCLASS).remove();\n            },\n\n            _adjustHeight: function() {\n                var that = this;\n                var element = this.element;\n                var contentWrap = element.find(DOT + classNames.gridContentWrap);\n                var header = element.find(DOT + classNames.gridHeader);\n                var toolbar = element.find(DOT + classNames.gridToolbar);\n                var status = element.find(DOT + classNames.status);\n                var pagerHeight = that._isPageable() && that.pager && that.pager.element.is(\":visible\") ? outerHeight(that.pager.element) : 0;\n                var height;\n                var scrollbar = kendo.support.scrollbar();\n\n                element.css(HEIGHT, this.options.height);\n\n                // identical code found in grid & scheduler :(\n                var isHeightSet = function(el) {\n                    var initialHeight, newHeight;\n                    if (el[0].style.height) {\n                        return true;\n                    } else {\n                        initialHeight = el.height();\n                    }\n\n                    el.height(\"auto\");\n                    newHeight = el.height();\n                    el.height(\"\");\n\n                    return (initialHeight != newHeight);\n                };\n\n                if (isHeightSet(element)) {\n                    height = element.height() - outerHeight(header) - outerHeight(toolbar) - outerHeight(status) - pagerHeight;\n\n                    contentWrap.height(height);\n\n                    if (this._hasLockedColumns) {\n                        scrollbar = this.table[0].offsetWidth > this.table.parent()[0].clientWidth ? scrollbar : 0;\n                        this.lockedContent.height(height - scrollbar);\n                    }\n                }\n            },\n\n            _resize: function(size, force) {\n                this._applyLockedContainersWidth();\n                this._adjustHeight();\n\n                if (this.pager && this.pager.element) {\n                    this.pager.resize(force);\n                }\n            },\n\n            _minScreenSupport: function() {\n                var any = this.hideMinScreenCols();\n\n                if (any) {\n                    this.minScreenResizeHandler = this.hideMinScreenCols.bind(this);\n                    $(window).on(\"resize\", this.minScreenResizeHandler);\n                }\n            },\n\n            _iterateMinScreenCols: function(cols, screenWidth) {\n                var any = false;\n\n                for (var i = 0; i < cols.length; i++) {\n                    var col = cols[i];\n                    var minWidth = col.minScreenWidth;\n                    if (minWidth !== undefined$1 && minWidth !== null) {\n                        any = true;\n                        if (minWidth > screenWidth) {\n                            this.hideColumn(col);\n                        } else {\n                            this.showColumn(col);\n                        }\n                    }\n                    if (!col.hidden && col.columns) {\n                        any = this._iterateMinScreenCols(col.columns, screenWidth) || any;\n                    }\n                }\n                return any;\n            },\n\n            hideMinScreenCols: function() {\n                var cols = this.columns,\n                    screenWidth = (window.innerWidth > 0) ? window.innerWidth : screen.width;\n\n                return this._iterateMinScreenCols(cols, screenWidth);\n            },\n\n            destroy: function() {\n                this._destroyColumnAttachments();\n\n                DataBoundWidget.fn.destroy.call(this);\n\n                var dataSource = this.dataSource;\n\n                dataSource.unbind(CHANGE, this._refreshHandler);\n                dataSource.unbind(ERROR, this._errorHandler);\n                dataSource.unbind(PROGRESS, this._progressHandler);\n\n                this._navigatableTables = null;\n                this._current = null;\n\n                if (this._resizeHandler) {\n                    $(window).off(\"resize\" + NS, this._resizeHandler);\n                }\n\n                if (this._dragging) {\n                    this._dragging.destroy();\n                    this._dragging = null;\n                }\n\n                if (this.resizable) {\n                    this.resizable.destroy();\n                    this.resizable = null;\n                }\n\n                if (this.reorderable) {\n                    this.reorderable.destroy();\n                    this.reorderable = null;\n                }\n\n                if (this._draggableInstance && this._draggableInstance.element) {\n                    this._draggableInstance.destroy();\n                    this._draggableInstance = null;\n                }\n\n                if (this.selectable) {\n                    this.selectable.destroy();\n                }\n\n                if (this._userEvents) {\n                    this._userEvents.destroy();\n                    this._userEvents = null;\n                }\n\n                if (this.minScreenResizeHandler) {\n                    $(window).off(\"resize\", this.minScreenResizeHandler);\n                }\n\n                this._destroyEditor();\n\n                this.element.off(NS);\n                if (this.wrapper) {\n                    this.wrapper.off(NS);\n                }\n\n                if (this._touchScroller) {\n                    this._touchScroller.destroy();\n                }\n\n                this._destroyPager();\n\n                if (dataSource) {\n                    dataSource._dataMaps = null;\n                }\n\n                this._autoExpandable = null;\n\n                this._refreshHandler = this._errorHandler = this._progressHandler = this._dataSourceFetchProxy = null;\n\n                this.thead =\n                    this.content =\n                    this.tbody =\n                    this.table =\n                    this.element =\n                    this.lockedHeader =\n                    this.lockedContent = null;\n\n                this._statusTree =\n                    this._headerTree =\n                    this._contentTree =\n                    this._lockedHeaderColsTree =\n                    this._lockedContentColsTree =\n                    this._lockedHeaderTree =\n                    this._lockedContentTree = null;\n\n                kendo.destroy(this.wrapper);\n            },\n\n            options: {\n                name: \"TreeList\",\n                columns: [],\n                autoBind: true,\n                scrollable: true,\n                selectable: false,\n                sortable: false,\n                toolbar: null,\n                height: null,\n                columnMenu: false,\n                messages: {\n                    noRows: \"No records to display\",\n                    loading: \"Loading...\",\n                    requestFailed: \"Request failed.\",\n                    retry: \"Retry\",\n                    commands: {\n                        edit: \"Edit\",\n                        update: \"Update\",\n                        canceledit: \"Cancel\",\n                        create: \"Add new record\",\n                        createchild: \"Add child record\",\n                        destroy: \"Delete\",\n                        excel: \"Export to Excel\",\n                        pdf: \"Export to PDF\",\n                        search: \"Search...\"\n                    }\n                },\n                excel: {\n                    hierarchy: true\n                },\n                resizable: false,\n                search: false,\n                filterable: false,\n                editable: false,\n                reorderable: false,\n                pageable: false,\n                renderAllRows: true,\n                rowTemplate: null,\n                altRowTemplate: null\n            },\n\n            events: [\n                CHANGE,\n                BEFORE_EDIT,\n                EDIT,\n                PAGE,\n                SAVE,\n                SAVE_CHANGES,\n                REMOVE,\n                EXPAND,\n                COLLAPSE,\n                DATABINDING,\n                DATABOUND,\n                CANCEL,\n                DRAGSTART,\n                DRAG,\n                DROP,\n                DRAGEND,\n                FILTERMENUINIT,\n                ITEM_CHANGE,\n                CELL_CLOSE,\n                FILTERMENUOPEN,\n                COLUMNHIDE,\n                COLUMNSHOW,\n                COLUMNREORDER,\n                COLUMNRESIZE,\n                COLUMNMENUINIT,\n                COLUMNMENUOPEN,\n                COLUMNLOCK,\n                COLUMNUNLOCK,\n                FILTER,\n                NAVIGATE,\n                SORT\n            ],\n\n            getOptions: function() {\n                var options = this.options;\n                options.dataSource = null;\n\n                var result = extend(true, {}, this.options);\n                result.columns = kendo.deepExtend([], this.columns);\n\n                var dataSource = this.dataSource;\n\n                var initialData = dataSource.options.data && dataSource._data;\n                dataSource.options.data = null;\n\n                result.dataSource = $.extend(true, {}, dataSource.options);\n\n                dataSource.options.data = initialData;\n\n                result.dataSource.data = initialData;\n                result.dataSource.page = dataSource.page();\n                result.dataSource.filter = $.extend(true, {}, dataSource.filter());\n                result.dataSource.pageSize = dataSource.pageSize();\n                result.dataSource.sort = dataSource.sort();\n                result.dataSource.group = dataSource.group();\n                result.dataSource.aggregate = dataSource.aggregate();\n\n                if (result.dataSource.transport) {\n                    result.dataSource.transport.dataSource = null;\n                }\n\n                if (result.pageable && result.pageable.pageSize) {\n                    result.pageable.pageSize = dataSource.pageSize();\n                }\n\n                result.$angular = undefined$1;\n\n                return result;\n            },\n\n            setOptions: function(options) {\n                var currentOptions = this.getOptions();\n                kendo.deepExtend(currentOptions, options);\n                if (!options.dataSource) {\n                    currentOptions.dataSource = this.dataSource;\n                }\n                var wrapper = this.wrapper;\n                var events = this._events;\n                var element = this.element;\n\n                this.destroy();\n                this.options = null;\n                if (wrapper[0] !== element[0]) {\n                    wrapper.before(element);\n                    wrapper.remove();\n                }\n                element.empty();\n\n                this.init(element, currentOptions, events);\n                this._setEvents(currentOptions);\n            },\n\n            _destroyColumnAttachments: function() {\n                var that = this;\n\n                if (!that.thead) {\n                    return;\n                }\n\n                this.angular(\"cleanup\", function() {\n                    return { elements: that.thead.get() };\n                });\n\n                that.thead.add(that.lockedHeader).find(\"th\").each(function() {\n                    var th = $(this),\n                        filterMenu = th.data(\"kendoFilterMenu\"),\n                        sortable = th.data(\"kendoColumnSorter\"),\n                        columnMenu = th.data(\"kendoColumnMenu\");\n\n                    if (filterMenu) {\n                        filterMenu.destroy();\n                    }\n\n                    if (sortable) {\n                        sortable.destroy();\n                    }\n\n                    if (columnMenu) {\n                        columnMenu.destroy();\n                    }\n                });\n            },\n\n            _toggle: function(model, expand) {\n                var that = this;\n                var defaultPromise = $.Deferred().resolve().promise();\n                var loaded = model.loaded();\n\n                 if (that._isIncellEditable() && that.editor) {\n                    // manually trigger change as the expand/collapse icons are not focusable\n                    $(activeElement()).change();\n                    that.closeCell();\n                }\n\n                // reset error state\n                if (model._error) {\n                    model.expanded = false;\n                    model._error = undefined$1;\n                }\n\n                // do not load items that are currently loading\n                if (!loaded && model.expanded) {\n                    return defaultPromise;\n                }\n\n                // toggle expanded state\n                if (typeof expand == \"undefined\") {\n                    expand = !model.expanded;\n                }\n\n                model.expanded = expand;\n\n                function afterModelLoaded() {\n                    that._toggleData();\n                    if (that._isPageable()) {\n                        that.refresh();\n                    } else {\n                        that._render();\n                    }\n                    that._syncLockedContentHeight();\n                }\n\n                if (!loaded) {\n                    defaultPromise = this.dataSource.load(model)\n                        .always((function() {\n                            afterModelLoaded();\n                        }));\n                }\n\n                afterModelLoaded();\n\n                return defaultPromise;\n            },\n\n            _toggleData: function() {\n                var that = this;\n\n                if (that._isPageable()) {\n                    that._togglePageableData();\n                }\n            },\n\n            _togglePageableData: function() {\n                var that = this;\n                var dataSource = that.dataSource;\n                var data = dataSource._getData();\n                var result;\n                var queryOptions = dataSource._defaultPageableQueryOptions();\n\n                that._renderProgress(true);\n\n                var childrenMap = dataSource._getChildrenMap() || dataSource.childrenMap(dataSource._getData());\n\n                dataSource._processDataItemsState(data, childrenMap);\n\n                result = dataSource._processPageableQuery(data, queryOptions);\n\n                queryOptions.childrenMap = result.childrenMap;\n                queryOptions.filteredChildrenMap = result.filteredChildrenMap;\n\n                dataSource._aggregateResult = dataSource._calculateAggregates(result.dataToAggregate, queryOptions);\n\n                dataSource.view(result.data);\n\n                if (!dataSource.filter()) {\n                    dataSource._calculateCollapsedTotal();\n                }\n\n                that._refreshPager();\n\n                that._renderProgress(false);\n            },\n\n            _refreshPager: function() {\n                var pager = this.pager;\n\n                if (pager) {\n                    pager.refresh();\n                }\n            },\n\n            expand: function(row) {\n                return this._toggle(this.dataItem(row), true);\n            },\n\n            collapse: function(row) {\n                return this._toggle(this.dataItem(row), false);\n            },\n\n            _toggleChildren: function(e) {\n                var icon = $(e.target);\n                var model = this.dataItem(icon);\n\n                if (!model) {\n                    return;\n                }\n\n                var event = !model.expanded ? EXPAND : COLLAPSE;\n\n                if (!this.trigger(event, { model: model })) {\n                    this._toggle(model);\n                }\n\n                e.preventDefault();\n            },\n\n            _navigatable: function() {\n                var that = this;\n\n                if (!that.options.navigatable) {\n                    return;\n                }\n                var tables = that.table.add(that.lockedTable);\n\n                var headerTables = that.thead.parent().add($(\">table\", that.lockedHeader));\n                if (that.options.scrollable) {\n                    //add the header table when the widget is scrollable\n                    tables = tables.add(headerTables);\n                    //data tables will recive first focus on TAB\n                    headerTables.attr(TABINDEX, -1);\n                }\n\n                headerTables\n                    .on(\"keydown\" + NS, that._openHeaderMenu.bind(that))\n                    .find(\"a.k-link\").attr(\"tabIndex\", -1);\n\n                this._navigatableTables = tables;\n\n                tables\n                    //handle click on tables, will attempt to focus the table\n                    .on((kendo.support.touch ? \"touchstart\" + NS : \"mousedown\" + NS), NAVROW + \">:visible\", that._tableClick.bind(that))\n                    .on(\"focus\" + NS, that._tableFocus.bind(that))\n                    .on(\"focusout\" + NS, that._tableBlur.bind(that))\n                    .on(\"keydown\" + NS, that._tableKeyDown.bind(that));\n            },\n\n            _openHeaderMenu: function(e) {\n                if (e.altKey && e.keyCode == keys.DOWN) {\n                    this.current().find(\".k-grid-filter, .k-header-column-menu\").click();\n                    e.stopImmediatePropagation();\n                }\n            },\n\n            cellIndex: function(td) {\n                var lockedColumnOffset = 0;\n\n                if (this.lockedTable && !$.contains(this.lockedTable[0], td[0])) {\n                    lockedColumnOffset = leafColumns(lockedColumns(this.columns)).length;\n                }\n\n                return $(td).parent().children().index(td) + lockedColumnOffset;\n            },\n\n            _isActiveInTable: function() {\n                var active = kendo._activeElement();\n\n                if (!active) { return false; }\n\n                return this.table[0] === active ||\n                    $.contains(this.table[0], active) ||\n                    (this.lockedTable &&\n                        (this.lockedTable[0] === active || $.contains(this.lockedTable[0], active))\n                    );\n            },\n\n            _restoreCurrent: function(currentIndex, isCurrentInHeader) {\n                var rowIndex;\n                var row;\n                var td;\n\n                if (currentIndex === undefined$1 || currentIndex < 0) {\n                    return;\n                }\n\n                if (this._current) {\n                    this._current.removeClass(\"k-focus\");\n                }\n\n                if (isCurrentInHeader) {\n                    this._setCurrent(this.thead.find(\"th\").eq(currentIndex));\n                } else {\n                    rowIndex = 0;\n                    currentIndex = 0;\n\n                    row = $();\n\n                    if (this.lockedTable) {\n                        row = this.lockedTable.find(\">tbody>tr:visible\").eq(rowIndex);\n                    }\n                    row = row.add(this.tbody.children().eq(rowIndex));\n\n                    td = row.find(\">td:visible\")\n                        .eq(currentIndex);\n\n                    this._setCurrent(td);\n                }\n\n                if (this._current) {\n                    focusTable(this._current.closest(\"table\")[0], true);\n                }\n            },\n\n            current: function(newCurrent) {\n                return this._setCurrent(newCurrent, true);\n            },\n\n            _setCurrent: function(newCurrent, preventTrigger, isIncellEditable) {\n                var that = this;\n                var current = that._current;\n                newCurrent = $(newCurrent);\n\n                if (isIncellEditable) {\n                    if (newCurrent[0]) {\n                        that._current = newCurrent;\n                        that._updateCurrentAttr(that._current, newCurrent);\n                        that._scrollCurrent();\n\n                        if (!preventTrigger) {\n                            this.trigger(NAVIGATE, {\n                                element: newCurrent\n                            });\n                        }\n                    }\n                } else {\n                    if (newCurrent.length && (!current || current[0] !== newCurrent[0])) {\n                        this._updateCurrentAttr(current, newCurrent);\n\n                        this._scrollCurrent();\n\n                        if (!preventTrigger) {\n                            this.trigger(NAVIGATE, {\n                                element: newCurrent\n                            });\n                        }\n                    }\n\n                    if (newCurrent && newCurrent.length) {\n                        this._lastCellIndex = newCurrent.parent().children(DATA_CELL).index(newCurrent);\n                    }\n                }\n\n                return that._current;\n            },\n\n            _scrollCurrent: function() {\n                var current = this._current;\n                var scrollable = this.options.scrollable;\n\n                if (!current || !scrollable) {\n                    return;\n                }\n\n                var row = current.parent();\n                var tableContainer = row.closest(\"table\").parent();\n\n                var isInLockedContainer = tableContainer.is(\".k-grid-content-locked,.k-grid-header-locked\");\n                var isInContent = tableContainer.is(\".k-grid-content-locked,.k-grid-content\");\n\n                var scrollableContainer = $(this.content)[0];\n\n                //adjust scroll vertically\n                if (isInContent) {\n                    this._scrollTo(this._relatedRow(row)[0], scrollableContainer);\n                }\n\n                if (this.lockedContent) {\n                    //sync locked and non-locked content scrollTop\n                    this.lockedContent[0].scrollTop = scrollableContainer.scrollTop;\n                }\n\n                //adjust scroll horizontally, if not inside locked tables\n                if (!isInLockedContainer) {\n                    this._scrollTo(current[0], scrollableContainer);\n                }\n            },\n\n            _findCurrentCell: function() {\n                var that = this;\n                var current = that.current();\n                var elements = $(that.table).add(that.header).add(that.lockedTable).add(that.lockedHeader);\n\n                if (current && elements.find(current).length > 0) {\n                    return current;\n                } else {\n                    return elements.find(DOT + classNames.focused);\n                }\n            },\n\n            _scrollTo: function(element, container) {\n                var elementToLowercase = element.tagName.toLowerCase();\n                var isHorizontal = elementToLowercase === \"td\" || elementToLowercase === \"th\";\n                var table = $(element).closest(\"table\")[0];\n                var elementOffsetDir = element[isHorizontal ? \"offsetWidth\" : \"offsetHeight\"];\n                var containerScroll = container[isHorizontal ? \"scrollLeft\" : \"scrollTop\"];\n                var containerOffsetDir = container[isHorizontal ? \"clientWidth\" : \"clientHeight\"];\n                var elementOffset = $(element).css(\"position\") === \"relative\" && isRtl && isHorizontal ? Math.abs(table.offsetLeft - element.offsetLeft) : element[isHorizontal ? \"offsetLeft\" : \"offsetTop\"];\n                var bottomDistance = elementOffset + elementOffsetDir;\n                var result = 0;\n                var ieCorrection = 0;\n                var firefoxCorrection = 0;\n\n                if (isRtl && isHorizontal) {\n                    if (browser.msie || browser.edge) {\n                        ieCorrection = table.offsetLeft;\n                    } else if (browser.mozilla || (browser.webkit && (browser.version > 85))) {\n                        firefoxCorrection = table.offsetLeft - kendo.support.scrollbar();\n                    }\n                }\n                containerScroll = Math.abs(containerScroll + ieCorrection - firefoxCorrection);\n                if (containerScroll > elementOffset) {\n                    result = elementOffset;\n                } else if (bottomDistance > (containerScroll + containerOffsetDir)) {\n                    if (elementOffsetDir <= containerOffsetDir) {\n                        result = (bottomDistance - containerOffsetDir);\n                    } else {\n                        result = elementOffset;\n                    }\n                } else {\n                    result = containerScroll;\n                }\n                result = Math.abs(result + ieCorrection) + firefoxCorrection;\n                container[isHorizontal ? \"scrollLeft\" : \"scrollTop\"] = result;\n            },\n\n            _aria: function() {\n                var id = this.element.attr(\"id\") || \"aria\";\n\n                if (id) {\n                    this._elementId = id + \"_active_element\";\n                }\n            },\n\n            _currentDataIndex: function(table, current) {\n                var index = current.attr(\"data-index\");\n\n                if (!index) {\n                    return undefined$1;\n                }\n\n                var lockedColumnsCount = lockedColumns(this.columns).length;\n                if (lockedColumnsCount && !table.closest(\"div\").hasClass(\"k-grid-content-locked\")[0]) {\n                    return index - lockedColumnsCount;\n                }\n\n                return index;\n            },\n\n            _prevVerticalCell: function(container, current) {\n                var cells;\n                var row = current.parent();\n                var rows = container.children(NAVROW);\n                var rowIndex = rows.index(row);\n                //get data-index in case of last level of multi-level columns\n                var index = this._currentDataIndex(container, current);\n                var cellSelector = DATA_CELL + \",\" + FILTER_CELL;\n\n                //current is in the header, but not at the last level of multi-level columns\n                if (index || current.hasClass(\"k-header\")) {\n                    cells = parentColumnsCells(current);\n                    return cells.eq(cells.length - 2);\n                }\n\n                index = Math.max(row.children(cellSelector).index(current), this._lastCellIndex || 0);\n\n                //if current is inside filter row\n                if (row.hasClass(\"k-filter-row\")) {\n                    return leafDataCells(container).filter(isCellVisible).eq(index);\n                }\n\n                //move up to header container\n                if (rowIndex == -1) {\n                    //is there filter row in the header container\n                    row = container.find(\"tr.k-filter-row:visible\");\n                    if (!row[0]) {\n                        return leafDataCells(container).filter(isCellVisible).eq(index);\n                    }\n                } else {\n                    row = rowIndex === 0 ? $() : rows.eq(rowIndex - 1);\n                }\n\n                cells = row.children(cellSelector);\n                if (cells.length > index) {\n                    return cells.eq(index);\n                }\n\n                return cells.eq(0);\n            },\n\n            _nextVerticalCell: function(container, current) {\n                var cells;\n                var row = current.parent();\n                var rows = container.children(NAVROW);\n                var rowIndex = rows.index(row);\n                //get data-index in case of last level of multi-level columns\n                var index = this._currentDataIndex(container, current);\n                var cellSelector = DATA_CELL + \",\" + FILTER_CELL;\n\n                //current is in the header, but not at the last level of multi-level columns\n                //and we are not changing the table\n                if (rowIndex != -1 && index === undefined$1 && current.hasClass(\"k-header\")) {\n                    return childColumnsCells(current).eq(1);\n                }\n\n                index = index ? parseInt(index, 10) : row.children(cellSelector).index(current);\n                index = Math.max(index, this._lastCellIndex || 0);\n\n                //move down to data container\n                if (rowIndex == -1) {\n                    row = rows.eq(0);\n                } else {\n                    row = rows.eq(rowIndex + current[0].rowSpan);\n                }\n\n                var tmpIndex = index;\n                //in case of last level of multi-level columns the index should be updated depending on the hidden columns\n                if (this._currentDataIndex(container, current) !== undefined$1) {\n                    var currentRowCells = row.children(\":not(.k-group-cell):not(.k-hierarchy-cell)\");\n                    var hiddenColumns = currentRowCells.filter(\":hidden\");\n                    for (var idx = 0, length = hiddenColumns.length; idx < length; idx++) {\n                        if (currentRowCells.index(hiddenColumns[idx]) < index) {\n                            tmpIndex--;\n                        }\n                    }\n                }\n                index = tmpIndex;\n\n                cells = row.children(cellSelector);\n                if (cells.length > index) {\n                    return cells.eq(index);\n                }\n\n                return cells.eq(0);\n            },\n\n            _verticalContainer: function(container, up) {\n                var table = container.parent();\n                var length = this._navigatableTables.length;\n                var step = Math.floor(length / 2);\n                var index = inArray(table[0], this._navigatableTables);\n\n                if (up) {\n                    step *= -1;\n                }\n                index += step;\n\n                if (index >= 0 || index < length) {\n                    table = this._navigatableTables.eq(index);\n                }\n\n                return table.find(up ? \"thead\" : \"tbody\");\n            },\n\n            _updateCurrentAttr: function(current, next) {\n                var headerId = $(current).data(\"headerId\");\n\n                $(current)\n                    .removeClass(classNames.focused)\n                    .closest(\"table\")\n                    .removeAttr(\"aria-activedescendant\");\n\n                if (headerId) {\n                    headerId = headerId.replace(this._elementId, \"\");\n                    $(current).attr(\"id\", headerId);\n                } else {\n                    $(current).removeAttr(\"id\");\n                }\n\n                next\n                    .data(\"headerId\", next.attr(\"id\"))\n                    .attr(\"id\", this._elementId)\n                    .addClass(classNames.focused)\n                    .closest(\"table\")\n                    .attr(\"aria-activedescendant\", this._elementId);\n\n                this._current = next;\n            },\n\n            _tableKeyDown: function(e) {\n                var handled = false;\n                var current = this.current();\n                var target = $(e.target);\n                var canHandle = !e.isDefaultPrevented() && !target.is(\":button,a,:input,a>.k-icon\");\n\n                current = current ? current : $(this.lockedTable).add(this.table).find(NAVROW + \" > td:visible\").first();\n\n                if (canHandle && e.keyCode == keys.UP) {\n                    handled = this._moveUp(current, e.shiftKey);\n                }\n\n                if (canHandle && e.keyCode == keys.DOWN) {\n                    handled = this._moveDown(current, e.shiftKey);\n                }\n\n                if (canHandle && e.keyCode == (isRtl ? keys.LEFT : keys.RIGHT)) {\n                    if (e.altKey) {\n                        handled = this._handleExpand(current);\n                    } else {\n                        handled = this._moveRight(current);\n                    }\n                }\n\n                if (canHandle && e.keyCode == (isRtl ? keys.RIGHT : keys.LEFT)) {\n                    if (e.altKey) {\n                        handled = this._handleCollapse(current);\n                    } else {\n                        handled = this._moveLeft(current);\n                    }\n                }\n\n                if (canHandle && e.keyCode == keys.PAGEDOWN) {\n                    handled = this._handlePageDown();\n                }\n\n                if (canHandle && e.keyCode == keys.PAGEUP) {\n                    handled = this._handlePageUp();\n                }\n\n                if (e.keyCode == keys.ENTER || e.keyCode == keys.F2) {\n                    handled = this._handleEnterKey(current, e.currentTarget, target);\n                }\n\n                if (e.keyCode == keys.ESC) {\n                    handled = this._handleEscKey(current, e.currentTarget);\n                }\n\n                if (canHandle && e.keyCode == keys.HOME) {\n                    handled = this._handleHome(current, e.ctrlKey);\n                }\n\n                if (canHandle && e.keyCode == keys.END) {\n                    handled = this._handleEnd(current, e.ctrlKey);\n                }\n\n                if (e.keyCode == keys.TAB) {\n                    handled = this._handleTabKey(current, e.currentTarget, e.shiftKey);\n                }\n\n                if (handled) {\n                    //prevent scrolling while pressing the keys\n                    e.preventDefault();\n                    //required in hierarchy\n                    e.stopPropagation();\n                }\n            },\n\n            _handleExpand: function(current) {\n                var that = this;\n                var row = current.parent();\n                var model = that.dataItem(row);\n\n                if (current.hasClass(\"k-header\")) {\n                    return false;\n                }\n\n                if (model && model.hasChildren && !model.expanded && !that.trigger(EXPAND, { model: model })) {\n                    this.expand(row);\n                    return true;\n                }\n\n                return false;\n            },\n\n            _handleCollapse: function(current) {\n                var that = this;\n                var row = current.parent();\n                var model = that.dataItem(row);\n\n                if (current.hasClass(\"k-header\")) {\n                    return false;\n                }\n\n                if (model && model.hasChildren && model.expanded && !that.trigger(COLLAPSE, { model: model })) {\n                    that.collapse(row);\n                    return true;\n                }\n\n                return false;\n            },\n\n            _handleHome: function(current, ctrl) {\n                var row = current.parent();\n                var rowContainer = row.parent();\n                var isInLockedTable = this.lockedTable && this.lockedTable.children(\"tbody\")[0] === rowContainer[0];\n                var isInBody = rowContainer[0] === this.tbody[0];\n                var prev;\n\n                if (ctrl) {\n                    if (this.lockedTable) {\n                        prev = this.lockedTable.find(NAVROW + \" > td:visible\").first();\n                    } else {\n                        prev = this.table.find(NAVROW + \" > td:visible\").first();\n                    }\n                } else if (isInBody || isInLockedTable) {\n                    if (isInBody && this.lockedTable) {\n                        row = this._relatedRow(row);\n                    }\n                    prev = row.children(NAVCELL).first();\n                }\n\n                if (prev && prev.length) {\n                    this._setCurrent(prev);\n                    return true;\n                }\n            },\n\n            _handleEnd: function(current, ctrl) {\n                var row = current.parent();\n                var rowContainer = row.parent();\n                var isInLockedTable = this.lockedTable && this.lockedTable.children(\"tbody\")[0] === rowContainer[0];\n                var isInBody = rowContainer[0] === this.tbody[0];\n                var next;\n\n                if (ctrl) {\n                    next = this.table.find(ITEMROW).last().children(NAVCELL).last();\n                } else if (isInBody || isInLockedTable) {\n                    if (!isInBody && this.lockedTable) {\n                        row = this._relatedRow(row);\n                    }\n                    next = row.children(NAVCELL).last();\n                }\n\n                if (next && next.length) {\n                    this._setCurrent(next);\n                    return true;\n                }\n            },\n\n            _handlePageDown: function() {\n                var that = this;\n\n                if (!that._isPageable()) {\n                    return false;\n                }\n\n                that.dataSource._restorePageSizeAfterAddChild();\n                that.dataSource.page(that.dataSource.page() + 1);\n\n                return true;\n            },\n\n            _handlePageUp: function() {\n                var that = this;\n\n                if (!that._isPageable()) {\n                    return false;\n                }\n\n                that.dataSource._restorePageSizeAfterAddChild();\n                that.dataSource.page(that.dataSource.page() - 1);\n\n                return true;\n            },\n\n            _handleEscKey: function(current, currentTable) {\n                var active = kendo._activeElement();\n                var currentIndex;\n                var that = this;\n                var row;\n                var rowIndex;\n                var cellIndex;\n                var tbody;\n\n                if (!current || !current.parent().hasClass(\"k-grid-edit-row\")) {\n                    if (current.has(active).length) {\n                        // return focus back to the table\n                        focusTable(currentTable, true);\n\n                        return true;\n                    }\n                    return false;\n                }\n\n                if (that._isIncellEditable()) {\n                    row = current.parent();\n                    cellIndex = current.index();\n                    rowIndex = row.index();\n                    tbody = row.closest(\"tbody\");\n\n                    that.closeCell(true);\n\n                    // refresh the current element as the DOM element reference can be changed after render()\n                    // moving this to closeCell() causes flickering when clicking on a cell and then on another\n                    // as 'k-focused' is shown for the closing cell and then added to the newly edited cell\n                    that._setCurrent(tbody.children().eq(rowIndex).children().eq(cellIndex), false, true);\n                } else {\n                    currentIndex = $(current).parent().index();\n                    if (active) {\n                        active.blur();\n                    }\n                    this.cancelRow();\n                    if (currentIndex >= 0) {\n                        this._setCurrent(this.items().eq(currentIndex).children(NAVCELL).first());\n                    }\n                }\n\n                focusTable(currentTable, true);\n\n                return true;\n            },\n\n            _handleEnterKey: function(current, currentTable, target) {\n                var editable = this.options.editable;\n                var container = target.closest(\"[role=gridcell]\");\n                var focusable;\n\n                if (!target.is(\"table\") && !$.contains(current[0], target[0])) {\n                    current = container;\n                }\n\n                if (current.is(\"th\")) {\n                    // sort the column, if possible\n                    current.find(\".k-link\").click();\n                    return true;\n                }\n\n                focusable = current.find(\":kendoFocusable\").first();\n                if (focusable[0] && current.hasClass(\"k-focus\")) {\n                    focusable.trigger(\"focus\");\n\n                    return true;\n                }\n\n                if (editable && !target.is(\":button,.k-button,textarea\")) {\n                    if (!container[0]) {\n                        container = current;\n                    }\n\n                    this._handleEditing(container, false, currentTable);\n\n                    return true;\n                }\n\n                return false;\n            },\n\n            _handleTabKey: function(current, currentTable, shiftKey) {\n                var that = this;\n                var incellEditing = that.options.editable && that._isIncellEditable();\n                var cell;\n\n                if (!incellEditing || current.is(\"th\")) {\n                    return false;\n                }\n\n                cell = $(activeElement()).closest(DOT + classNames.editCell);\n\n                if (cell[0] && cell[0] !== current[0]) {\n                    current = cell;\n                }\n\n                cell = that._tabNext(current, currentTable, shiftKey);\n\n                if (cell.length) {\n                    that._handleEditing(current, cell, cell.closest(TABLE));\n                    return true;\n                } else {\n                    that._preventPageSizeRestore = false;\n                }\n\n                return false;\n            },\n\n            _tabNext: function(current, currentTable, back) {\n                var that = this;\n                var switchRow = true;\n                var next = back ? current.prevAll(DATA_CELL).first() : current.nextAll(\":visible\").first();\n\n                if (!next.length) {\n                    next = current.parent();\n                    if (that.lockedTable) {\n                        switchRow = (back && currentTable == that.lockedTable[0]) || (!back && currentTable == that.table[0]);\n                        next = that._relatedRow(next);\n                    }\n\n                    if (switchRow) {\n                        next = next[back ? \"prevAll\" : \"nextAll\"](\"tr:not(.k-grouping-row):not(.k-detail-row):visible\").first();\n                    }\n\n                    if (back) {\n                        next = next.children(DATA_CELL).last();\n                    } else {\n                        next = next.children(DATA_CELL).first();\n                    }\n\n\n                    that.dataSource._restorePageSizeAfterAddChild();\n                }\n\n                return next;\n            },\n\n            _handleEditing: function(current, next, table) {\n                var that = this,\n                    active = $(kendo._activeElement()),\n                    isIE = browser.msie,\n                    editContainer,\n                    focusable,\n                    isEdited;\n                var editable = that.options.editable && that.options.editable.update !== false;\n                var incellEditing = that._isIncellEditable();\n                var nextFocusableCellRowIndex = $(next).parents(\"tr\").index();\n                var nextFocusableCellIndex = $(next).index();\n                var currentFocusedCellRowIndex = $(current).parents(\"tr\").index();\n                var currentFocusedCellIndex = current.index();\n                var editedCell;\n\n                table = $(table);\n\n                if (incellEditing) {\n                    isEdited = current.hasClass(classNames.editCell);\n                } else {\n                    isEdited = current.parent().hasClass(\"k-grid-edit-row\");\n                }\n\n                if (that.editor) {\n                    editContainer = that.editor.wrapper;\n                    if (editContainer && $.contains(editContainer[0], active[0])) {\n                        if (browser.opera) {\n                            active.trigger(\"blur\").change().triggerHandler(\"blur\");\n                        } else {\n                            active.trigger(\"blur\");\n                            if (isIE) {\n                                //IE10 with jQuery 1.9.x does not trigger blur handler\n                                //numeric textbox does trigger change\n                                active.trigger(\"blur\");\n                            }\n                        }\n                    }\n\n                    if (!that.editor) {\n                        focusTable(table);\n                        return;\n                    }\n\n                    if (that.editor.end()) {\n                        if (incellEditing) {\n                            that._preventPageSizeRestore = true;\n                            that.closeCell();\n                            that._preventPageSizeRestore = false;\n\n                            if ($(that.table).add(that.lockedTable).find(DOT + classNames.editCell).length === 0) {\n                                that._setCurrent(table.find(\"tbody\").children().eq(currentFocusedCellRowIndex).children().eq(currentFocusedCellIndex));\n                            }\n                        } else {\n                            that.saveRow();\n                            isEdited = true;\n                        }\n                    } else {\n                        if (incellEditing) {\n                            that._setCurrent(editContainer);\n                        } else {\n                            that._setCurrent(editContainer.children().filter(NAVCELL).first());\n                        }\n\n                        focusable = editContainer.find(\":kendoFocusable\").first()[0];\n                        if (focusable) {\n                            focusable.focus();\n                        }\n                        return;\n                    }\n                }\n\n                // the next cell to focus might be re-rendered, so update the reference to it if it is an element\n                next = $(next).length && table.find(next).length === 0 ? table.find(\"tbody\").children().eq(nextFocusableCellRowIndex).children().eq(nextFocusableCellIndex) : next;\n\n                if (next) {\n                    that._setCurrent(next);\n                }\n\n                focusTable(table, true);\n\n                if (!editable) {\n                    return;\n                }\n\n                if ((!isEdited && !next) || next) {\n                    var currentIndex = that.current().index();\n\n                    if (incellEditing) {\n                        that.editCell(that.current());\n\n                        editedCell = $(that.table).add(that.lockedTable).find(DOT + classNames.editCell)[0];\n\n                        if (editedCell) {\n                            that._current = $(editedCell);\n                        } else {\n                            that._setCurrent(that._findCurrentCell());\n                        }\n                    } else {\n                        that.editRow(that.current().parent());\n                        that._setCurrent(that.editor.wrapper.children().eq(currentIndex));\n                        that.current().removeClass(\"k-focus\");\n                    }\n                } else {\n                    that.dataSource._restorePageSizeAfterAddChild();\n                }\n            },\n\n            _moveRight: function(current) {\n                var next = current.nextAll(NAVCELL).first();\n                var row = current.parent();\n                var rowIndex = row.index();\n\n                if (current.hasClass(\"k-header\") || row.is('.k-filter-row')) {\n                    next = current.nextAll(NAVHEADER).first();\n                    if (!next[0] && this.lockedTable && current.closest(\"table\")[0] === this.lockedHeader.find(\"table\")[0]) {\n                        next = this.thead.find(\"tr\").eq(rowIndex).find(NAVHEADER).first();\n                    }\n                }\n\n                if (!next[0] && this.lockedTable && current.closest(\"table\")[0] === this.lockedTable[0]) {\n                   next = this._relatedRow(row).children(NAVCELL).first();\n                }\n\n                if (next[0] && next[0] !== current[0]) {\n                    focusTable(next.closest(\"table\"), true);\n                }\n\n                this._setCurrent(next);\n\n                return true;\n            },\n\n            _moveLeft: function(current) {\n                var prev = current.prevAll(NAVCELL).first();\n                var row = current.parent();\n                var rowIndex = row.index();\n\n                if (current.hasClass(\"k-header\") || row.is('.k-filter-row')) {\n                    prev = current.prevAll(NAVHEADER).first();\n                    if (!prev[0] && this.lockedTable && current.closest(\"table\")[0] === this.thead.parent()[0]) {\n                        prev = this.lockedHeader.find(\">table>thead>tr\").eq(rowIndex).children(NAVHEADER).last();\n                    }\n                }\n\n                if (!prev[0] && this.lockedTable && current.closest(\"table\")[0] === this.table[0]) {\n                   prev = this._relatedRow(row).children(NAVCELL).last();\n                }\n\n                if (prev[0] && prev[0] !== current[0]) {\n                    focusTable(prev.closest(\"table\"), true);\n                }\n\n                this._setCurrent(prev);\n\n                return true;\n            },\n\n            _moveUp: function(current, shiftKey) {\n                var container = current.parent().parent();\n                var prev;\n\n                if (shiftKey) {\n                   prev = current.parent();\n                   prev = prev.prevAll(ITEMROW).first();\n                   prev = current.parent().is(ITEMROW) ? prev.children().eq(current.index()) : prev.children(DATA_CELL).last();\n                } else {\n                   prev = this._prevVerticalCell(container, current);\n                   if (!prev[0]) {\n                      this._lastCellIndex = 0;\n                      container = this._verticalContainer(container, true);\n\n                      prev = this._prevVerticalCell(container, current);\n\n                      if (prev[0]) {\n                          focusTable(container.parent(), true);\n                      }\n                   }\n                }\n\n                var tmp = this._lastCellIndex || 0;\n                this._setCurrent(prev);\n                this._lastCellIndex = tmp;\n\n                return true;\n            },\n\n            _moveDown: function(current, shiftKey) {\n                var container = current.parent().parent();\n                var next;\n\n                if (shiftKey) {\n                    next = current.parent();\n                    next = next.nextAll(ITEMROW).first();\n                    next = current.parent().is(ITEMROW) ? next.children().eq(current.index()) : next.children(DATA_CELL).first();\n                } else {\n                    next = this._nextVerticalCell(container, current);\n                    if (!next[0]) {\n                        this._lastCellIndex = 0;\n                        container = this._verticalContainer(container);\n\n                        next = this._nextVerticalCell(container, current);\n                        if (next[0]) {\n                            focusTable(container.parent(), true);\n                        }\n                    }\n                }\n                var tmp = this._lastCellIndex || 0;\n                this._setCurrent(next);\n                this._lastCellIndex = tmp;\n                return true;\n            },\n\n            _tableClick: function(e) {\n                var currentTarget = $(e.currentTarget),\n                    isHeader = currentTarget.is(\"th\"),\n                    table = this.table.add(this.lockedTable),\n                    headerTable = this.thead.parent().add($(\">table\", this.lockedHeader)),\n                    isInput = isInputElement(e.target),\n                    currentTable = currentTarget.closest(\"table\")[0];\n\n                if (kendo.support.touch) {\n                    return;\n                }\n\n                if (currentTable !== table[0] && currentTable !== table[1] && currentTable !== headerTable[0] && currentTable !== headerTable[1]) {\n                    return;\n                }\n\n                if (this.options.navigatable) {\n                    this._setCurrent(currentTarget);\n                }\n\n                if (isHeader || !isInput) {\n                    setTimeout(function() {\n                       if (!isInputElement(kendo._activeElement()) || !$.contains(currentTable, kendo._activeElement())) {\n                           focusTable(currentTable, true);\n                       }\n                    });\n                }\n\n                if (isHeader) {\n                    e.preventDefault(); //if any problem occurs, call preventDefault only for the clicked header links\n                }\n            },\n\n            _setTabIndex: function(table) {\n                this._navigatableTables.attr(TABINDEX, -1);\n\n                table.attr(TABINDEX, 0);\n            },\n\n            _tableFocus: function(e) {\n                var current = this.current();\n                var table = $(e.currentTarget);\n\n                if (current && current.is(\":visible\")) {\n                    current.addClass(classNames.focused);\n                } else {\n                    this._setCurrent(table.find(NAVROW + \" > td:visible\").first());\n                }\n\n                this._setTabIndex(table);\n            },\n\n            _tableBlur: function() {\n                var current = this.current();\n\n                if (current) {\n                    current.removeClass(classNames.focused);\n                }\n            },\n\n            _attachEvents: function() {\n                var that = this;\n                var retryButton = DOT + classNames.retry;\n\n                that._userEvents = new kendo.UserEvents(that.element, {\n                    press: that._onPress.bind(that),\n                    allowSelection: true\n                });\n\n                this.element\n                    .on(CLICK + NS, retryButton, this._dataSourceFetchProxy)\n                    .on(CLICK + NS, \".k-button[data-command]\", this._commandClick.bind(this))\n                    .on(INPUT + NS, \".k-grid-search input\", this._search.bind(this));\n\n                this._attachCellEditingEventHandlers();\n            },\n\n            _onPress: function(e) {\n                var that = this;\n                var icons = DOT + classNames.iconCollapse +\n                    \", .\" + classNames.iconExpand +\n                    \", .\" + classNames.refresh;\n\n                if ($(e.event.target).is(icons)) {\n                    that._toggleChildren.call(that, e.event);\n                }\n            },\n\n            _attachCellEditingEventHandlers: function() {\n                var that = this;\n                var editable = that.options.editable;\n                var selectable = that.selectable && that.selectable.options.multiple;\n                var closeCell = function(e) {\n                    var target = activeElement();\n                    var editor = that.editor || {};\n                    var cell = editor.element;\n\n                    if (cell && !$.contains(cell[0], target) && cell[0] !== target && !$(target).closest(\".k-animation-container\").length) {\n                        if (editor.end()) {\n                            if (!e.relatedTarget && that._isPageable() && !isUndefined(that.dataSource._addChildPageSize)) {\n                                that._preventPageSizeRestore = false;\n                            }\n\n                            that.closeCell();\n                        }\n                    }\n\n                    that._preventPageSizeRestore = false;\n                };\n\n                if (that._isIncellEditable() && editable.update !== false) {\n                    that.wrapper\n                        .on(CLICK + NS, \"tr:not(.k-grouping-row) > td\", function(e) {\n                            var td = $(this),\n                                isLockedCell = that.lockedTable && td.closest(\"table\")[0] === that.lockedTable[0];\n\n                            if (td.hasClass(classNames.editCell) ||\n                                td.has(\"a.k-grid-delete\").length ||\n                                td.has(\"button.k-grid-delete\").length ||\n                                (td.closest(\"tbody\")[0] !== that.tbody[0] && !isLockedCell) ||\n                                $(e.target).is(\":input\") ||\n                                $(e.target).hasClass(classNames.iconExpand) ||\n                                $(e.target).hasClass(classNames.iconCollapse)) {\n\n                                if (!that.editor) {\n                                    that.dataSource._restorePageSizeAfterAddChild();\n                                }\n\n                                that._preventPageSizeRestore = false;\n\n                                return;\n                            }\n\n                            if (that.editor) {\n                                if (that.editor.end()) {\n                                    if (selectable) {\n                                        $(activeElement()).trigger(\"blur\");\n                                    }\n                                    that.closeCell();\n                                    that.editCell(td);\n                                }\n                            } else {\n                                that.editCell(td);\n                            }\n                        })\n                        .on(\"mousedown\" + NS, \"tr:not(.k-grouping-row) > td\", function(e) {\n                            // cache the result on \"mousedown\", which is fired before \"focusout\" and \"click\"\n                            if (that.editor && that._isPageable() && !isUndefined(that.dataSource._addChildPageSize)) {\n                                that._preventPageSizeRestore = $(e.target).parents(DOT + classNames.editRow).length > 0;\n                            } else {\n                                that._preventPageSizeRestore = false;\n                            }\n                        })\n                        .on(\"focusin\" + NS, function() {\n                            // fix focus issue in IE\n                            if (!$.contains(this, activeElement())) {\n                                clearTimeout(that._closeCellTimeout);\n                                that._closeCellTimeout = null;\n                            }\n                        })\n                        .on(\"focusout\" + NS, function(e) {\n                            that._closeCellTimeout = setTimeout(function() {\n                                closeCell(e);\n                            }, 1);\n                        });\n                }\n            },\n\n            _commandByName: function(name) {\n                var columns = this.columns;\n                var toolbar = Array.isArray(this.options.toolbar) ? this.options.toolbar : [];\n                var i, j, commands, currentName;\n\n                name = name.toLowerCase();\n\n                if (defaultCommands[name]) {\n                    return defaultCommands[name];\n                }\n\n                // command not found in defaultCommands, must be custom\n                for (i = 0; i < columns.length; i++) {\n                    commands = columns[i].command;\n                    if (commands) {\n                        for (j = 0; j < commands.length; j++) {\n                            currentName = commands[j].name;\n\n                            if (!currentName) {\n                                continue;\n                            }\n\n                            if (currentName.toLowerCase() == name) {\n                                return commands[j];\n                            }\n                        }\n                    }\n                }\n\n                // custom command in toolbar\n                for (i = 0; i < toolbar.length; i++) {\n                    currentName = toolbar[i].name;\n\n                    if (!currentName) {\n                        continue;\n                    }\n\n                    if (currentName.toLowerCase() == name) {\n                        return toolbar[i];\n                    }\n                }\n            },\n\n            _commandClick: function(e) {\n                var button = $(e.currentTarget);\n                var commandName = button.attr(\"data-command\");\n                var command = this._commandByName(commandName);\n                var row = button.parentsUntil(this.wrapper, \"tr\");\n\n                row = row.length ? row : undefined$1;\n\n                if (command) {\n                    if (command.methodName) {\n                        this[command.methodName](row);\n                    } else if (command.click) {\n                        command.click.call(this, e);\n                    }\n\n                    e.preventDefault();\n                }\n            },\n\n            _search: function(e) {\n                var that = this;\n                var input = e.currentTarget;\n                clearTimeout(that._searchTimeOut);\n                that._searchTimeOut = setTimeout(function() {\n                    that._searchTimeOut = null;\n                    var options = that.options;\n                    var searchFields = options.search ? options.search.fields : null;\n                    var expression = { filters: [], logic: \"or\" };\n                    var value = input.value;\n\n                    if (!searchFields) {\n                        searchFields = getColumnsFields(options.columns);\n                    }\n\n                    if (value) {\n                        for (var i = 0; i < searchFields.length; i++) {\n                            expression.filters.push({ field: searchFields[i], operator: \"contains\", value: value });\n                        }\n                    } else {\n                        expression = {};\n                    }\n\n                    that.dataSource.filter(expression);\n\n                }, 300);\n            },\n\n            _ensureExpandableColumn: function() {\n                if (this._autoExpandable) {\n                    delete this._autoExpandable.expandable;\n                }\n\n                var visibleColumns = grep(this.columns, not(is(\"hidden\")));\n                visibleColumns = grep(visibleColumns, not(is(\"command\")));\n                visibleColumns = grep(visibleColumns, not(is(\"selectable\")));\n                var expandableColumns = grep(visibleColumns, is(\"expandable\"));\n\n                if (this.columns.length && !expandableColumns.length) {\n                    this._autoExpandable = visibleColumns[0];\n                    visibleColumns[0].expandable = true;\n                }\n            },\n\n            _columns: function() {\n                var that = this;\n                var columns = this.options.columns || [];\n\n                this.columns = map(columns, function(column) {\n                    column = (typeof column === \"string\") ? { field: column } : column;\n\n                    return extend({ encoded: true }, column);\n                });\n\n                var lockedCols = lockedColumns(columns);\n                if (lockedCols.length > 0) {\n                    if (this.options.rowTemplate || this.options.altRowTemplate) {\n                        throw new Error(\"Having both row template and locked columns is not supported\");\n                    }\n                    this._hasLockedColumns = true;\n                    this.columns = lockedCols.concat(nonLockedColumns(this.columns));\n                }\n\n                this.columns = normalizeColumns(this.columns);\n\n                this._ensureExpandableColumn();\n\n                this._columnTemplates();\n                this._columnAttributes();\n\n                if ($.grep(leafColumns(that.columns), function(col) {\n                    if (col.selectable) {\n                        that._includeChildren = col.includeChildren;\n                    }\n                    return col.selectable;\n                }).length) {\n                    that._checkBoxSelection = true;\n                    that.element.on(CLICK + NS, \"tbody > tr \" + CHECKBOXINPUT, that._checkboxClick.bind(that));\n                    that.element.on(CLICK + NS, \"thead > tr \" + CHECKBOXINPUT, that._headerCheckboxClick.bind(that));\n                }\n            },\n\n            _columnTemplates: function() {\n                var idx, length, column;\n                var columns = leafColumns(this.columns);\n\n                for (idx = 0, length = columns.length; idx < length; idx++) {\n                    column = columns[idx];\n                    if (column.template) {\n                        column.template = kendo.template(column.template);\n                    }\n\n                    if (this._isIncellEditable()) {\n                        column.dirtyCellTemplate = this._createDirtyColumnTemplate(column);\n                        column.dirtyIndicatorTemplate = this._createIndicatorTemplate(column);\n                    }\n\n                    if (column.headerTemplate) {\n                        column.headerTemplate = kendo.template(column.headerTemplate);\n                    }\n\n                    if (column.footerTemplate) {\n                        column.footerTemplate = kendo.template(column.footerTemplate);\n                    }\n                }\n            },\n\n            _columnAttributes: function() {\n                // column style attribute is string, kendo.dom expects object\n                var idx, length;\n                var columns = this.columns;\n\n                function convertStyle(attr) {\n                    var properties, i, declaration;\n\n                    if (attr && attr.style && attr.style.split) {\n                        properties = attr.style.split(\";\");\n                        attr.style = {};\n\n                        for (i = 0; i < properties.length; i++) {\n                            declaration = properties[i].split(\":\");\n\n                            var name = kendo.trim(declaration[0]);\n\n                            if (name) {\n                                attr.style[$.camelCase(name)] = kendo.trim(declaration[1]);\n                            }\n                        }\n                    }\n                }\n\n                for (idx = 0, length = columns.length; idx < length; idx++) {\n                    convertStyle(columns[idx].attributes);\n                    convertStyle(columns[idx].headerAttributes);\n                }\n            },\n\n            _clearSortClasses: function() {\n                var that = this;\n\n                if (that.content) {\n                    that.content.find(\"col:not(.k-group-col):not(.k-hierarchy-col)\").removeClass(\"k-sorted\");\n                }\n\n                if (that.lockedContent) {\n                    that.lockedContent.find(\"col:not(.k-group-col):not(.k-hierarchy-col)\").removeClass(\"k-sorted\");\n                }\n            },\n\n            _layout: function() {\n                var this$1$1 = this;\n\n                var that = this;\n                var columns = this.columns;\n                var element = this.element;\n\n                this.wrapper = element.addClass(classNames.wrapper);\n\n                var layoutTemplateFunction = function (ref) {\n                    var gridHeader = ref.gridHeader;\n                    var gridHeaderWrap = ref.gridHeaderWrap;\n                    var gridContentWrap = ref.gridContentWrap;\n                    var toolbar = ref.toolbar;\n                    var gridToolbar = ref.gridToolbar;\n\n                    var layout = \"<div class='\" + gridHeader + \"'>\";\n                    if (this$1$1._hasLockedColumns) {\n                        layout += \"<div class='k-grid-header-locked'>\" +\n                                        \"<table role='grid'>\" +\n                                            \"<colgroup></colgroup>\" +\n                                            \"<thead role='rowgroup'></thead>\" +\n                                        \"</table>\" +\n                                    \"</div>\";\n                    }\n\n                    layout += \"<div class='\" + gridHeaderWrap + \"'>\" +\n                                    \"<table role='grid'>\" +\n                                        \"<colgroup></colgroup>\" +\n                                        \"<thead role='rowgroup'></thead>\" +\n                                    \"</table>\" +\n                                \"</div>\" +\n                            \"</div>\";\n\n                    if (this$1$1._hasLockedColumns) {\n                        layout += \"<div class='k-grid-content-locked'>\" +\n                                        \"<table role='treegrid' tabindex='0'>\" +\n                                            \"<colgroup></colgroup>\" +\n                                            \"<tbody></tbody>\" +\n                                        \"</table>\" +\n                                    \"</div>\";\n                    }\n\n                    layout += \"<div class='\" + gridContentWrap + \" k-auto-scrollable'>\" +\n                                    \"<table role='treegrid' tabindex='0'>\" +\n                                        \"<colgroup></colgroup>\" +\n                                        \"<tbody></tbody>\" +\n                                    \"</table>\" +\n                                \"</div>\";\n\n                    if (!this$1$1.options.scrollable) {\n                        layout =\n                            \"<table role='treegrid' tabindex='0'>\" +\n                                \"<colgroup></colgroup>\" +\n                                \"<thead class='\" + gridHeader + \"' role='rowgroup'></thead>\" +\n                                \"<tbody></tbody>\" +\n                            \"</table>\";\n                    }\n\n                    if (this$1$1.options.toolbar) {\n                        layout = \"<div class='\" + toolbar + \" \" + gridToolbar + \"'></div>\" + layout;\n                    }\n\n                    return layout;\n                };\n\n                layoutTemplateFunction = layoutTemplateFunction.bind(that);\n\n                element.append(\n                    kendo.template(layoutTemplateFunction)(classNames) +\n                    \"<div class='k-status' role='alert' aria-live='polite'></div>\"\n                );\n\n                this.toolbar = element.find(DOT + classNames.gridToolbar);\n\n                var header = element.find(DOT + classNames.gridHeader).find(\"thead\").addBack().filter(\"thead\");\n                this.thead = header.last();\n\n                if (this.options.scrollable) {\n                    var rtl = kendo.support.isRtl(element);\n\n                    element.find(\"div.\" + classNames.gridHeader)\n                        .css(rtl ? \"padding-left\" : \"padding-right\", kendo.support.scrollbar());\n                }\n\n\n                var content = element.find(DOT + classNames.gridContentWrap);\n                if (!content.length) {\n                    content = element;\n                } else {\n                    this.content = content;\n                }\n\n                this.table = content.find(\">table\");\n                this.tbody = this.table.find(\">tbody\");\n\n                if (this._hasLockedColumns) {\n                    this.lockedHeader = header.first().closest(\".k-grid-header-locked\");\n                    this.lockedContent = element.find(\".k-grid-content-locked\");\n                    this.lockedTable = this.lockedContent.children();\n                }\n\n                this._initVirtualTrees();\n\n                this._renderCols();\n                this._renderHeader();\n\n                this.angular(\"compile\", function() {\n                    return {\n                        elements: header.find(\"th.k-header\").get(),\n                        data: map(columns, function(col) { return { column: col }; })\n                    };\n                });\n            },\n\n            _initVirtualTrees: function() {\n                this._headerColsTree = new kendoDom.Tree(this.thead.prev()[0]);\n                this._contentColsTree = new kendoDom.Tree(this.tbody.prev()[0]);\n                this._headerTree = new kendoDom.Tree(this.thead[0]);\n                this._contentTree = new kendoDom.Tree(this.tbody[0]);\n                this._statusTree = new kendoDom.Tree(this.element.children(\".k-status\")[0]);\n\n                if (this.lockedHeader) {\n                    this._lockedHeaderColsTree = new kendoDom.Tree(this.lockedHeader.find(\"colgroup\")[0]);\n                    this._lockedContentColsTree = new kendoDom.Tree(this.lockedTable.find(\">colgroup\")[0]);\n                    this._lockedHeaderTree = new kendoDom.Tree(this.lockedHeader.find(\"thead\")[0]);\n                    this._lockedContentTree = new kendoDom.Tree(this.lockedTable.find(\">tbody\")[0]);\n                }\n            },\n\n            _toolbar: function() {\n                var options = this.options.toolbar;\n                var toolbar = this.toolbar;\n\n                if (!options) {\n                    return;\n                }\n\n                if (Array.isArray(options)) {\n                    var buttons = this._buildCommands(options);\n                    new kendoDom.Tree(toolbar[0]).render(buttons);\n                } else {\n                    toolbar.append(kendo.template(options)({}));\n                }\n\n                this.angular(\"compile\", function() {\n                    return { elements: toolbar.get() };\n                });\n            },\n\n            _lockedColumns: function() {\n                return grep(this.columns, is(\"locked\"));\n            },\n\n            _nonLockedColumns: function() {\n                return grep(this.columns, not(is(\"locked\")));\n            },\n\n            _templateColumns: function() {\n                return grep(this.columns, is(\"template\"));\n            },\n\n            _flushCache: function() {\n                if (this.options.$angular && this._templateColumns().length) {\n                    this._contentTree.render([]);\n                    if (this._hasLockedColumns) {\n                        this._lockedContentTree.render([]);\n                    }\n                }\n            },\n\n            _render: function(options) {\n                var that = this;\n                options = options || {};\n                options = that._renderOptions(options);\n                var messages = this.options.messages;\n                var pageable = that._isPageable();\n                var dataSource = that.dataSource;\n\n                var maps = { children: (options.filteredChildrenMap || options.childrenMap), ids: options.idsMap };\n                var dataMaps = pageable ? (maps && maps.children && maps.ids ? maps : dataSource._initDataMaps(dataSource._getData())) : {};\n                var childrenMap = dataMaps.children;\n                var idsMap = dataMaps.ids;\n                options.childrenMap = childrenMap;\n                options.idsMap = idsMap;\n\n                var data = that._dataToRender(options);\n                var level = that._renderedModelLevel(data[0], options);\n                var uidAttr = kendo.attr(\"uid\");\n                var hasFooterTemplate;\n                var selected = this.select().removeClass(\"k-selected\").map(function(_, row) {\n                    return $(row).attr(uidAttr);\n                });\n                var viewChildrenMap;\n\n                this._absoluteIndex = 0;\n\n                this._angularItems(\"cleanup\");\n                this._angularFooters(\"cleanup\");\n                this._flushCache();\n\n                that._clearRenderMap();\n\n                if (options.error) {\n                    // root-level error message\n                    this._showStatus(kendo.template(\n                        function (ref) {\n                            var messages = ref.messages;\n                            var buttonClass = ref.buttonClass;\n\n                            return (encode(messages.requestFailed)) + \" \" +\n                        \"<button class='\" + buttonClass + \" k-button-md k-rounded-md k-button-solid k-button-solid-base'><span class='k-button-text'>\" + (encode(messages.retry)) + \"</span></button>\";\n                    }\n                    )({\n                        buttonClass: [classNames.button, classNames.retry].join(\" \"),\n                        messages: messages\n                    }));\n                } else if (!data.length) {\n                    // no rows message\n                    this._hideStatus();\n                    this._showNoRecordsTemplate();\n                } else {\n                    if (pageable) {\n                        viewChildrenMap = that._viewChildrenMap(options);\n                    }\n\n                    // render rows\n                    this._hideStatus();\n\n                    hasFooterTemplate = this._hasFooterTemplate();\n\n                    this._contentTree.render(this._trs({\n                        columns: leafColumns(nonLockedColumns(this.columns)),\n                        editedColumn: options.editedColumn,\n                        editedColumnIndex: options.editedColumnIndex,\n                        aggregates: options.aggregates,\n                        selected: selected,\n                        data: data,\n                        childrenMap: childrenMap,\n                        viewChildrenMap: viewChildrenMap,\n                        hasFooterTemplate: hasFooterTemplate,\n                        visible: true,\n                        level: 0\n                    }));\n\n                    if (this._hasLockedColumns) {\n                        this._absoluteIndex = 0;\n                        this._lockedContentTree.render(this._trs({\n                            columns: leafColumns(lockedColumns(this.columns)),\n                            editedColumn: options.editedColumn,\n                            editedColumnIndex: options.editedColumnIndex,\n                            aggregates: options.aggregates,\n                            selected: selected,\n                            data: data,\n                            childrenMap: childrenMap,\n                            viewChildrenMap: viewChildrenMap,\n                            hasFooterTemplate: hasFooterTemplate,\n                            visible: true,\n                            level: level\n                        }));\n                    }\n                }\n\n                if (this._touchScroller) {\n                    this._touchScroller.contentResized();\n                }\n\n                this._muteAngularRebind(function() {\n                    this._angularItems(\"compile\");\n                    this._angularFooters(\"compile\");\n                });\n\n                this.items().filter(function() {\n                    return $.inArray($(this).attr(uidAttr), selected) >= 0;\n                })\n                .addClass(\"k-selected\");\n\n                this._syncLockedContentHeight();\n\n                that._togglePagerVisibility();\n\n                that._setExpanderElement();\n            },\n\n            _setExpanderElement: function() {\n                var that = this,\n                    hiddenDivClass = 'k-grid-content-expander',\n                    hiddenDiv = '<div class=\"' + hiddenDivClass + '\"></div>',\n                    expander;\n\n                if (that.options.scrollable && that.wrapper.is(\":visible\")) {\n                    expander = that.table.parent().children('.' + hiddenDivClass);\n                    if (!that.dataSource || !that.dataSource.view().length) {\n                        if (!expander[0]) {\n                            expander = $(hiddenDiv).appendTo(that.table.parent());\n                        }\n                        if (that.thead) {\n                            expander.width(that.thead.width());\n                        }\n                    } else if (expander[0]) {\n                        expander.remove();\n                    }\n                }\n            },\n\n            _renderProgress: function(toggle) {\n                kendo.ui.progress(this.wrapper, toggle);\n            },\n\n            _renderOptions: function(options) {\n                options = options || {};\n                var that = this;\n                var dataMaps = that.dataSource._getDataMaps();\n                var filter = that.dataSource.filter();\n\n                if (that._isPageable()) {\n                    options.childrenMap = dataMaps.children;\n                    options.idsMap = dataMaps.ids;\n\n                    if (filter) {\n                        options.filteredChildrenMap = dataMaps.filteredChildren;\n                    }\n                }\n\n                return options;\n            },\n\n            _renderedModelLevel: function(model, options) {\n                return !this._isPageable() ? 0 : this.dataSource._pageableModelLevel(model, options);\n            },\n\n            _viewChildrenMap: function(options) {\n                options = options || {};\n                var that = this;\n                var dataSource = that.dataSource;\n                var viewChildrenMap = dataSource.childrenMap(dataSource.view());\n                var idField = dataSource._modelIdField();\n                var parentsNotInView = dataSource._parentNodesNotInView();\n                var parentNotInView;\n                var parentNotInViewId;\n                var parents;\n                var parent;\n                var parentId;\n                var child;\n                var childId;\n                var parentsCopy;\n\n                that._clearRenderMap();\n\n                for (var i = 0; i < parentsNotInView.length; i++) {\n                    parentNotInView = parentsNotInView[i];\n                    parentNotInViewId = parentNotInView[idField];\n\n                    that._markNodeAsNonRenderable(parentNotInViewId);\n\n                    viewChildrenMap[parentNotInViewId] = viewChildrenMap[parentNotInViewId] || [];\n\n                    parents = dataSource._parentNodes(parentNotInView);\n\n                    // copy the items to avoid mutating the original collection\n                    parentsCopy = parents.slice();\n                    parentsCopy.push(parentNotInView);\n\n                    for (var parentIndex = 0; parentIndex < parentsCopy.length - 1; parentIndex++) {\n                        parent = parentsCopy[parentIndex];\n                        parentId = parent[idField];\n                        that._markNodeAsNonRenderable(parentId);\n                        viewChildrenMap[parentId] = viewChildrenMap[parentId] || [];\n\n                        child = parentsCopy[parentIndex + 1];\n                        childId = child[idField];\n                        that._markNodeAsNonRenderable(childId);\n                        viewChildrenMap[childId] = viewChildrenMap[childId] || [];\n\n                        if (viewChildrenMap[parentId].indexOf(child) === -1) {\n                            viewChildrenMap[parentId].unshift(child);\n                        }\n                    }\n                }\n\n                return viewChildrenMap;\n            },\n\n            _clearRenderMap: function() {\n                this._skipRenderingMap = {};\n            },\n\n            _dataToRender: function(options) {\n                var that = this;\n\n                if (that._isPageable()) {\n                    return that.dataSource._pageableRootNodes(options);\n                }\n\n                return that.dataSource.rootNodes();\n            },\n\n            _markNodeAsNonRenderable: function(nodeId) {\n                this._skipRenderingMap[nodeId] = true;\n            },\n\n            _adjustRowsHeight: function(table1, table2) {\n                if (!this._hasLockedColumns) {\n                    return;\n                }\n\n                var rows = table1[0].rows;\n                var length = rows.length;\n                var idx;\n                var rows2 = table2[0].rows;\n                var containers = table1.add(table2);\n                var containersLength = containers.length;\n                var heights = [];\n\n                for (idx = 0; idx < length; idx++) {\n                    if (!rows2[idx]) {\n                        break;\n                    }\n\n                    if (rows[idx].style.height) {\n                        rows[idx].style.height = rows2[idx].style.height = \"\";\n                    }\n                }\n\n                for (idx = 0; idx < length; idx++) {\n                    if (!rows2[idx]) {\n                        break;\n                    }\n\n                    var offsetHeight1 = rows[idx].offsetHeight;\n                    var offsetHeight2 = rows2[idx].offsetHeight;\n                    var height = 0;\n\n                    if (offsetHeight1 > offsetHeight2) {\n                        height = offsetHeight1;\n                    } else if (offsetHeight1 < offsetHeight2) {\n                        height = offsetHeight2;\n                    }\n\n                    heights.push(height);\n                }\n\n                for (idx = 0; idx < containersLength; idx++) {\n                    containers[idx].style.display = \"none\";\n                }\n\n                for (idx = 0; idx < length; idx++) {\n                    if (heights[idx]) {\n                        //add one to resolve row misalignment in IE\n                        rows[idx].style.height = rows2[idx].style.height = (heights[idx] + 1) + \"px\";\n                    }\n                }\n\n                for (idx = 0; idx < containersLength; idx++) {\n                    containers[idx].style.display = \"\";\n                }\n            },\n\n            _ths: function(columns, rowSpan) {\n                var ths = [];\n                var column, title, children, cellClasses, attr, headerContent;\n                var index;\n                var leafs;\n\n                for (var i = 0, length = columns.length; i < length; i++) {\n                    column = columns[i];\n                    children = [];\n                    cellClasses = [classNames.header];\n\n                    if (column.selectable) {\n                        leafs = leafColumns(columns);\n                        index = inArray(column, leafs);\n                        attr = {\n                            scope: \"col\",\n                            role: \"columnheader\",\n                            className: cellClasses.join(\" \")\n                        };\n\n                        if (column.headerTemplate) {\n                            title = column.headerTemplate({});\n                        }\n\n                        title = column.headerTemplate ? title : kendo.template( function () { return SELECTCOLUMNHEADERTMPL; })({});\n\n\n                        if (rowSpan && !column.colSpan) {\n                            attr.rowSpan = rowSpan;\n                        }\n\n                        if (index > -1) {\n                            attr[kendo.attr(\"index\")] = index;\n                        }\n\n                        children.push(kendoHtmlElement(title));\n\n                        ths.push(kendoDomElement(\"th\", $.extend(true, {}, attr, column.headerAttributes), children));\n                        continue;\n                    }\n\n                    if (column.headerTemplate) {\n                        title = column.headerTemplate({});\n                    } else {\n                        title = column.title || column.field || \"\";\n                    }\n\n                    if (column.headerTemplate) {\n                        headerContent = kendoHtmlElement(title);\n                    } else {\n                        headerContent = kendoTextElement(title);\n                    }\n\n                    if (this.options.sortable) {\n                        children.push(kendoDomElement(\"span\", { className: classNames.headerCellInner }, [\n                            kendoDomElement(\"span\", { className: classNames.link }, [\n                                kendoDomElement(\"span\", { className: classNames.columnTitle }, [\n                                    headerContent\n                                ])\n                            ])\n                        ]));\n                    } else {\n                        children.push(headerContent);\n                    }\n\n                    attr = {\n                        \"data-field\": column.field,\n                        \"data-title\": column.title,\n                        \"style\": column.hidden === true ? { \"display\": \"none\" } : {},\n                        className: cellClasses.join(\" \"),\n                        \"role\": \"columnheader\"\n                    };\n\n                    if (!column.columns) {\n                        attr.rowSpan = rowSpan ? rowSpan : 1;\n                    }\n\n                    if (column.headerAttributes) {\n                        if (column.headerAttributes.colSpan === 1) {\n                            delete column.headerAttributes.colSpan;\n                        }\n                        if (column.headerAttributes[\"class\"]) {\n                            attr.className += \" \" + column.headerAttributes[\"class\"];\n                            delete column.headerAttributes[\"class\"];\n                        }\n                    }\n\n                    if (column[\"data-index\"] > -1) {\n                        attr[\"data-index\"] = column[\"data-index\"];\n                    }\n\n                    attr = extend(true, {}, attr, column.headerAttributes);\n\n                    ths.push(kendoDomElement(\"th\", attr, children));\n                }\n\n                return ths;\n            },\n\n            _cols: function(columns) {\n                var cols = [];\n                var width, attr;\n\n                for (var i = 0; i < columns.length; i++) {\n                    if (columns[i].hidden === true) {\n                        continue;\n                    }\n\n                    width = columns[i].width;\n                    attr = {};\n\n                    if (width && parseInt(width, 10) !== 0) {\n                        attr.style = {\n                            width: typeof width === \"string\" ? width : width + \"px\"\n                        };\n                    }\n\n                    cols.push(kendoDomElement(\"col\", attr));\n                }\n\n                return cols;\n            },\n\n            _clearColsCache: function() {\n                this._headerColsTree.render([]);\n                if (this.options.scrollable) {\n                    this._contentColsTree.render([]);\n                }\n                if (this._hasLockedColumns) {\n                    this._lockedHeaderColsTree.render([]);\n                    this._lockedContentColsTree.render([]);\n                }\n            },\n\n            _renderCols: function() {\n                var columns = nonLockedColumns(this.columns);\n                this._headerColsTree.render(this._cols(leafColumns(columns)));\n\n                if (this.options.scrollable) {\n                    this._contentColsTree.render(this._cols(leafColumns(columns)));\n                }\n\n                if (this._hasLockedColumns) {\n                    columns = lockedColumns(this.columns);\n                    this._lockedHeaderColsTree.render(this._cols(leafColumns(columns)));\n                    this._lockedContentColsTree.render(this._cols(leafColumns(columns)));\n                }\n            },\n\n            _retrieveFirstColumn: function(columns, rows) {\n                var result = $();\n\n                if (rows.length && columns[0]) {\n                    var column = columns[0];\n\n                    while (column.columns && column.columns.length) {\n                        column = column.columns[0];\n                        rows = rows.filter(\":not(:first)\");\n                    }\n\n                    result = result.add(rows);\n                }\n\n                return result;\n            },\n\n            _updateFirstColumnClass: function() {\n                var that = this;\n                var columns = that.columns || [];\n                var tr = that.thead.find(\">tr:not(:first, .k-filter-row)\");\n                var rows;\n\n                columns = nonLockedColumns(columns);\n\n                rows = that._retrieveFirstColumn(columns, tr);\n\n                if (that.lockedHeader) {\n                    tr = that.lockedHeader.find(\"thead>tr:not(.k-filter-row):not(:first)\");\n                    columns = lockedColumns(that.columns);\n\n                    rows = rows.add(that._retrieveFirstColumn(columns, tr));\n                }\n\n                rows.each(function() {\n                    var ths = $(this).find(\"th\");\n                    ths.removeClass(\"k-first\");\n                    ths.eq(0).addClass(\"k-first\");\n                });\n            },\n\n            _updateRowSpans: function(rows) {\n                for (var i = rows.length - 1; i >= 0; i--) {\n                    var included = visibleChildColumns(rows[i].cells).length > 0;\n\n                    if (included) {\n                        rows[i].rowSpan = rows.length - i;\n                    }\n                }\n            },\n\n            _setColumnDataIndexes: function(columns) {\n                for (var i = 0; i < columns.length; i++) {\n                   columns[i][\"data-index\"] = i;\n                }\n            },\n\n            _updateColumnCellIndex: function() {\n                var header;\n                var offset = 0;\n\n                if (this.lockedHeader) {\n                    header = this.lockedHeader.find(\"thead\");\n                    offset = updateCellIndex(header, lockedColumns(this.columns));\n                }\n                updateCellIndex(this.thead, nonLockedColumns(this.columns), offset);\n            },\n\n            _setParentsVisibility: function(column, visible) {\n                var columns = this.columns;\n                var idx;\n                var parents = [];\n                var parent;\n\n                var predicate = visible ?\n                    function(p) { return visibleColumns(p.columns).length && p.hidden; } :\n                    function(p) { return !visibleColumns(p.columns).length && !p.hidden; };\n\n\n                if (columnParents(column, columns, parents) && parents.length) {\n                    for (idx = parents.length - 1; idx >= 0; idx--) {\n                        parent = parents[idx];\n\n                        if (predicate(parent)) {\n                            parent.hidden = !visible;\n                        }\n                    }\n                }\n            },\n\n            _prepareColumns: function(rows, columns, parentCell, parentRow, parentColumn) {\n                var row = parentRow || rows[rows.length - 1];\n\n                var childRow = rows[row.index + 1];\n                var totalColSpan = 0;\n\n                for (var idx = 0; idx < columns.length; idx++) {\n                    var cell = $.extend({}, columns[idx], { headerAttributes: columns[idx].headerAttributes || {} } );\n                    row.cells.push(cell);\n\n                    if (columns[idx].columns && columns[idx].columns.length) {\n                        if (!childRow) {\n                            childRow = { rowSpan: 0, cells: [], index: rows.length };\n                            rows.push(childRow);\n                        }\n                        if (columns[idx].columns.length) {\n                            cell.headerAttributes.colSpan = visibleChildColumns(columns[idx].columns).length || 1;\n                            cell.headerAttributes[\"data-colspan\"] = leafColumns(columns[idx].columns).length;\n                        }\n                        this._prepareColumns(rows, columns[idx].columns, cell, childRow, columns[idx]);\n                        if (!cell.hidden) {\n                            totalColSpan += cell.headerAttributes.colSpan - 1;\n                        }\n                        row.rowSpan = rows.length - row.index;\n                    }\n                    columns[idx].rowIndex = row.index;\n                    if (parentColumn) {\n                        columns[idx].parentColumn = parentColumn;\n                    }\n                    columns[idx].cellIndex = row.cells.length - 1;\n                }\n                if (parentCell) {\n                    parentCell.headerAttributes.colSpan += totalColSpan;\n                }\n            },\n\n            _renderHeaderTree: function(tree, columns, hasMultiColumnHeaders) {\n                var idx;\n                var rows = [];\n                var rowsToRender = [];\n                var filterThs = [];\n\n                if (hasMultiColumnHeaders) {\n                    rows = [{ rowSpan: 1, cells: [], index: 0 }];\n                    this._prepareColumns(rows, columns);\n                    this._updateRowSpans(rows);\n                    for (idx = 0; idx < rows.length; idx++) {\n                        rowsToRender.push(kendoDomElement(\"tr\", { \"role\": \"row\" }, this._ths(rows[idx].cells, rows[idx].rowSpan)));\n                    }\n                } else {\n                    rowsToRender.push(kendoDomElement(\"tr\", { \"role\": \"row\" }, this._ths(columns)));\n                }\n\n                if (this._hasFilterRow()) {\n                    this._filterThs(columns, filterThs);\n                    rowsToRender.push(kendoDomElement(\"tr\", { \"class\": \"k-filter-row\" }, filterThs));\n                }\n\n                tree.render(rowsToRender);\n            },\n\n            _renderHeader: function() {\n                var columns = nonLockedColumns(this.columns);\n                var hasMultiColumnHeaders = grep(this.columns, function(item) {\n                    return item.columns !== undefined$1;\n                }).length > 0;\n                this._setColumnDataIndexes(leafColumns(this.columns));\n                this._renderHeaderTree(this._headerTree, columns, hasMultiColumnHeaders);\n\n                if (this._hasLockedColumns) {\n                    columns = lockedColumns(this.columns);\n                    this._renderHeaderTree(this._lockedHeaderTree, columns, hasMultiColumnHeaders);\n\n                    this._applyLockedContainersWidth();\n                    this._syncLockedHeaderHeight();\n                }\n                this._updateFirstColumnClass();\n            },\n\n            _filterThs: function(columns, ths) {\n                var column;\n                var attr;\n                var uidAttr = kendo.attr('uid');\n\n                for (var i = 0, length = columns.length; i < length; i++) {\n                    column = columns[i];\n\n                    if (column.columns) {\n                        this._filterThs(column.columns, ths);\n                    }\n\n                    if (column.columns && column.columns.length) {\n                        continue;\n                    }\n\n                    attr = {\n                        \"style\": column.hidden === true ? { \"display\": \"none\" } : {}\n                    };\n                    attr[uidAttr] = column.headerAttributes.id;\n                    ths.push(kendoDomElement(\"th\", attr));\n                }\n            },\n\n            _updateFilterThs: function(before, column, refColumn) {\n                var columns = leafColumns([column]);\n                var filterRowThs = $(this.lockedHeader).add(this.thead).find(\"tr.k-filter-row th\");\n                var refIndex;\n                var currIndex;\n                var uidAttr = kendo.attr('uid');\n\n                function thIndex(ths, uid) {\n                    for (var i = 0; i < ths.length; i++) {\n                        if (ths.eq(i).attr(uidAttr) === uid) {\n                            return i;\n                        }\n                    }\n                }\n\n                for (var i = columns.length - 1; i >= 0; i--) {\n                    column = columns[i];\n                    currIndex = thIndex(filterRowThs, column.headerAttributes.id);\n                    refIndex = thIndex(filterRowThs, refColumn.headerAttributes.id);\n                    filterRowThs.eq(currIndex)[before ? \"insertBefore\" : \"insertAfter\"](filterRowThs.eq(refIndex));\n                }\n            },\n\n            _applyLockedContainersWidth: function() {\n                if (!this._hasLockedColumns) {\n                    return;\n                }\n\n                var lockedWidth = columnsWidth(this.lockedHeader.find(\">table>colgroup>col\"));\n\n                var headerTable = this.thead.parent();\n                var nonLockedWidth = columnsWidth(headerTable.find(\">colgroup>col\"));\n\n                var wrapperWidth = this.wrapper[0].clientWidth;\n                var scrollbar = kendo.support.scrollbar();\n\n                if (lockedWidth >= wrapperWidth) {\n                    lockedWidth = wrapperWidth - 3 * scrollbar;\n                }\n\n                this.lockedHeader\n                    .add(this.lockedContent)\n                    .width(lockedWidth);\n\n                headerTable.add(this.table).width(nonLockedWidth);\n\n                var width = wrapperWidth - lockedWidth;\n                this.content.width(width - 1);\n                headerTable.parent().width(width - scrollbar - 2);\n            },\n\n            _trs: function(options) {\n                var that = this;\n                var model, attr, className, hasChildren, childNodes, i, length;\n                var modelId;\n                var rows = [];\n                var level = options.level;\n                var data = options.data;\n                var dataSource = this.dataSource;\n                var aggregates = dataSource.aggregates() || {};\n                var idField = dataSource._modelIdField();\n                var parentIdField = dataSource._modelParentIdField();\n                var columns = options.columns;\n                var pageable = that._isPageable();\n                var childrenMap = options.childrenMap || dataSource.childrenMap(dataSource._getData());\n\n                for (i = 0, length = data.length; i < length; i++) {\n                    className = [];\n\n                    model = data[i];\n                    modelId = model[idField];\n\n                    childNodes = pageable ? childrenMap[modelId] : (model.loaded() ? dataSource.childNodes(model) : []);\n                    hasChildren = childNodes && childNodes.length;\n\n                    attr = { \"role\": \"row\" };\n\n                    attr[kendo.attr(\"uid\")] = model.uid;\n\n                    if (hasChildren) {\n                        attr[\"aria-expanded\"] = !!model.expanded;\n                    }\n\n                    if (options.visible) {\n                        if (!pageable || (pageable && !that._skipRenderingMap[modelId])) {\n                            if (this._absoluteIndex % 2 !== 0) {\n                                className.push(classNames.alt);\n                            }\n\n                            this._absoluteIndex++;\n                        }\n                    } else {\n                        attr.style = { display: \"none\" };\n                    }\n\n                    if ($.inArray(model.uid, options.selected) >= 0) {\n                        className.push(classNames.selected);\n                    }\n\n                    if (hasChildren) {\n                        className.push(classNames.group);\n                    }\n\n                    if (model._edit) {\n                        className.push(\"k-grid-edit-row\");\n                    }\n\n                    attr.className = className.join(\" \");\n\n                    if (!that._skipRenderingMap[modelId]) {\n                        var row;\n                        var rowOptions = {\n                            model: model,\n                            attr: attr,\n                            level: pageable ? that._renderedModelLevel(model, options) : level,\n                            editedColumn: options.editedColumn,\n                            editedColumnIndex: options.editedColumnIndex,\n                            hasChildren: hasChildren,\n                            visible: options.visible,\n                            isAlt: this._absoluteIndex % 2 === 0\n                        };\n\n                        if (that.options.rowTemplate) {\n                            row = this. _trFromTemplate(rowOptions);\n                        } else {\n                            row = this._tds(rowOptions, columns, this._td.bind(this));\n                        }\n\n                        rows.push(row);\n                    }\n\n\n                    if (hasChildren && (that.options.renderAllRows || !!model.expanded)) {\n                        if (pageable) {\n                            // render the child nodes in the paged view only\n                            childNodes = (options.viewChildrenMap || {})[modelId] || [];\n                        }\n\n                        if (childNodes.length === 0) {\n                            continue;\n                        }\n\n                        rows = rows.concat(this._trs({\n                            columns: columns,\n                            editedColumn: options.editedColumn,\n                            editedColumnIndex: options.editedColumnIndex,\n                            aggregates: aggregates,\n                            selected: options.selected,\n                            visible: pageable ? options.visible : (options.visible && !!model.expanded),\n                            data: childNodes,\n                            childrenMap: options.childrenMap || childrenMap,\n                            hasFooterTemplate: options.hasFooterTemplate,\n                            viewChildrenMap: options.viewChildrenMap,\n                            level: level + 1\n                        }));\n                    }\n                }\n\n                if (options.hasFooterTemplate && model) {\n                    attr = {\n                        className: classNames.footerTemplate,\n                        \"data-parentId\": model[parentIdField]\n                    };\n\n                    if (!options.visible) {\n                        attr.style = { display: \"none\" };\n                    }\n\n                    rows.push(this._tds({\n                        model: aggregates[model[parentIdField]],\n                        attr: attr,\n                        level: level,\n                        editedColumn: options.editedColumn,\n                        editedColumnIndex: options.editedColumnIndex\n                    }, columns, this._footerId));\n                }\n\n                return rows;\n            },\n\n            _trFromTemplate: function(options) {\n                var rowTemplate = this.options.rowTemplate;\n                var altRowTemplate = this.options.altRowTemplate;\n                var row;\n                var template;\n\n                altRowTemplate = altRowTemplate ? altRowTemplate : rowTemplate;\n\n                if (!kendo.isFunction(rowTemplate)) {\n                    rowTemplate = kendo.template(rowTemplate);\n                }\n\n                if (!kendo.isFunction(altRowTemplate)) {\n                    altRowTemplate = kendo.template(altRowTemplate);\n                }\n\n                if (this._absoluteIndex % 2 !== 0) {\n                    template = rowTemplate(options);\n                } else {\n                    template = altRowTemplate(options);\n                }\n\n                if (!$(template).length) {\n                    return kendoTextElement(template);\n                }\n\n                row = this.parseRowTemplate($(template)[0], options);\n\n                return row;\n            },\n\n            parseRowTemplate: function(element, options) {\n                var nodeName = element.nodeName.toLocaleLowerCase();\n                var childNodes = element.childNodes;\n                var children = [];\n                var currElement;\n                var attributes;\n\n                attributes = this.parseAttributes(element);\n\n                for (var i = 0; i < childNodes.length; i++) {\n                    if (!/\\S/.test(childNodes[i].nodeValue)) {\n                       continue;\n                    }\n                    if (childNodes[i].nodeName.toLocaleLowerCase() === \"td\") {\n                        children.push(this._createCellElement(childNodes[i]));\n                    }\n                }\n\n                if (options && !options.visible) {\n                   attributes.style = attributes.style || {};\n                   attributes.style = $.extend(true, attributes.style, { display: \"none\" });\n                }\n\n                if (this._isTextNode(nodeName)) {\n                    currElement = kendoTextElement(element.nodeValue);\n                } else {\n                    currElement = kendoDomElement(nodeName, attributes, children);\n                }\n\n                return currElement;\n            },\n\n            _createCellElement: function(element) {\n                var attributes = this.parseAttributes(element);\n                var spaceElements = $(element).find('.' + classNames.iconHidden).remove();\n                var iconElement = $(element).find('.' + classNames.iconExpand + ',.' + classNames.iconCollapse).remove()[0];\n                var children = [];\n\n                for (var i = 0; i < spaceElements.length; i++) {\n                    children.push(kendoDomElement(\"span\", this.parseAttributes(spaceElements[i])));\n                }\n\n                if (iconElement) {\n                    children.push(kendoDomElement(\"span\", this.parseAttributes(iconElement)));\n                }\n                children.push(kendoHtmlElement($(element).html()));\n\n                return kendoDomElement(\"td\", attributes, children);\n            },\n\n            parseAttributes: function(element) {\n                if (this._isTextNode(element.nodeName)) {\n                    return null;\n                }\n\n                element = $(element)[0];\n                var attributes = element.attributes;\n                var length = attributes.length;\n                var result = {};\n\n                for (var i = 0; i < length; i++) {\n                    result[attributes[i].name] = attributes[i].value;\n                }\n\n                return result;\n            },\n\n            _isTextNode: function(nodeName) {\n                return nodeName.indexOf('text') >= 0;\n            },\n\n            _footerId: function(options) {\n                var content = [];\n                var column = options.column;\n                var template = options.column.footerTemplate || $.noop;\n                var aggregates = options.model[column.field] || {};\n                var attr = {\n                    \"role\": \"gridcell\",\n                    \"style\": column.hidden === true ? { \"display\": \"none\" } : {}\n                };\n\n                if (column.expandable) {\n                    content = content.concat(createPlaceholders({\n\n                        level: options.level + 1,\n                        className: classNames.iconPlaceHolder\n                    }));\n                }\n\n                if (column.attributes) {\n                    extend(true, attr, column.attributes, {\n                        \"style\": column.hidden === true ? { \"display\": \"none\" } : {}\n                    });\n                }\n\n                content.push(kendoHtmlElement(template(aggregates) || \"\"));\n\n                return kendoDomElement(\"td\", attr, content);\n            },\n\n            _hasFooterTemplate: function() {\n                return !!grep(leafColumns(this.columns), function(c) {\n                    return c.footerTemplate;\n                }).length;\n            },\n\n            _tds: function(options, columns, renderer) {\n                var children = [];\n                var column;\n                var editedColumnField = (options.editedColumn || {}).field;\n                var incellEditing = this._isIncellEditable();\n                var length = columns.length;\n\n                for (var i = 0; i < length; i++) {\n                    column = columns[i];\n\n                    var col = renderer({\n                        model: options.model,\n                        column: column,\n                        editColumn: !incellEditing || (incellEditing && column.field === editedColumnField && options.editedColumnIndex === i),\n                        level: options.level\n                    });\n\n                    children.push(col);\n                }\n\n                return kendoDomElement(\"tr\", options.attr, children);\n            },\n\n            _td: function(options) {\n                var children = [];\n                var model = options.model;\n                var column = options.column;\n                var iconClass;\n                var attr = {\n                    \"role\": \"gridcell\",\n                    \"style\": column.hidden === true ? { \"display\": \"none\" } : {}\n                };\n                var incellEditing = this._isIncellEditable();\n                var columnHasEditCommand = false;\n\n                if (column.attributes) {\n                    extend(true, attr, column.attributes);\n                }\n\n                if (!!column.headerAttributes && !!column.headerAttributes.id) {\n                    attr[\"aria-describedby\"] = column.headerAttributes.id;\n                }\n\n                if (model._edit && column.field && options.editColumn && (incellEditing || (!incellEditing && isColumnEditable(column, model)))) {\n                    attr[kendo.attr(\"container-for\")] = column.field;\n\n                    if (incellEditing) {\n                        if (attr.className && attr.className.indexOf(classNames.editCell) !== -1) {\n                            attr.className += \" \" + classNames.editCell;\n                        } else if (!attr.className) {\n                            attr.className = classNames.editCell;\n                        }\n                    }\n                } else {\n                    if (column.expandable) {\n                        children = createPlaceholders({ level: options.level, className: classNames.iconPlaceHolder });\n                        iconClass = [classNames.icon];\n\n                        if (model.hasChildren) {\n                            iconClass.push(model.expanded ? classNames.iconCollapse : classNames.iconExpand);\n                        } else {\n                            iconClass.push(classNames.iconHidden);\n                        }\n\n                        if (model._error) {\n                            iconClass.push(classNames.refresh);\n                        } else if (!model.loaded() && model.expanded) {\n                            iconClass.push(classNames.loading);\n                            attr[\"aria-busy\"] = true;\n                        }\n\n                        children.push(kendoDomElement(\"span\", { className: iconClass.join(\" \") }));\n\n                        attr.style[\"white-space\"] = \"nowrap\";\n                    }\n\n                    if (isDirtyColumn(column, model)) {\n                        if (attr.className) {\n                            attr.className += classNames.dirtyCell;\n                        } else if (!attr.className) {\n                            attr.className = classNames.dirtyCell;\n                        }\n                    }\n\n                    if (column.command) {\n                        if (attr.className && attr.className.indexOf(\"k-command-cell\") !== -1 ) {\n                            attr.className += \" k-command-cell\";\n                        } else if (!attr.className) {\n                            attr.className = \"k-command-cell\";\n                        }\n\n                        columnHasEditCommand = grep(column.command, function(command) {\n                            return command === EDIT || command.name === EDIT;\n                        }).length > 0;\n\n                        if (model._edit && !this._isIncellEditable() && columnHasEditCommand) {\n                            children = this._buildCommands([\"update\", \"canceledit\"]);\n                        } else {\n                            children = this._buildCommands(column.command);\n                        }\n                    } else {\n                        children.push(this._cellContent(column, model));\n                    }\n\n                    attr.className = [attr[\"class\"], attr.className].join(\" \").trim();\n                }\n\n                return kendoDomElement(\"td\", attr, children);\n            },\n\n            _cellContent: function(column, model) {\n                var that = this;\n                var value;\n                var incellEditing = that._isIncellEditable();\n                var dirtyIndicator;\n\n                if (column.selectable) {\n                    return kendoHtmlElement(SELECTCOLUMNTMPL);\n                }\n\n                if (column.template) {\n                    value = that._evalColumnTemplate(column, model);\n                } else if (column.field) {\n                    value = model.get(column.field);\n                    dirtyIndicator = incellEditing ? column.dirtyIndicatorTemplate(model) : \"\";\n                    if (value !== null && !isUndefined(value)) {\n                        if (column.format) {\n                            value = kendo.format(column.format, value);\n                        }\n\n                        value = dirtyIndicator + value;\n                    } else {\n                        value = dirtyIndicator;\n                    }\n                } else if (value === null || isUndefined(value)) {\n                    value = \"\";\n                }\n\n                if (column.template || !column.encoded) {\n                    return kendoHtmlElement(value);\n                } else {\n                    if (incellEditing) {\n                        return kendoHtmlElement(value);\n                    } else {\n                        return kendoTextElement(value);\n                    }\n                }\n            },\n\n            _evalColumnTemplate: function(column, model) {\n                if (this._isIncellEditable()) {\n                    return column.dirtyCellTemplate(model);\n                } else {\n                    return column.template(model);\n                }\n            },\n\n            _createDirtyColumnTemplate: function(column) {\n                var that = this;\n                var templateSettings = that._customTemplateSettings();\n                var templateFunction = function(data) {\n                    return (that._dirtyIndicatorTemplate(column.field)(data) + this.columnTemplate(data));\n                };\n\n                return kendoTemplate(templateFunction, templateSettings).bind({ columnTemplate: column.template });\n            },\n\n            _createIndicatorTemplate: function(column) {\n                var dirtyIndicatorTemplate = this._dirtyIndicatorTemplate(column.field);\n\n                return kendoTemplate(dirtyIndicatorTemplate);\n            },\n\n            _dirtyIndicatorTemplate: function(field) {\n                var that = this;\n                var dirtyField;\n                var templateSettings = that._customTemplateSettings();\n                var paramName = templateSettings.paramName;\n\n                if (field && paramName) {\n                    dirtyField = field.charAt(0) === \"[\" ? kendo.expr(field, paramName + \".dirtyFields\") : paramName + \".dirtyFields['\" + field + \"']\";\n                    return function (ref) {\n                        var dirty = ref.dirty;\n                        var dirtyFields = ref.dirtyFields;\n\n                        return (dirty && dirtyFields && dirtyField ? '<span class=\"k-dirty\"></span>' : '');\n                    };\n                }\n\n                return function () { return \"\"; };\n            },\n\n            _customTemplateSettings: function() {\n                return extend({}, kendo.Template, this.options.templateSettings);\n            },\n\n            _buildCommands: function(commands) {\n                var i, result = [];\n\n                for (i = 0; i < commands.length; i++) {\n                    result.push(this._handleCommand(commands[i]));\n                }\n\n                return result;\n            },\n\n            _handleCommand: function(command) {\n                var name = (command.name || command).toLowerCase();\n                var text = this.options.messages.commands[name];\n                var icon = [];\n\n                command = extend({}, defaultCommands[name], { text: text }, command);\n\n                if (command.imageClass) {\n                    icon.push(kendoDomElement(\"span\", {\n                        className: [ \"k-icon\", \"k-button-icon\", command.imageClass ].join(\" \")\n                    }));\n                }\n\n                if (command.template) {\n                    return kendoHtmlElement(kendo.template(command.template)({ message: command.text || this.options.messages.commands.search }));\n                } else {\n                    return this._button(command, name, icon);\n                }\n            },\n\n            _button: function(command, name, icon) {\n                if (command.className && command.className.indexOf(\"k-primary\") > -1) {\n                    command.className = command.className.replace(\"k-primary\", \"k-button-solid-primary\");\n                }\n\n                if (!command.className || command.className.indexOf(\"k-button-solid-primary\") === -1) {\n                    command.className += \" k-button-solid-base\";\n                }\n\n                var button = kendoDomElement(\n                    \"button\", {\n                        \"type\": \"button\",\n                        \"data-command\": name,\n                        className: [ \"k-button k-button-md k-rounded-md k-button-solid\", command.className ].join(\" \")\n                    }, icon.concat([ kendoDomElement(\"span\", {\n                        type: \"span\",\n                        className: \"k-button-text\"\n                    }, [ kendoTextElement(command.text || command.name) ]) ])\n                );\n\n                return button;\n            },\n\n            _positionResizeHandle: function(e) {\n                var th = $(e.currentTarget);\n                var resizeHandle = this.resizeHandle;\n                var position = th.position();\n                var left;\n                var rtlCorrection = 0;\n                var headerWrap;\n                var ieCorrection;\n                var webkitCorrection;\n                var firefoxCorrection;\n                var leftMargin;\n                var invisibleSpace;\n                var leftBorderWidth;\n                var scrollLeft;\n                var cellWidth = outerWidth(th);\n                var container = th.closest(\"div\");\n                var button = typeof e.buttons !== \"undefined\" ? e.buttons : (e.which || e.button);\n                var indicatorWidth = this.options.columnResizeHandleWidth || 3;\n                var halfResizeHandle = (indicatorWidth * 3) / 2;\n\n                left = cellWidth;\n\n                if (typeof button !== \"undefined\" && button !== 0) {\n                    //do not create a new resize handle if a mouse button is still pressed\n                    //this happens during resizing or before UserEvents trigger \"start\"\n                    return;\n                }\n\n                if (!resizeHandle) {\n                    resizeHandle = this.resizeHandle = $(\n                        '<div class=\"k-resize-handle\"><div class=\"k-resize-handle-inner\"></div></div>'\n                    );\n                }\n\n                var cells = leafDataCells(th.closest(\"thead\")).filter(\":visible\");\n                if (isRtl) {\n                    scrollLeft = kendo.scrollLeft(container);\n\n                    if (browser.mozilla || (browser.webkit && browser.version >= 85)) {\n                        scrollLeft = scrollLeft * -1;\n                    }\n                    leftBorderWidth = parseFloat(container.css(\"borderLeftWidth\"));\n                    left = th.offset().left + scrollLeft - parseFloat(th.css(\"marginLeft\")) - (container.offset().left + leftBorderWidth);\n                    rtlCorrection = (left <= scrollLeft ? halfResizeHandle : 0);// when shown on first column headers are misaligned due to the width of the resize handler\n                    headerWrap = th.closest(\".k-grid-header-wrap, .k-grid-header-locked\");\n                    invisibleSpace = headerWrap[0].scrollWidth - headerWrap[0].offsetWidth; // the difference between the entire width and the visible area\n                    leftMargin = parseFloat(headerWrap.css(\"marginLeft\"));\n                    ieCorrection = browser.msie ? 2 * kendo.scrollLeft(headerWrap) + leftBorderWidth - leftMargin - rtlCorrection : 0;\n                    webkitCorrection = browser.webkit && (browser.version < 85) ? (invisibleSpace - rtlCorrection - leftMargin + leftBorderWidth) : -rtlCorrection; //margin left is added due to a margin that avoids double borders\n                    firefoxCorrection = browser.mozilla ? leftBorderWidth - leftMargin - rtlCorrection : 0;\n                    left -= webkitCorrection + firefoxCorrection + ieCorrection;\n                } else {\n                    for (var idx = 0; idx < cells.length; idx++) {\n                        if (cells[idx] == th[0]) {\n                            break;\n                        }\n                        left += cells[idx].offsetWidth;\n                    }\n                }\n\n                container.append(resizeHandle);\n\n                resizeHandle\n                    .show()\n                    .css({\n                        top: position.top,\n                        left: left - halfResizeHandle,\n                        height: outerHeight(th),\n                        width: indicatorWidth * 3\n                    })\n                    .data(\"th\", th);\n\n                var that = this;\n                resizeHandle.off(\"dblclick\" + NS).on(\"dblclick\" + NS, function() {\n                    //TODO handle frozen columns index\n                    var index = th.index();\n                    if ($.contains(that.thead[0], th[0])) {\n                        index += grep(that.columns, function(val) { return val.locked && !val.hidden; }).length;\n                    }\n                    that.autoFitColumn(index);\n                });\n            },\n\n            autoFitColumn: function(column) {\n                var that = this,\n                    options = that.options,\n                    columns = that.columns,\n                    index,\n                    th,\n                    headerTable,\n                    isLocked,\n                    visibleLocked = that.lockedHeader ? leafDataCells(that.lockedHeader.find(\">table>thead\")).filter(isCellVisible).length : 0,\n                    col;\n\n                //  retrieve the column object, depending on the method argument\n                if (typeof column == \"number\") {\n                    column = columns[column];\n                } else if (isPlainObject(column)) {\n                    column = grep(columns, function(item) {\n                        return item === column;\n                    })[0];\n                } else {\n                    column = grep(columns, function(item) {\n                        return item.field === column;\n                    })[0];\n                }\n\n                if (!column || column.hidden) {\n                    return;\n                }\n\n                index = inArray(column, columns);\n                isLocked = column.locked;\n\n                if (isLocked) {\n                    headerTable = that.lockedHeader.children(\"table\");\n                } else {\n                    headerTable = that.thead.parent();\n                }\n\n                th = headerTable.find(\"[data-index='\" + index + \"']\");\n\n                var contentTable = isLocked ? that.lockedTable : that.table,\n                    footer = that.footer || $();\n\n                if (that.footer && that.lockedContent) {\n                    footer = isLocked ? that.footer.children(\".k-grid-footer-locked\") : that.footer.children(\".k-grid-footer-wrap\");\n                }\n\n                var footerTable = footer.find(\"table\").first();\n\n                if (that.lockedHeader && visibleLocked >= index && !isLocked) {\n                    index -= visibleLocked;\n                }\n\n                // adjust column index, depending on previous hidden columns\n                for (var j = 0; j < columns.length; j++) {\n                    if (columns[j] === column) {\n                        break;\n                    } else {\n                        if (columns[j].hidden) {\n                            index--;\n                        }\n                    }\n                }\n\n                // get col elements\n                if (options.scrollable) {\n                    col = headerTable.find(\"col:not(.k-group-col):not(.k-hierarchy-col)\").eq(index)\n                        .add(contentTable.children(\"colgroup\").find(\"col:not(.k-group-col):not(.k-hierarchy-col)\").eq(index))\n                        .add(footerTable.find(\"colgroup\").find(\"col:not(.k-group-col):not(.k-hierarchy-col)\").eq(index));\n                } else {\n                    col = contentTable.children(\"colgroup\").find(\"col:not(.k-group-col):not(.k-hierarchy-col)\").eq(index);\n                }\n\n                var tables = headerTable.add(contentTable).add(footerTable);\n\n                var oldColumnWidth = outerWidth(th);\n\n                // reset the table and autofitted column widths\n                // if scrolling is disabled, we need some additional repainting of the table\n                col.width(\"\");\n                tables.css(\"table-layout\", \"fixed\");\n                col.width(\"auto\");\n                tables.addClass(\"k-autofitting\");\n                tables.css(\"table-layout\", \"\");\n\n                var newColumnWidth = Math.ceil(\n                        Math.max(\n                            outerWidth(th),\n                            outerWidth(contentTable.find(\"tr\").eq(0).children(\"td:visible\").eq(index)),\n                            outerWidth(footerTable.find(\"tr\").eq(0).children(\"td:visible\").eq(index))\n                ));\n\n                col.width(newColumnWidth);\n                column.width = newColumnWidth;\n\n                // if all visible columns have widths, the table needs a pixel width as well\n                if (options.scrollable) {\n                    var cols = headerTable.find(\"col\"),\n                        colWidth,\n                        totalWidth = 0;\n                    for (var idx = 0, length = cols.length; idx < length; idx += 1) {\n                        colWidth = cols[idx].style.width;\n                        if (colWidth && colWidth.indexOf(\"%\") == -1) {\n                            totalWidth += parseInt(colWidth, 10);\n                        } else {\n                            totalWidth = 0;\n                            break;\n                        }\n                    }\n\n                    if (totalWidth) {\n                        tables.each(function() {\n                            this.style.width = totalWidth + \"px\";\n                        });\n                    }\n                }\n\n                tables.removeClass(\"k-autofitting\");\n\n                that.trigger(COLUMNRESIZE, {\n                    column: column,\n                    oldWidth: oldColumnWidth,\n                    newWidth: newColumnWidth\n                });\n\n                that._applyLockedContainersWidth();\n                that._syncLockedContentHeight();\n                that._syncLockedHeaderHeight();\n            },\n\n            _adjustLockedHorizontalScrollBar: function() {\n                var table = this.table,\n                    content = table.parent();\n\n                var scrollbar = table[0].offsetWidth > content[0].clientWidth ? kendo.support.scrollbar() : 0;\n                this.lockedContent.height(outerHeight(content) - scrollbar);\n            },\n\n            _syncLockedContentHeight: function() {\n                if (this.lockedTable) {\n                    if (!this._touchScroller) {\n                        this._adjustLockedHorizontalScrollBar();\n                    }\n                    this._adjustRowsHeight(this.table, this.lockedTable);\n                    this._syncLockedScroll();\n                }\n            },\n\n            _syncLockedHeaderHeight: function() {\n                if (this.lockedHeader) {\n                    var lockedTable = this.lockedHeader.children(\"table\");\n                    var table = this.thead.parent();\n\n                    this._adjustRowsHeight(lockedTable, table);\n\n                    syncTableHeight(lockedTable, table);\n                }\n            },\n\n            _syncLockedScroll: function() {\n                if (!this.options.scrollable) {\n                    return;\n                }\n                this.lockedContent[0].scrollTop = this.content[0].scrollTop;\n            },\n\n            _resizable: function() {\n                if (!this.options.resizable) {\n                    return;\n                }\n\n                if (this.resizable) {\n                    this.resizable.destroy();\n                }\n\n                var treelist = this;\n\n                $(this.lockedHeader).find(\"thead\").add(this.thead)\n                    .on(\"mousemove\" + NS, \"tr:not(.k-filter-row) > th\", this._positionResizeHandle.bind(this));\n\n                this.resizable = new kendo.ui.Resizable(this.wrapper, {\n                    handle: \".k-resize-handle\",\n                    start: function(e) {\n                        var th = $(e.currentTarget).data(\"th\");\n                        var index = $.inArray(th[0], leafDataCells(th.closest(\"thead\")).filter(\":visible\"));\n                        var header, contentTable;\n\n                        treelist.wrapper.addClass(\"k-grid-column-resizing\");\n\n                        if (treelist.lockedHeader && $.contains(treelist.lockedHeader[0], th[0])) {\n                            header = treelist.lockedHeader;\n                            contentTable = treelist.lockedTable;\n                        } else {\n                            header = treelist.thead.parent();\n                            contentTable = treelist.table;\n                        }\n\n                        this.col = contentTable.children(\"colgroup\").find(\"col\").eq(index)\n                              .add(header.find(\"col\").eq(index));\n                        this.th = th;\n                        this.startLocation = e.x.location;\n                        this.columnWidth = outerWidth(th);\n                        this.table = this.col.closest(\"table\");\n                        this.totalWidth = this.table.width();\n                    },\n                    resize: function(e) {\n                        var rtlModifier = isRtl ? -1 : 1;\n                        var minColumnWidth = 11;\n                        var delta = (e.x.location * rtlModifier) - (this.startLocation * rtlModifier);\n\n                        if (this.columnWidth + delta < minColumnWidth) {\n                            delta = minColumnWidth - this.columnWidth;\n                        }\n\n                        this.table.width(this.totalWidth + delta);\n                        this.col.width(this.columnWidth + delta);\n                    },\n                    resizeend: function() {\n                        treelist.wrapper.removeClass(\"k-grid-column-resizing\");\n\n                        var field = this.th.attr(\"data-field\");\n                        var column = grep(leafColumns(treelist.columns), function(c) {\n                            return c.field == field;\n                        });\n                        var newWidth = Math.floor(outerWidth(this.th));\n\n                        column[0].width = newWidth;\n                        treelist._resize();\n                        treelist._syncLockedContentHeight();\n                        treelist._syncLockedHeaderHeight();\n                        treelist.trigger(COLUMNRESIZE, {\n                            column: column,\n                            oldWidth: this.columnWidth,\n                            newWidth: newWidth\n                        });\n\n                        this.table = this.col = this.th = null;\n                    }\n                });\n            },\n\n            _sortable: function() {\n                var columns;\n                var column;\n                var sortableInstance;\n                var cells;\n                var cell, idx, length;\n                var sortable = this.options.sortable;\n                var hasMultiColumnHeaders = grep(this.columns, function(item) {\n                    return item.columns !== undefined$1;\n                }).length > 0;\n                var sortHandler = this._sort.bind(this);\n\n                if (!sortable) {\n                    return;\n                }\n\n                if (hasMultiColumnHeaders) {\n                    if (this.lockedHeader) {\n                        cells = sortCells(leafDataCells(this.lockedHeader.find(\">table>thead\")).add(leafDataCells(this.thead)));\n                    } else {\n                        cells = leafDataCells(this.thead);\n                    }\n                } else {\n                    cells = $(this.lockedHeader).add(this.thead).find(\"tr:not(.k-filter-row) th\");\n                }\n                columns = leafColumns(this.columns);\n\n                for (idx = 0, length = cells.length; idx < length; idx++) {\n                    column = columns[idx];\n\n                    if (column.sortable !== false && !column.command && column.field && !column.selectable) {\n                        cell = cells.eq(idx);\n\n                        sortableInstance = cell.data(\"kendoColumnSorter\");\n                        if (sortableInstance) {\n                            sortableInstance.destroy();\n                        }\n\n                        cell.kendoColumnSorter(\n                                extend({}, sortable, column.sortable, {\n                                    dataSource: this.dataSource,\n                                    change: sortHandler\n                                })\n                            );\n                    }\n                }\n            },\n\n            _filterable: function() {\n                var cells;\n                var filterable = this.options.filterable;\n                var idx;\n                var length;\n                var columns;\n                var column;\n                var cell;\n                var filterMenuInstance;\n                var hasMultiColumnHeaders = grep(this.columns, function(item) {\n                    return item.columns !== undefined$1;\n                }).length > 0;\n\n                if (!filterable || this.options.columnMenu) {\n                    return;\n                }\n\n                var filterInit = (function(e) {\n                    this.trigger(FILTERMENUINIT, { field: e.field, container: e.container });\n                }).bind(this);\n\n                var filterOpen = (function(e) {\n                    this.trigger(FILTERMENUOPEN, { field: e.field, container: e.container });\n                }).bind(this);\n\n                var filterHandler = this._filter.bind(this);\n\n                if (hasMultiColumnHeaders) {\n                    if (this.lockedHeader) {\n                        cells = leafDataCells(this.lockedHeader.find(\">table>thead\").add(this.thead));\n                    } else {\n                        cells = leafDataCells(this.thead);\n                    }\n                } else {\n                    cells = $(this.lockedHeader).add(this.thead).find(\"tr:not(.k-filter-row) th\");\n                }\n                columns = leafColumns(this.columns);\n\n                if (filterable && typeof filterable.mode == STRING && filterable.mode.indexOf(\"menu\") == -1) {\n                    filterable = false;\n                }\n\n                if (!filterable) {\n                    return;\n                }\n\n                for (idx = 0, length = cells.length; idx < length; idx++) {\n                    column = columns[idx];\n                    cell = cells.eq(idx);\n\n                    filterMenuInstance = cell.data(\"kendoFilterMenu\");\n                    if (filterMenuInstance) {\n                        filterMenuInstance.destroy();\n                    }\n\n                    if (column.command || column.filterable === false || column.selectable) {\n                        continue;\n                    }\n\n                    cell.kendoFilterMenu(extend(true, {}, filterable, column.filterable, {\n                        dataSource: this.dataSource,\n                        init: filterInit,\n                        open: filterOpen,\n                        change: filterHandler,\n                        appendTo: DOT + classNames.headerCellInner\n                    }));\n                }\n            },\n\n            _filterRow: function() {\n                var that = this;\n                if (!that._hasFilterRow()) {\n                   return;\n                }\n\n                var settings;\n                var $angular = that.options.$angular;\n                var uidAttr = kendo.attr('uid');\n                var columns = leafColumns(that.columns),\n                    filterable = that.options.filterable,\n                    filterHandler = this._filter.bind(this),\n                    existingInstance;\n\n                for (var i = 0; i < columns.length; i++) {\n                    var suggestDataSource,\n                        col = columns[i],\n                        operators = that.options.filterable.operators,\n                        customDataSource = false,\n                        th = this.wrapper.find('.k-grid-header .k-filter-row th[' + uidAttr + '=\"' + col.headerAttributes.id + '\"]'),\n                        field = col.field,\n                        parentColumn = col.parentColumn;\n\n                    delete col.parentColumn;\n\n                    if (field && col.filterable !== false) {\n                        var cellOptions = col.filterable && col.filterable.cell || {};\n                        existingInstance = th.find('.k-filtercell').data('kendoFilterCell');\n\n                        if (existingInstance) {\n                            existingInstance.destroy();\n                            th.empty();\n                        }\n\n                        suggestDataSource = that.options.dataSource;\n                        if (suggestDataSource instanceof DataSource) {\n                            suggestDataSource = that.options.dataSource.options;\n                        }\n\n                        var messages = extend(true, {}, filterable.messages);\n                        if (col.filterable) {\n                            extend(true, messages, col.filterable.messages);\n                        }\n\n                        if (cellOptions.enabled === false) {\n                            th.html(\"&nbsp;\");\n                            continue;\n                        }\n                        if (cellOptions.dataSource) {\n                            suggestDataSource = cellOptions.dataSource;\n                            customDataSource = true;\n                        }\n                        if (col.filterable && col.filterable.operators) {\n                            operators = col.filterable.operators;\n                        }\n\n                        settings = {\n                            column: col,\n                            dataSource: that.dataSource,\n                            suggestDataSource: suggestDataSource,\n                            customDataSource: customDataSource,\n                            field: field,\n                            messages: messages,\n                            values: col.values,\n                            template: cellOptions.template,\n                            delay: cellOptions.delay,\n                            inputWidth: cellOptions.inputWidth,\n                            suggestionOperator: cellOptions.suggestionOperator,\n                            minLength: cellOptions.minLength,\n                            dataTextField: cellOptions.dataTextField,\n                            operator: cellOptions.operator,\n                            operators: operators,\n                            showOperators: cellOptions.showOperators,\n                            change: filterHandler\n                        };\n\n                        if ($angular) {\n                            settings.$angular = $angular;\n                        }\n\n                        $(\"<span/>\").attr(kendo.attr(\"field\"), field)\n                            .appendTo(th)\n                            .kendoFilterCell(settings);\n                        col.parentColumn = parentColumn;\n                    } else {\n                        th.html(\"&nbsp;\");\n                    }\n                }\n            },\n\n            _hasFilterRow: function() {\n                var filterable = this.options.filterable;\n                var hasFiltering = filterable &&\n                        typeof filterable.mode == STRING &&\n                        filterable.mode.indexOf(\"row\") != -1;\n                var columns = this.columns;\n                var columnsWithoutFiltering = $.grep(columns, function(col) {\n                    return col.filterable === false;\n                });\n\n                if (columns.length && columnsWithoutFiltering.length == columns.length) {\n                    hasFiltering = false;\n                }\n\n                return hasFiltering;\n            },\n\n            _change: function() {\n                var that = this;\n                var selectedValues;\n\n                if (that._checkBoxSelection) {\n                    selectedValues = that.selectable.value();\n                    that._uncheckCheckBoxes();\n                    that._checkRows(selectedValues);\n                    if (selectedValues.length && selectedValues.length === that.items().length) {\n                        that._toggleHeaderCheckState(true);\n                    } else {\n                        that._toggleHeaderCheckState(false);\n                    }\n                }\n                this.trigger(CHANGE);\n            },\n\n            _isLocked: function() {\n                return this.lockedHeader !== null;\n            },\n\n            _selectable: function() {\n                var that = this;\n                var selectable = this.options.selectable;\n                var filter;\n                var element = this.table;\n                var useAllItems;\n                var isLocked = that._isLocked();\n                var multi;\n                var cell;\n\n                if (selectable) {\n                    selectable = kendo.ui.Selectable.parseOptions(selectable);\n\n                    if (this._hasLockedColumns) {\n                        element = element.add(this.lockedTable);\n                        useAllItems = selectable.multiple && selectable.cell;\n                    }\n\n                    filter = \">tbody>tr:not(.k-footer-template)\";\n\n                    if (selectable.cell) {\n                        filter = filter + \">td\";\n                    }\n\n                    this.selectable = new kendo.ui.Selectable(element, {\n                        filter: filter,\n                        aria: true,\n                        multiple: selectable.multiple,\n                        change: this._change.bind(this),\n                        useAllItems: useAllItems,\n                        continuousItems: this._continuousItems.bind(this, filter, selectable.cell),\n                        relatedTarget: !selectable.cell && this._hasLockedColumns ? this._selectableTarget.bind(this) : undefined$1\n                    });\n\n                    if (that.options.navigatable) {\n                        multi = selectable.multiple;\n                        cell = selectable.cell;\n\n                        element.on(\"keydown\" + NS, function(e) {\n                            var current = that.current();\n                            var target = e.target;\n                            if (e.keyCode === keys.SPACEBAR && !e.shiftKey && $.inArray(target, element) > -1 &&\n                                !current.is(\".k-header\")) {\n\n                                    e.preventDefault();\n                                    e.stopPropagation();\n                                    current = cell ? current : current.parent();\n\n                                    if (isLocked && !cell) {\n                                        current = current.add(that._relatedRow(current));\n                                    }\n\n                                    if (multi) {\n                                        if (!e.ctrlKey) {\n                                            that.selectable.clear();\n                                        } else {\n                                            if (current.hasClass(classNames.selected)) {\n                                                current.removeClass(classNames.selected);\n                                                that.trigger(CHANGE);\n                                                return;\n                                            }\n                                        }\n                                    } else {\n                                        that.selectable.clear();\n                                    }\n                                    if (!cell) {\n                                        that.selectable._lastActive = current;\n                                    }\n\n                                    that.selectable.value(current);\n                                    that.trigger(CHANGE);\n                            } else if (!cell && ((e.shiftKey && e.keyCode == keys.LEFT) ||\n                                        (e.shiftKey && e.keyCode == keys.RIGHT) ||\n                                        (e.shiftKey && e.keyCode == keys.UP) ||\n                                        (e.shiftKey && e.keyCode == keys.DOWN) ||\n                                        (e.keyCode === keys.SPACEBAR && e.shiftKey))) {\n\n                                e.preventDefault();\n                                e.stopPropagation();\n                                current = current.parent();\n\n                                if (isLocked) {\n                                    current = current.add(that._relatedRow(current));\n                                }\n\n                                if (multi) {\n                                    if (!that.selectable._lastActive) {\n                                        that.selectable._lastActive = current;\n                                    }\n                                    that.selectable.selectRange(that.selectable._firstSelectee(), current);\n                                } else {\n                                    that.selectable.clear();\n                                    that.selectable.value(current);\n                                }\n                                that.trigger(CHANGE);\n                            }\n                        });\n                    }\n                }\n            },\n\n            _continuousItems: function(filter, cell) {\n                if (!this.lockedContent) {\n                    return;\n                }\n\n                var lockedItems = $(filter, this.lockedTable);\n                var nonLockedItems = $(filter, this.table);\n                var columns = cell ? lockedColumns(this.columns).length : 1;\n                var nonLockedColumns = cell ? this.columns.length - columns : 1;\n                var result = [];\n\n                for (var idx = 0; idx < lockedItems.length; idx += columns) {\n                    push.apply(result, lockedItems.slice(idx, idx + columns));\n                    push.apply(result, nonLockedItems.splice(0, nonLockedColumns));\n                }\n\n                return result;\n            },\n\n            _selectableTarget: function(items) {\n                var related;\n                var result = $();\n                for (var idx = 0, length = items.length; idx < length; idx ++) {\n                    related = this._relatedRow(items[idx]);\n\n                    if (inArray(related[0], items) < 0) {\n                        result = result.add(related);\n                    }\n                }\n\n                return result;\n            },\n\n            _relatedRow: function(row) {\n                var lockedTable = this.lockedTable;\n                row = $(row);\n\n                if (!lockedTable) {\n                    return row;\n                }\n\n                var table = row.closest(this.table.add(this.lockedTable));\n                var index = table.find(\">tbody>tr\").index(row);\n\n                table = table[0] === this.table[0] ? lockedTable : this.table;\n\n                return table.find(\">tbody>tr\").eq(index);\n            },\n\n            select: function(value) {\n                var that = this;\n                var selectable = this.selectable;\n\n                if (that._checkBoxSelection) {\n                    if (value) {\n                        that._checkRows(value);\n                        if (that.select().length === that.items().length) {\n                            that._toggleHeaderCheckState(true);\n                        }\n                    }\n\n                    return that.items().filter(\".\" + SELECTED);\n                }\n\n                if (!selectable) {\n                    return $();\n                }\n\n                if (typeof value !== \"undefined\") {\n                    if (!selectable.options.multiple) {\n                        selectable.clear();\n\n                        value = value.first();\n                    }\n\n                    if (this._hasLockedColumns) {\n                        value = value.add($.map(value, this._relatedRow.bind(this)));\n                    }\n                }\n\n                return selectable.value(value);\n            },\n\n            clearSelection: function() {\n                var that = this;\n\n                if (that.selectable && !that._checkBoxSelection) {\n                    that.selectable.clear();\n                }\n\n                if (that._checkBoxSelection) {\n                    that._deselectCheckRows(that.select(), true);\n                    return;\n                }\n            },\n\n            _uncheckCheckBoxes: function() {\n                var that = this;\n                var tables = that.table.add(that.lockedTable);\n\n                tables.find(\"tbody \" + CHECKBOXINPUT).attr(\"aria-checked\", false)\n                    .prop(\"checked\", false).attr(\"aria-label\", \"Select row\");\n\n            },\n\n            _deselectCheckRows: function(items, preventChange) {\n                var that = this;\n                items = that.table.add(that.lockedTable).find(items);\n\n                if (that._isLocked()) {\n                    items = items.add(items.map(function() {\n                        return that._relatedRow(this);\n                    }));\n                }\n\n                items.each(function() {\n                    $(this).removeClass(SELECTED).find(CHECKBOXINPUT).attr(\"aria-checked\", false)\n                        .prop(\"checked\", false).attr(\"aria-label\", \"Select row\");\n                });\n                that._toggleHeaderCheckState(false);\n\n                if (!preventChange) {\n                    that.trigger(CHANGE);\n                }\n            },\n\n            _headerCheckboxClick: function(e) {\n                var that = this,\n                    checkBox = $(e.target),\n                    checked = checkBox.prop(\"checked\"),\n                    parentGrid = checkBox.closest(\".k-grid.k-widget\").getKendoTreeList();\n\n                if (that !== parentGrid) {\n                    return;\n                }\n\n                if (checked) {\n                    that.select(parentGrid.items());\n                } else {\n                    that.clearSelection();\n                }\n                that.trigger(CHANGE);\n            },\n\n            _checkboxClick: function(e) {\n                var that = this,\n                    row = $(e.target).closest(\"tr\"),\n                    isSelecting = !row.hasClass(SELECTED),\n                    dataItem = that.dataItem(row),\n                    children = [],\n                    selector = \"\";\n\n                if (that !== row.closest(\".k-grid.k-widget\").getKendoTreeList()) {\n                    return;\n                }\n\n                if (that._includeChildren) {\n                    that.dataSource.allChildNodes(dataItem, children);\n\n                    for (var i = 0; i < children.length; i++) {\n                        selector += \"tr[data-uid='\" +\tchildren[i].uid + \"'],\";\n                    }\n                }\n\n                selector += \"tr[data-uid='\" +\tdataItem.uid + \"']\";\n                row = $(selector);\n\n                if (isSelecting) {\n                    that.select(row);\n                    that.trigger(CHANGE);\n                } else {\n                    that._deselectCheckRows(row);\n                }\n            },\n\n            _checkRows: function(items) {\n                items.each(function() {\n                    $(this).addClass(SELECTED).find(CHECKBOXINPUT).prop(\"checked\", true)\n                        .attr(\"aria-label\", \"Deselect row\").attr(\"aria-checked\", true);\n                });\n            },\n\n            _toggleHeaderCheckState: function(checked) {\n                var that = this;\n                if (checked) {\n                    that.thead.add(that.lockedHeader).find(\"tr \" + CHECKBOXINPUT)\n                        .prop(\"checked\", true).attr(\"aria-checked\", true)\n                        .attr(\"aria-label\", \"Deselect all rows\");\n                } else {\n                    that.thead.add(that.lockedHeader).find(\"tr \" + CHECKBOXINPUT)\n                        .prop(\"checked\", false).attr(\"aria-checked\", false)\n                        .attr(\"aria-label\", \"Select all rows\");\n                }\n            },\n\n            _dataSource: function(dataSource) {\n                var that = this;\n                var ds = this.dataSource;\n                var pageable = that.options.pageable;\n\n                if (ds) {\n                    ds.unbind(CHANGE, this._refreshHandler);\n                    ds.unbind(ERROR, this._errorHandler);\n                    ds.unbind(SORT, this._sortHandler);\n                    ds.unbind(PROGRESS, this._progressHandler);\n                }\n\n                this._refreshHandler = this.refresh.bind(this);\n                this._errorHandler = this._error.bind(this);\n                this._sortHandler = this._clearSortClasses.bind(this);\n                this._progressHandler = this._progress.bind(this);\n\n\n                if (isPlainObject(dataSource)) {\n                    extend(dataSource, { table: that.table, fields: that.columns });\n\n                    if (isPlainObject(pageable) && pageable.pageSize !== undefined$1) {\n                        dataSource.pageSize = pageable.pageSize;\n                    }\n                }\n\n                ds = this.dataSource = TreeListDataSource.create(dataSource);\n\n                if (pageable) {\n                    ds._collapsedTotal = undefined$1;\n                }\n\n                ds.bind(CHANGE, this._refreshHandler);\n                ds.bind(ERROR, this._errorHandler);\n                ds.bind(SORT, this._sortHandler);\n                ds.bind(PROGRESS, this._progressHandler);\n\n                this._dataSourceFetchProxy = (function() {\n                    this.dataSource.fetch();\n                }).bind(this);\n            },\n\n            setDataSource: function(dataSource) {\n                this._dataSource(dataSource);\n                this._sortable();\n                this._filterable();\n                this._filterRow();\n                this._columnMenu();\n                this._pageable();\n\n                this._contentTree.render([]);\n\n                if (this.options.autoBind) {\n                    this.dataSource.fetch();\n                }\n            },\n\n            dataItem: function(element) {\n                if (element instanceof TreeListModel) {\n                    return element;\n                }\n\n                var row = $(element).closest(\"tr\");\n                var uid = row.attr(kendo.attr(\"uid\"));\n                var model = isUndefined(uid) ? null : this.dataSource.getByUid(uid);\n\n                return model;\n            },\n\n            editRow: function(row) {\n                var that = this;\n                var model;\n\n                if (this._isIncellEditable() || !this.options.editable) {\n                    return;\n                }\n\n                if (typeof row === STRING) {\n                    row = this.tbody.find(row);\n                }\n\n                if (that._isPageable() && that._isPopupEditable() && row instanceof TreeListModel) {\n                    // popup editor can be created without a rendered row\n                    model = row;\n                } else {\n                    model = this.dataItem(row);\n                }\n\n                if (!model) {\n                    return;\n                }\n\n                if (that.editor) {\n                    model._edit = true;\n                    this._render();\n                    this._cancelEditor();\n                } else {\n                    that._preventPageSizeRestore = false;\n\n                }\n\n                if (this._editMode() != \"popup\") {\n                    model._edit = true;\n                }\n\n                if (this.trigger(BEFORE_EDIT, { model: model })) {\n                    that.dataSource._restorePageSizeAfterAddChild();\n                    return;\n                }\n\n                this._render();\n\n                this._createEditor(model);\n\n                this.trigger(EDIT, {\n                    container: this.editor.wrapper,\n                    model: model\n                });\n            },\n\n            _cancelEdit: function(e) {\n                if (!this.editor) {\n                    return;\n                }\n                var currentIndex;\n\n                e = extend(e, {\n                    container: this.editor.wrapper,\n                    model: this.editor.model\n                });\n\n                if (this.trigger(CANCEL, e)) {\n                    return;\n                }\n\n                if (this.options.navigatable) {\n                    currentIndex = this.items().index($(this.current()).parent());\n                }\n\n                this.cancelRow();\n\n                if (this.options.navigatable) {\n                    this._setCurrent(this.items().eq(currentIndex).children().filter(NAVCELL).first());\n                    focusTable(this.table, true);\n                }\n            },\n\n            cancelRow: function() {\n                if (this._isIncellEditable()) {\n                    return;\n                }\n\n                this._cancelEditor();\n\n                this._render();\n            },\n\n            saveRow: function() {\n                var editor = this.editor;\n                var args;\n\n                if (this._isIncellEditable()) {\n                    return;\n                }\n\n                if (!editor) {\n                    return;\n                }\n\n                args = {\n                    model: editor.model,\n                    container: editor.wrapper\n                };\n\n                if (editor.end() && !this.trigger(SAVE, args)) {\n                    this.dataSource.sync();\n                }\n            },\n\n            addRow: function(parent) {\n                var that = this;\n                var dataSource = that.dataSource;\n                var pageable = that._isPageable();\n                var incellEditing = that._isIncellEditable();\n                var inlineEditing = that._isInlineEditable();\n                var editor = this.editor;\n                var index = 0;\n                var model = {};\n\n                if ((editor && !editor.end()) || !this.options.editable) {\n                    return;\n                }\n\n                if (parent) {\n                    if (!(parent instanceof TreeListModel)) {\n                        parent = this.dataItem(parent);\n                    }\n\n                    model[parent.parentIdField] = parent.id;\n                    index = this.dataSource.indexOf(parent) + 1;\n\n                    this.expand(parent)\n                        .then(function() {\n                            var showNewModelInView = pageable && dataSource._isLastItemInView(parent) && (incellEditing || inlineEditing);\n                            that._insertAt(model, index, showNewModelInView);\n                        });\n\n                    return;\n                }\n\n                this._insertAt(model, index);\n            },\n\n            _insertAt: function(model, index, showNewModelInView) {\n                var that = this;\n                var dataSource = that.dataSource;\n                model = that.dataSource.insert(index, model);\n\n                if (showNewModelInView) {\n                    dataSource._setAddChildPageSize();\n                }\n\n                var row = this._itemFor(model);\n                var cell;\n\n                if (that._isIncellEditable()) {\n                    cell = row.children(\"td\").eq(that._firstEditableColumnIndex(row));\n                    that.editCell(cell);\n                } else if (row && row[0]) {\n                    that.editRow(row);\n                } else if ((that._isPageable() || that.dataSource.filter()) && (that._isPopupEditable() || that._isInlineEditable())) {\n                    that.editRow(model);\n                }\n            },\n\n            _firstEditableColumnIndex: function(container) {\n                var that = this;\n                var model = that.dataItem(container);\n                var columns = leafColumns(that.columns);\n                var length = columns.length;\n                var column;\n                var idx;\n\n                for (idx = 0; idx < length; idx++) {\n                    column = columns[idx];\n\n                    if (model && (!model.editable || model.editable(column.field)) && !column.command && column.field && column.hidden !== true) {\n                        return idx;\n                    }\n                }\n\n                return -1;\n            },\n\n            removeRow: function(row) {\n                var model = this.dataItem(row);\n                var args = {\n                    model: model,\n                    row: row\n                };\n\n                if (this.options.editable && model && !this.trigger(REMOVE, args)) {\n                    if (document.activeElement === $(row).find(\".k-grid-delete\")[0]) {\n                        $(row).find(\".k-grid-delete\").trigger(\"blur\");\n                    }\n                    this.dataSource.remove(model);\n\n                    if (!this._isIncellEditable()) {\n                        this.dataSource.sync();\n                    }\n                }\n            },\n\n            _cancelEditor: function() {\n                var that = this;\n                var model;\n                var editor = that.editor;\n\n                if (editor) {\n                    model = editor.model;\n\n                    that._destroyEditor();\n\n                    if (!that._isIncellEditable()) {\n                        that.dataSource.cancelChanges(model);\n                    } else if (that._shouldRestorePageSize()) {\n                        that.dataSource._restorePageSizeAfterAddChild();\n                    }\n\n                    model._edit = false;\n                }\n\n                that._preventPageSizeRestore = false;\n            },\n\n            _shouldRestorePageSize: function() {\n                var that = this;\n                return that._isPageable() && that._isIncellEditable() && !that._preventPageSizeRestore;\n            },\n\n            _destroyEditor: function() {\n                if (!this.editor) {\n                    return;\n                }\n\n                this.editor.close();\n                this.editor = null;\n            },\n\n            _createEditor: function(model) {\n                var row = this.itemFor(model);\n                var columns = leafColumns(this.columns);\n                var leafCols = [];\n\n                for (var idx = 0; idx < columns.length; idx++) {\n                    leafCols.push(extend({}, columns[idx]));\n                    delete leafCols[idx].parentColumn;\n                }\n\n                row = row.add(this._relatedRow(row));\n\n                var mode = this._editMode();\n\n                var options = {\n                    columns: leafCols,\n                    model: model,\n                    target: this,\n                    clearContainer: false,\n                    template: this.options.editable.template\n                };\n\n                if (mode == \"inline\") {\n                    this.editor = new Editor(row, options);\n                } else {\n                    extend(options, {\n                        window: this.options.editable.window,\n                        commandRenderer: (function() {\n                            return this._buildCommands([\"update\", \"canceledit\"]);\n                        }).bind(this),\n                        fieldRenderer: this._cellContent.bind(this),\n                        save: this.saveRow.bind(this),\n                        cancel: this._cancelEdit.bind(this),\n                        appendTo: this.wrapper\n                    });\n\n                    this.editor = new PopupEditor(row, options);\n                }\n            },\n\n            _createIncellEditor: function(cell, options) {\n                var that = this;\n                var column = extend({}, options.columns[0]);\n\n                delete column.parentColumn;\n\n                return new IncellEditor(cell, extend({}, {\n                    fieldRenderer: that._cellContent.bind(that),\n                    appendTo: that.wrapper,\n                    clearContainer: false,\n                    target: that,\n                    columns: [column],\n                    model: options.model,\n                    change: options.change\n                }));\n            },\n\n            editCell: function(cell) {\n                var that = this;\n                cell = $(cell);\n                var column = leafColumns(that.columns)[that.cellIndex(cell)];\n                var model = that.dataItem(cell);\n\n                if (that._isIncellEditable() && model && isColumnEditable(column, model)) {\n                    that._editCell(cell, column, model);\n                }\n            },\n\n            _editCell: function(cell, column, model) {\n                var that = this;\n                var editedCell;\n\n                if (that.trigger(BEFORE_EDIT, { model: model })) {\n                    that.dataSource._restorePageSizeAfterAddChild();\n                    return;\n                }\n\n                that.closeCell();\n\n                model._edit = true;\n\n                that._cancelEditor();\n\n                that._render({\n                    editedColumn: column,\n                    editedColumnIndex: cell.index()\n                });\n\n                editedCell = that.table.add(that.lockedTable).find(DOT + classNames.editCell).first();\n\n                that.editor = that._createIncellEditor(editedCell, {\n                    columns: [column],\n                    model: model,\n                    change: function(e) {\n                        if (that.trigger(SAVE, { values: e.values, container: cell, model: model } )) {\n                            e.preventDefault();\n                        }\n\n                    }\n                });\n\n                // refresh the current element as the DOM element reference can be changed after render()\n                that._current = editedCell;\n\n                that.trigger(EDIT, { container: cell, model: model });\n            },\n\n            closeCell: function(isCancel) {\n                var that = this;\n                var cell = (that.editor || {}).element;\n                var tr;\n                var model;\n\n                if (!cell || !cell[0] || !that._isIncellEditable()) {\n                    return;\n                }\n\n                model = that.dataItem(cell);\n\n                if (isCancel && that.trigger(CANCEL, { container: cell, model: model })) {\n                    return;\n                }\n\n                that.trigger(CELL_CLOSE, { type: isCancel ? CANCEL : SAVE, model: model, container: cell });\n\n                that._cancelEditor();\n\n                cell.removeClass(classNames.editCell);\n\n                tr = cell.parent().removeClass(classNames.editRow);\n\n                if (that.lockedContent) {\n                    that._relatedRow(tr).removeClass(classNames.editRow);\n                }\n\n                that._render();\n\n                that.trigger(ITEM_CHANGE, { item: tr, data: model, ns: ui });\n\n                if (that.lockedContent) {\n                    adjustRowHeight(tr.css(\"height\", \"\")[0], that._relatedRow(tr).css(\"height\", \"\")[0]);\n                }\n            },\n\n            cancelChanges: function() {\n                this.dataSource.cancelChanges();\n            },\n\n            saveChanges: function() {\n                var that = this;\n                var editable = (that.editor || {}).editable;\n                var valid = editable && editable.end();\n\n                if ((valid || !editable) && !that.trigger(SAVE_CHANGES)) {\n                    that.dataSource.sync();\n                }\n            },\n\n            _editMode: function() {\n                var mode = \"inline\",\n                    editable = this.options.editable;\n\n                if (editable !== true) {\n                    if (typeof editable == \"string\") {\n                        mode = editable;\n                    } else {\n                        mode = editable.mode || mode;\n                    }\n                }\n\n                return mode.toLowerCase();\n            },\n\n            _isIncellEditable: function() {\n                return this._editMode() === INCELL;\n            },\n\n            _isInlineEditable: function() {\n                return this._editMode() === INLINE;\n            },\n\n            _isPopupEditable: function() {\n                return this._editMode() === POPUP;\n            },\n\n            hideColumn: function(column) {\n                this._toggleColumnVisibility(column, true);\n            },\n\n            showColumn: function(column) {\n                this._toggleColumnVisibility(column, false);\n            },\n\n            _toggleColumnVisibility: function(column, hidden) {\n                column = this._findColumn(column);\n\n                if (!column || column.hidden === hidden) {\n                    return;\n                }\n\n                column.hidden = hidden;\n                this._setParentsVisibility(column, !hidden);\n\n                this._ensureExpandableColumn();\n                this._clearColsCache();\n                this._renderCols();\n                this._renderHeader();\n                this._render();\n\n                this._adjustTablesWidth();\n\n                this.trigger(hidden ? COLUMNHIDE : COLUMNSHOW, { column: column });\n\n                if (!hidden && !column.width) {\n                    this.table\n                        .add(this.thead.closest(\"table\"))\n                        .width(\"\");\n                }\n                this._updateFirstColumnClass();\n            },\n\n            _findColumn: function(column) {\n                if (typeof column == \"number\") {\n                    column = this.columns[column];\n                } else if (isPlainObject(column)) {\n                    column = grep(leafColumns(this.columns), function(item) {\n                        return item === column;\n                    })[0];\n                } else {\n                    column = grep(leafColumns(this.columns), function(item) {\n                        return item.field === column;\n                    })[0];\n                }\n\n                return column;\n            },\n\n            _adjustTablesWidth: function() {\n                var idx, length;\n                var cols = this.thead.prev().children();\n                var colWidth, width = 0;\n\n                for (idx = 0, length = cols.length; idx < length; idx++ ) {\n                    colWidth = cols[idx].style.width;\n                    if (colWidth && colWidth.indexOf(\"%\") == -1) {\n                        width += parseInt(colWidth, 10);\n                    } else {\n                        width = 0;\n                        break;\n                    }\n                }\n\n\n                if (width) {\n                    this.table\n                        .add(this.thead.closest(\"table\"))\n                        .width(width);\n                }\n            },\n\n            _reorderable: function() {\n                if (!this.options.reorderable) {\n                    return;\n                }\n\n                var scrollable = this.options.scrollable === true;\n                var selector = (scrollable ? \".k-grid-header \" : \"table>.k-grid-header \") + HEADERCELLS;\n                var that = this;\n\n                this._draggableInstance = new ui.Draggable(this.wrapper, {\n                    group: kendo.guid(),\n                    filter: selector,\n                    hint: function(target) {\n                        return $('<div class=\"k-reorder-clue k-drag-clue\" />')\n                        .html(target.attr(kendo.attr(\"title\")) || target.attr(kendo.attr(\"field\")) || target.text())\n                        .prepend('<span class=\"k-icon k-drag-status k-i-cancel\" />');\n                    }\n                });\n\n                this.reorderable = new ui.Reorderable(this.wrapper, {\n                    draggable: this._draggableInstance,\n                    dragOverContainers: this._allowDragOverContainers.bind(this),\n                    inSameContainer: function(e) {\n                        return $(e.source).parent()[0] === $(e.target).parent()[0] && targetParentContainerIndex(flatColumnsInDomOrder(that.columns), that.columns, e.sourceIndex, e.targetIndex) > -1;\n                    },\n                    change: function(e) {\n                        var columns = flatColumnsInDomOrder(that.columns);\n                        var column = columns[e.oldIndex];\n                        var newIndex = targetParentContainerIndex(columns, that.columns, e.oldIndex, e.newIndex);\n\n                        that.trigger(COLUMNREORDER, {\n                            newIndex: newIndex,\n                            oldIndex: inArray(column, columns),\n                            column: column\n                        });\n\n                        that.reorderColumn(newIndex, column, e.position === \"before\");\n                    }\n                });\n            },\n\n            _allowDragOverContainers: function(sourceIndex, targetIndex) {\n                var columns = flatColumnsInDomOrder(this.columns);\n                return columns[sourceIndex].lockable !== false && targetParentContainerIndex(columns, this.columns, sourceIndex, targetIndex) > -1;\n            },\n\n            _reorderTrees: function(destSources, destContainer, destDomTree, sources, sourcesContainer, sourcesDomTree, before, depth) {\n                var ths = $();\n                var source = sourcesContainer.find(\"tr\").eq(sources[0].rowIndex);\n                var sourceDOM = sourcesDomTree.children[sources[0].rowIndex];\n                var sourceChildren = source.children();\n                var destDomChildren;\n                var currentIndex;\n                var destColumn = before ? destSources[0] : destSources[destSources.length - 1];\n                var destRow;\n                var sourcesLeafs;\n                var destLeafs;\n                var reorderTaget;\n                var destThs;\n\n                for (var idx = 0; idx < sources.length; idx++) {\n                    currentIndex = sources[idx].cellIndex;\n                    ths = ths.add(sourceChildren.eq(currentIndex));\n                    destDomChildren = destDomTree.children[destColumn.rowIndex].children;\n                    if (destDomTree === sourcesDomTree && before) {\n                        currentIndex += idx;\n                    }\n\n                    destDomChildren.splice(before ? destColumn.cellIndex + idx : destColumn.cellIndex + 1 + idx, 0, sourceDOM.children[currentIndex]);\n                }\n\n                if (destDomTree === sourcesDomTree && before) {\n                    sourceDOM.children.splice(sources[0].cellIndex + sources.length, sources.length);\n                } else {\n                    sourceDOM.children.splice(sources[0].cellIndex, sources.length);\n                }\n                destRow = destContainer.find(\"tr\").eq(destColumn.rowIndex);\n                destThs = destRow.find(\">th.k-header\").eq(destColumn.cellIndex);\n\n                if (destThs.length && ths[0] !== destThs[0]) {\n                    ths[before ? \"insertBefore\" : \"insertAfter\"](destThs);\n                }\n\n                if (depth >= sources[0].rowIndex + 1 && depth != 1) {\n                    sourcesLeafs = [];\n                    for (idx = 0; idx < sources.length; idx++) {\n                        if (sources[idx].columns) {\n                            sourcesLeafs = sourcesLeafs.concat(sources[idx].columns);\n                        }\n                    }\n                    if (!sourcesLeafs.length) {\n                        return;\n                    }\n\n                    destLeafs = [];\n\n                    for (idx = 0; idx < destSources.length; idx++) {\n                        if (destSources[idx].columns) {\n                            destLeafs = destLeafs.concat(destSources[idx].columns);\n                        }\n                    }\n\n                    if (!destLeafs.length && (destContainer !== sourcesContainer || (destColumn.cellIndex - sources[0].cellIndex > 1 || sources[0].cellIndex - destColumn.cellIndex > 1))) {\n                        reorderTaget = findReorderTarget(this.columns, destColumn, sources[0], before, this.columns);\n\n                        destLeafs = [reorderTaget];\n                        if (!reorderTaget && sourcesLeafs.length && destContainer.find(\"tr\").length > sources[0].rowIndex + 1) {\n                            this._insertTree(sourcesLeafs, sourcesContainer, sourcesDomTree, destContainer, destDomTree);\n                            return;\n                        }\n                    }\n\n                    if (!destLeafs.length) {\n                        return;\n                    }\n\n                    this._reorderTrees(destLeafs, destContainer, destDomTree, sourcesLeafs, sourcesContainer, sourcesDomTree, before, depth);\n                }\n            },\n\n            _insertTree: function(columns, sourcesContainer, sourcesDomTree, destContainer, destDomTree) {\n                var leafs = [];\n                var row;\n                var ths = $();\n                var domTr;\n\n                row = sourcesContainer.find(\"tr\").eq(columns[0].rowIndex);\n                domTr = sourcesDomTree.children[columns[0].rowIndex];\n\n                for (var idx = 0; idx < columns.length; idx++) {\n                    if (columns[idx].columns) {\n                        leafs = leafs.concat(columns[idx].columns);\n                    }\n                    destDomTree.children[columns[0].rowIndex].children.splice(idx, 0, domTr.children[columns[idx].rowIndex]);\n                    ths = ths.add(row.find(\">th.k-header\").eq(columns[idx].cellIndex));\n                }\n\n                sourcesDomTree.children[columns[0].rowIndex].children.splice(columns[0].cellIndex, columns.length);\n                destContainer.find(\"tr\").eq(columns[0].rowIndex).append(ths);\n\n                if (leafs.length) {\n                    this._insertTree(leafs, sourcesContainer, sourcesDomTree, destContainer, destDomTree);\n                }\n            },\n\n            _reorderHeader: function(destColumn, column, before) {\n                var sourcesDepth = column.columns ? depth([column]) : 1;\n                var targetDepth = destColumn.columns ? depth([destColumn]) : 1;\n                var sourceLocked = isLocked(column);\n                var destLocked = isLocked(destColumn);\n                var destContainer = destLocked ? this.lockedHeader : this.thead;\n                var sourcesContainer = sourceLocked ? this.lockedHeader : this.thead;\n                var destDomTree = destLocked ? this._lockedHeaderTree : this._headerTree;\n                var sourcesDomTree = sourceLocked ? this._lockedHeaderTree : this._headerTree;\n                var rowsToAdd;\n                var destRows = destContainer.find(\"tr:not(.k-filter-row)\");\n                var destTarget;\n\n\n                if (sourcesDepth === targetDepth || sourcesDepth < destRows.length ) {\n                    this._reorderTrees([destColumn], destContainer, destDomTree , [column], sourcesContainer ,sourcesDomTree, before, sourcesDepth);\n                    updateRowSpans(destContainer, destDomTree);\n                    removeEmptyRows(sourcesContainer, sourcesDomTree);\n                } else {\n                    if (destContainer !== sourcesContainer) {\n                        rowsToAdd = sourcesDepth - destRows.length;\n\n                        destRows.each(function(idx) {\n                            var cells = this.cells;\n                            for (var i = 0; i < cells.length; i++) {\n                                if (cells[i].colSpan <= 1 && cells[i].attributes.rowspan) {\n                                    destDomTree.children[idx].children[i].attr.rowSpan += rowsToAdd;\n                                    cells[i].rowSpan += rowsToAdd;\n                                }\n                            }\n                        });\n\n                        for (var j = 0; j < rowsToAdd; j++) {\n                           destDomTree.children.push(kendoDomElement(\"tr\", { \"role\": \"row\" }));\n                           if (destContainer.is(\"thead\")) {\n                               destTarget = destContainer;\n                           } else {\n                              destTarget = destContainer.find(\"thead\");\n                           }\n\n                           if (this._hasFilterRow()) {\n                               $(\"<tr role='row'></tr>\").insertBefore(destTarget.find('tr.k-filter-row'));\n                           } else {\n                               destTarget.append(\"<tr role='row'></tr>\");\n                           }\n                        }\n                    }\n\n                    this._reorderTrees([destColumn], destContainer, destDomTree , [column], sourcesContainer ,sourcesDomTree, before, sourcesDepth);\n                    removeEmptyRows(sourcesContainer, sourcesDomTree);\n                 }\n            },\n\n            reorderColumn: function(destIndex, column, before) {\n                var lockChanged;\n                var parent = column.parentColumn;\n                var columns = parent ? parent.columns : this.columns;\n                var sourceIndex = inArray(column, columns);\n                var destColumn = columns[destIndex];\n                var isLocked = !!destColumn.locked;\n                var hasMultiColumnHeaders = grep(this.columns, function(item) {\n                    return item.columns !== undefined$1;\n                }).length > 0;\n                var nonLockedColumnsLength = nonLockedColumns(columns).length;\n\n                if (sourceIndex === destIndex) {\n                    return;\n                }\n\n                if (isLocked && !column.locked && nonLockedColumnsLength == 1) {\n                    return;\n                }\n\n                if (!isLocked && column.locked && (columns.length - nonLockedColumnsLength == 1)) {\n                    return;\n                }\n\n                if (before === undefined$1) {\n                    before = destIndex < sourceIndex;\n                }\n\n                if (hasMultiColumnHeaders) {\n                    this._reorderHeader(destColumn, column, before);\n                }\n\n                lockChanged = !!column.locked;\n                lockChanged = lockChanged != isLocked;\n\n                column.locked = isLocked;\n                columns.splice(before ? destIndex : destIndex + 1, 0, column);\n                columns.splice(sourceIndex < destIndex ? sourceIndex : sourceIndex + 1, 1);\n                this._setColumnDataIndexes(leafColumns(this.columns));\n                this._clearColsCache();\n                this._renderCols();\n\n                //reorder column header manually\n                if (!hasMultiColumnHeaders) {\n                    var ths = $(this.lockedHeader).add(this.thead).find(\"tr:not(.k-filter-row) th\");\n\n                    ths.eq(sourceIndex)[before ? \"insertBefore\" : \"insertAfter\"](ths.eq(destIndex));\n\n                    var dom = this._headerTree.children[0].children;\n                    if (this._hasLockedColumns) {\n                        dom = this._lockedHeaderTree.children[0].children.concat(dom);\n                    }\n                    dom.splice(before ? destIndex : destIndex + 1, 0, dom[sourceIndex]);\n                    dom.splice(sourceIndex < destIndex ? sourceIndex : sourceIndex + 1, 1);\n                    if (this._hasLockedColumns) {\n                        this._lockedHeaderTree.children[0].children = dom.splice(0, lockedColumns(columns).length);\n                        this._headerTree.children[0].children = dom;\n                    }\n                } else {\n                    if (this.lockedHeader) {\n                        columns = nonLockedColumns(this.columns);\n                        this._prepareColumns([{ rowSpan: 1, cells: [], index: 0 }], columns);\n                        columns = lockedColumns(this.columns);\n                        this._prepareColumns([{ rowSpan: 1, cells: [], index: 0 }], columns);\n                    } else {\n                        this._prepareColumns([{ rowSpan: 1, cells: [], index: 0 }], this.columns);\n                    }\n                }\n                this._updateColumnCellIndex();\n                this._applyLockedContainersWidth();\n                this._syncLockedHeaderHeight();\n                this._updateFirstColumnClass();\n\n                if (this._hasFilterRow()) {\n                    this._updateFilterThs(before, column, destColumn);\n                }\n\n                this.refresh();\n\n                if (!lockChanged) {\n                    return;\n                }\n\n                if (isLocked) {\n                    this.trigger(COLUMNLOCK, {\n                        column: column\n                    });\n                } else {\n                    this.trigger(COLUMNUNLOCK, {\n                        column: column\n                    });\n                }\n            },\n\n            lockColumn: function(column) {\n                var columns = this.columns;\n\n                if (typeof column == \"number\") {\n                    column = columns[column];\n                } else {\n                    column = grep(columns, function(item) {\n                        return item.field === column;\n                    })[0];\n                }\n\n                if (!column || column.hidden) {\n                    return;\n                }\n\n                var index = lockedColumns(columns).length - 1;\n                this.reorderColumn(index, column, false);\n            },\n\n            unlockColumn: function(column) {\n                var columns = this.columns;\n\n                if (typeof column == \"number\") {\n                    column = columns[column];\n                } else {\n                    column = grep(columns, function(item) {\n                        return item.field === column;\n                    })[0];\n                }\n\n                if (!column || column.hidden) {\n                    return;\n                }\n\n                var index = lockedColumns(columns).length;\n                this.reorderColumn(index, column, true);\n            },\n\n            _columnMenu: function() {\n                var ths = $(this.lockedHeader).add(this.thead).find(\"th\");\n                var columns = this.columns;\n                var options = this.options;\n                var columnMenu = options.columnMenu;\n                var column, menu, menuOptions, sortable, filterable;\n                var initHandler = this._columnMenuInit.bind(this);\n                var openHandler = this._columnMenuOpen.bind(this);\n                var sortHandler = this._sort.bind(this);\n                var filterHandler = this._filter.bind(this);\n                var hasLockableColumns = grep(this.columns, function(item) {\n                    return item.lockable !== false;\n                }).length > 0;\n                var hasMultiColumnHeaders = grep(this.columns, function(item) {\n                    return item.columns !== undefined$1;\n                }).length > 0;\n\n                if (hasMultiColumnHeaders) {\n                    columns = leafColumns(columns);\n                    if (this.lockedHeader) {\n                        ths = sortCells(leafDataCells(this.lockedHeader.find(\">table>thead\")).add(leafDataCells(this.thead)));\n                    } else {\n                        ths = leafDataCells(this.thead);\n                    }\n                } else {\n                    ths = $(this.lockedHeader).add(this.thead).find(\"tr:not(.k-filter-row) th\");\n                }\n\n                if (!columnMenu) {\n                    return;\n                }\n\n                if (typeof columnMenu == \"boolean\") {\n                    columnMenu = {};\n                }\n\n                for (var i = 0; i < ths.length; i++) {\n                    column = columns[i];\n                    if (!column.field) {\n                        continue;\n                    }\n\n                    menu = ths.eq(i).data(\"kendoColumnMenu\");\n                    if (menu) {\n                        menu.destroy();\n                    }\n\n                    sortable = false;\n                    if (column.sortable !== false && columnMenu.sortable !== false && options.sortable !== false) {\n                        sortable = extend({}, options.sortable, { compare: (column.sortable || {}).compare });\n                    }\n\n                    filterable = false;\n                    if (options.filterable && column.filterable !== false && columnMenu.filterable !== false) {\n                        filterable = extend({ pane: this.pane }, column.filterable, options.filterable);\n                    }\n\n                    menuOptions = {\n                        dataSource: this.dataSource,\n                        values: column.values,\n                        columns: columnMenu.columns,\n                        sortable: sortable,\n                        filterable: filterable,\n                        messages: columnMenu.messages,\n                        owner: this,\n                        closeCallback: closeCallback,\n                        init: initHandler,\n                        open: openHandler,\n                        sort: sortHandler,\n                        filtering: filterHandler,\n                        pane: this.pane,\n                        hasLockableColumns: lockedColumns(columns).length > 0 && hasLockableColumns && !hasMultiColumnHeaders,\n                        appendTo: DOT + classNames.headerCellInner\n                    };\n\n                    if (options.$angular) {\n                        menuOptions.$angular = options.$angular;\n                    }\n\n                    ths.eq(i).kendoColumnMenu(menuOptions);\n                }\n            },\n\n            _columnMenuInit: function(e) {\n                this.trigger(COLUMNMENUINIT, { field: e.field, container: e.container });\n            },\n\n            _columnMenuOpen: function(e) {\n                this.trigger(COLUMNMENUOPEN, { field: e.field, container: e.container });\n            },\n\n            _filter: function(e) {\n                if (this.trigger(FILTER, { filter: e.filter, field: e.field })) {\n                    e.preventDefault();\n                }\n            },\n\n            _sort: function(e) {\n                if (this.trigger(SORT, { sort: e.sort })) {\n                    e.preventDefault();\n                }\n            },\n\n            _pageable: function() {\n                var that = this,\n                    wrapper,\n                    pageable = that.options.pageable;\n\n                if (pageable) {\n                    wrapper = that.wrapper.children(\"div.k-grid-pager\");\n\n                    if (!wrapper.length) {\n                        wrapper = $('<div class=\"k-pager-wrap k-grid-pager\"/>').appendTo(that.wrapper);\n                    }\n\n                    that._destroyPager();\n\n                    if (typeof pageable === \"object\" && pageable instanceof kendo.ui.TreeListPager) {\n                        that.pager = pageable;\n                    } else if (that.dataSource && !that.dataSource.options.serverPaging) {\n                        that._createPager(wrapper);\n                    }\n\n                    if (that.pager) {\n                        that.pager.bind(PAGE_CHANGE, function(e) {\n                            if (that.trigger(PAGE, { page: e.index })) {\n                                e.preventDefault();\n                            }\n                        });\n                    }\n                }\n            },\n\n            _createPager: function(element, options) {\n                var that = this;\n\n                that.pager = new TreeListPager(element, extend({}, that.options.pageable, {\n                    dataSource: that.dataSource,\n                    navigatable: that.options.navigatable\n                }, options));\n            },\n\n            _destroyPager: function() {\n                if (this.pager) {\n                    this.pager.destroy();\n                    this.pager = null;\n                }\n            },\n\n            _isPageable: function() {\n                var that = this;\n                return that.options.pageable && (!that.dataSource || (that.dataSource && that.dataSource._isPageable()));\n            },\n\n            _togglePagerVisibility: function() {\n                var that = this;\n                var pageable = that.options.pageable;\n\n                if (pageable && (isPlainObject(pageable) || pageable instanceof TreeListPager) && pageable.alwaysVisible === false) {\n                    that.wrapper.find(\".k-grid-pager\").toggle((that.dataSource.collapsedTotal() || 0) >= that.dataSource.pageSize());\n                }\n            }\n        });\n\n        function closeCallback(element) {\n            focusTable(element.closest(\"table\"), true);\n        }\n\n        function isInputElement(element) {\n           return $(element).is(\":button,a,:input,a>.k-icon,textarea,span.k-select,span.k-icon,span.k-link,.k-input,.k-multiselect-wrap,.k-tool-icon\");\n        }\n\n        function isLocked(column) {\n            if (!column.parentColumn) {\n                return !!column.locked;\n            }\n            return !!isLocked(column.parentColumn);\n        }\n\n        function findParentColumnWithChildren(columns, index, source, rtl) {\n            var target;\n            var locked = !!source.locked;\n            var targetLocked;\n\n            do {\n                target = columns[index];\n                index += rtl ? 1 : -1;\n                targetLocked = !!target.locked;\n            } while (target && index > -1 && index < columns.length && target != source && !target.columns && targetLocked === locked);\n\n            return target;\n        }\n\n        function findReorderTarget(columns, target, source, before, masterColumns) {\n            if (target.columns) {\n                target = target.columns;\n                return target[before ? 0 : target.length - 1];\n            } else {\n                var parent = columnParent(target, columns);\n                var parentColumns;\n\n                if (parent) {\n                    parentColumns = parent.columns;\n                } else {\n                    parentColumns = columns;\n                }\n\n                var index = inArray(target, parentColumns);\n                if (index === 0 && before && parentColumns.length !== 1) {\n                    index++;\n                } else if (index == parentColumns.length - 1 && !before && index !== 0) {\n                    index--;\n                } else if (index > 0 || (index === 0 && !before && index !== 0)) {\n                    index += before ? -1 : 1;\n                }\n\n                var sourceIndex = inArray(source, parentColumns);\n                target = findParentColumnWithChildren(parentColumns, index, source, sourceIndex > index);\n                var targetIndex = inArray(target, masterColumns);\n                if (target.columns && (!targetIndex || targetIndex === parentColumns.length - 1)) {\n                    return null;\n                }\n\n                if (target && target != source && target.columns) {\n                    return findReorderTarget(columns, target, source, before, masterColumns);\n                }\n            }\n            return null;\n        }\n\n        function leafColumns(columns) {\n            var result = [];\n\n            for (var idx = 0; idx < columns.length; idx++) {\n                if (!columns[idx].columns) {\n                    result.push(columns[idx]);\n                    continue;\n                }\n                result = result.concat(leafColumns(columns[idx].columns));\n            }\n\n            return result;\n        }\n\n        function getColumnsFields(columns) {\n            var result = [];\n            columns = leafColumns(columns);\n\n            for (var idx = 0; idx < columns.length; idx++) {\n                if (typeof columns[idx] === \"string\") {\n                    result.push(columns[idx]);\n                } else if (columns[idx].field) {\n                    result.push(columns[idx].field);\n                }\n            }\n            return result;\n        }\n\n        function visibleChildColumns(columns) {\n            return grep(columns, function(column) {\n                return !column.hidden;\n            });\n        }\n\n        function isVisible(column) {\n            return visibleColumns([column]).length > 0;\n        }\n\n        function visibleColumns(columns) {\n            return grep(columns, function(column) {\n                var result = !column.hidden;\n                if (result && column.columns) {\n                    result = visibleColumns(column.columns).length > 0;\n                }\n                return result;\n            });\n        }\n\n        function normalizeColumns(columns, hide, parentIds) {\n            return map(columns, function(column) {\n                var hidden;\n\n                column.parentIds = parentIds;\n\n                if (!isVisible(column) || hide) {\n                    hidden = true;\n                }\n\n                var uid = kendo.guid();\n                column.headerAttributes = extend({ headers: parentIds }, column.headerAttributes);\n                if (!column.headerAttributes || !column.headerAttributes.id) {\n                    column.headerAttributes = extend({ id: uid }, column.headerAttributes);\n                } else {\n                    uid = column.headerAttributes.id;\n                }\n\n                if (column.columns) {\n                    column.columns = normalizeColumns(column.columns, hidden, parentIds ? (parentIds + \" \" + uid) : uid);\n                }\n                return extend({ hidden: hidden }, column);\n            });\n        }\n\n        function flatColumnsInDomOrder(columns) {\n            var result = flatColumns(lockedColumns(columns));\n            return result.concat(flatColumns(nonLockedColumns(columns)));\n        }\n\n        function targetParentContainerIndex(flatColumns, columns, sourceIndex, targetIndex) {\n            var column = flatColumns[sourceIndex];\n            var target = flatColumns[targetIndex];\n\n            var parent = columnParent(column, columns);\n            columns = parent ? parent.columns : columns;\n\n            return inArray(target, columns);\n        }\n\n        function parentColumnsCells(cell) {\n            var container = cell.closest(\"table\");\n            var result = $().add(cell);\n\n            var row = cell.closest(\"tr\");\n            var headerRows = container.find(\"tr\");\n            var level = headerRows.index(row);\n            if (level > 0) {\n                var parent = headerRows.eq(level - 1);\n                var parentCellsWithChildren = parent.find(\"th\").filter(function() {\n                    return !$(this).attr(\"rowspan\");\n                });\n\n                var offset = 0;\n                var index = row.find(\"th\").index(cell);\n\n                var prevCells = cell.prevAll().filter(function() {\n                    return this.colSpan > 1;\n                });\n\n                for (var idx = 0; idx < prevCells.length; idx++) {\n                    offset += prevCells[idx].colSpan || 1;\n                }\n\n                index += Math.max(offset - 1, 0);\n\n                offset = 0;\n                for (idx = 0; idx < parentCellsWithChildren.length; idx++) {\n                    var parentCell = parentCellsWithChildren.eq(idx);\n                    if (parentCell.attr(\"data-colspan\")) {\n                        offset += parentCell[0].getAttribute(\"data-colspan\");\n                    } else {\n                        offset += 1;\n                    }\n                    if (index >= idx && index < offset) {\n                        result = parentColumnsCells(parentCell).add(result);\n                        break;\n                    }\n                }\n            }\n            return result;\n        }\n\n        function childColumnsCells(cell) {\n            var container = cell.closest(\"thead\");\n            var result = $().add(cell);\n\n            var row = cell.closest(\"tr\");\n            var headerRows = container.find(\"tr\");\n            var level = headerRows.index(row) + cell[0].rowSpan;\n            var colSpanAttr = kendo.attr(\"colspan\");\n\n            if (level <= headerRows.length - 1) {\n                var child = row.next();\n                var prevCells = cell.prevAll();\n\n                var idx;\n\n                prevCells = prevCells.filter(function() {\n                    return !this.rowSpan || this.rowSpan === 1;\n                });\n\n                var offset = 0;\n\n                for (idx = 0; idx < prevCells.length; idx++) {\n                    offset += parseInt(prevCells.eq(idx).attr(colSpanAttr), 10) || 1;\n                }\n\n                var cells = child.find(\"th\");\n                var colSpan = parseInt(cell.attr(colSpanAttr), 10) || 1;\n\n                idx = 0;\n\n                while (idx < colSpan) {\n                    child = cells.eq(idx + offset);\n                    result = result.add(childColumnsCells(child));\n                    var value = parseInt(child.attr(colSpanAttr), 10);\n                    if (value > 1) {\n                        colSpan -= value - 1;\n                    }\n                    idx++;\n                }\n            }\n\n            return result;\n        }\n\n        function columnParent(column, columns) {\n            var parents = [];\n            columnParents(column, columns, parents);\n            return parents[parents.length - 1];\n        }\n\n        function columnParents(column, columns, parents) {\n            parents = parents || [];\n\n            for (var idx = 0; idx < columns.length; idx++) {\n                if (column === columns[idx]) {\n                    return true;\n                } else if (columns[idx].columns) {\n                    var inserted = parents.length;\n                    parents.push(columns[idx]);\n                    if (!columnParents(column, columns[idx].columns, parents)) {\n                        parents.splice(inserted, parents.length - inserted);\n                    } else {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        }\n\n        function flatColumns(columns) {\n            var result = [];\n            var children = [];\n            for (var idx = 0; idx < columns.length; idx++) {\n                result.push(columns[idx]);\n                if (columns[idx].columns) {\n                    children = children.concat(columns[idx].columns);\n                }\n\n            }\n            if (children.length) {\n                result = result.concat(flatColumns(children));\n            }\n            return result;\n        }\n\n        function columnPosition(column, columns, row, cellCounts) {\n            var result;\n            var idx;\n\n            row = row || 0;\n            cellCounts = cellCounts || {};\n            cellCounts[row] = cellCounts[row] || 0;\n\n            for (idx = 0; idx < columns.length; idx++) {\n               if (columns[idx] == column) {\n                    result = { cell: cellCounts[row], row: row };\n                    break;\n               } else if (columns[idx].columns) {\n                   result = columnPosition(column, columns[idx].columns, row + 1, cellCounts);\n                   if (result) {\n                        break;\n                   }\n               }\n\n               cellCounts[row]++;\n            }\n            return result;\n        }\n\n        function updateCellIndex(thead, columns, offset) {\n            offset = offset || 0;\n\n            var position;\n            var cell;\n            var allColumns = columns;\n            columns = leafColumns(columns);\n\n            var cells = {};\n            var rows = thead.find(\">tr:not(.k-filter-row)\");\n\n            var filter = function() {\n                var el = $(this);\n                return !el.hasClass(\"k-group-cell\") && !el.hasClass(\"k-hierarchy-cell\");\n            };\n\n            for (var idx = 0, length = columns.length; idx < length; idx++) {\n                position = columnPosition(columns[idx], allColumns);\n\n                if (!cells[position.row]) {\n                    cells[position.row] = rows.eq(position.row)\n                        .find(\".k-header\")\n                        .filter(filter);\n                }\n\n                cell = cells[position.row].eq(position.cell);\n                cell.attr(kendo.attr(\"index\"), offset + idx);\n            }\n\n            return columns.length;\n        }\n\n        function depth(columns) {\n            var result = 1;\n            var max = 0;\n\n            for (var idx = 0; idx < columns.length; idx++) {\n                if (columns[idx].columns) {\n                    var temp = depth(columns[idx].columns);\n                    if (temp > max) {\n                        max = temp;\n                    }\n                }\n            }\n            return result + max;\n        }\n\n        function lockedColumns(columns) {\n            return grep(columns, is(\"locked\"));\n        }\n\n        function nonLockedColumns(columns) {\n            return grep(columns, not(is(\"locked\")));\n        }\n\n        function updateRowSpans(container, containerDOMtree) {\n            var rows = container.find(\"tr:not(.k-filter-row)\");\n            var length = rows.length;\n\n            rows.each(function(idx) {\n                var cells = this.cells;\n                for (var i = 0; i < cells.length; i++) {\n                    if (cells[i].colSpan <= 1 && cells[i].attributes.rowspan) {\n                        containerDOMtree.children[idx].children[i].attr.rowSpan = length - idx;\n                        cells[i].rowSpan = length - idx;\n                    }\n                }\n            });\n        }\n\n        function removeEmptyRows(container, containerDOMtree) {\n            var rows = container.find(\"tr\");\n            var emptyRows = [];\n\n            rows.filter(function(idx) {\n                var shouldRemove = !$(this).children().length;\n                if (shouldRemove) {\n                    emptyRows.push(idx);\n\n                }\n                return shouldRemove;\n            }).remove();\n\n            for (var i = emptyRows.length - 1; i >= 0; i--) {\n                containerDOMtree.children.splice(emptyRows[i], 1);\n            }\n\n            updateRowSpans(container, containerDOMtree);\n        }\n\n        function focusTable(table, direct) {\n          if (direct === true) {\n             table = $(table);\n             var scrollTop, scrollLeft;\n             scrollTop = table.parent().scrollTop();\n             scrollLeft = kendo.scrollLeft(table.parent());\n\n            kendo.focusElement(table);\n\n            kendo.scrollLeft(table.parent().scrollTop(scrollTop), scrollLeft);\n\n          } else {\n             $(table).one(\"focusin\", function(e) { e.preventDefault(); }).trigger(\"focus\");\n          }\n        }\n\n        function adjustRowHeight(row1, row2) {\n           var height;\n           var offsetHeight1 = row1.offsetHeight;\n           var offsetHeight2 = row2.offsetHeight;\n\n           if (offsetHeight1 > offsetHeight2) {\n               height = offsetHeight1 + \"px\";\n           } else if (offsetHeight1 < offsetHeight2) {\n               height = offsetHeight2 + \"px\";\n           }\n\n           if (height) {\n               row1.style.height = row2.style.height = height;\n           }\n        }\n\n        function isColumnEditable(column, model) {\n            if (!column || !model || !column.field || column.selectable || column.command || (column.editable && !column.editable(model))) {\n                return false;\n            }\n\n            return (column.field && model.editable && model.editable(column.field));\n        }\n\n        function isDirtyColumn(column, model) {\n            var field = (column || {}).field || \"\";\n            return (model.dirty && model.dirtyFields && model.dirtyFields[field] && isColumnEditable(column, model));\n        }\n\n        function isUndefined(value) {\n            return typeof(value) === \"undefined\";\n        }\n\n        function isNumber(value) {\n            return typeof value === \"number\" && !isNaN(value);\n        }\n\n        if (kendo.ExcelMixin) {\n            kendo.ExcelMixin.extend(TreeList.prototype);\n        }\n\n        if (kendo.PDFMixin) {\n            kendo.PDFMixin.extend(TreeList.prototype);\n\n           TreeList.prototype._drawPDF = function(progress) {\n               var treeList = this;\n\n               if (treeList.options.pdf.paperSize && treeList.options.pdf.paperSize != \"auto\") {\n                   return treeList._drawPDF_autoPageBreak(progress);\n               }\n\n               var result = new $.Deferred();\n               var dataSource = treeList.dataSource;\n               var allPages = treeList.options.pdf.allPages;\n\n               this._initPDFProgress(progress);\n\n               // This group will be our document containing all pages\n               var doc = new kendo.drawing.Group();\n               var startingPage = dataSource.page();\n\n               function resolve() {\n                   if (allPages && startingPage !== undefined$1) {\n                       dataSource.unbind(\"change\", exportPage);\n                       dataSource.one(\"change\", function() {\n                           result.resolve(doc);\n                       });\n\n                       dataSource.page(startingPage);\n                   } else {\n                       result.resolve(doc);\n                   }\n               }\n\n               function exportPage() {\n                    treeList._drawPDFShadow({\n                        width: treeList.wrapper.width()\n                    }, {\n                        avoidLinks: treeList.options.pdf.avoidLinks\n                    })\n                    .done(function(group) {\n                        var pageNum = dataSource.page();\n                        var totalPages = allPages ? dataSource.totalPages() : 1;\n\n                        var args = {\n                            page: group,\n                            pageNumber: pageNum,\n                            progress: pageNum / totalPages,\n                            totalPages: totalPages\n                        };\n\n                        progress.notify(args);\n                        doc.append(args.page);\n\n                        if (pageNum < totalPages) {\n                            dataSource.page(pageNum + 1);\n                        } else {\n                            resolve();\n                        }\n                    })\n                    .fail(function(err) {\n                        result.reject(err);\n                    });\n                }\n\n                if (allPages) {\n                    dataSource.bind(\"change\", exportPage);\n                    dataSource.page(1);\n                } else {\n                    exportPage();\n                }\n\n                return result.promise();\n            };\n\n            TreeList.prototype._initPDFProgress = function(deferred) {\n                var loading = $(\"<div class='k-loading-pdf-mask'><div class='k-loading-color'></div></div>\");\n                loading.prepend(this.wrapper.clone().css({\n                    position: \"absolute\", top: 0, left: 0\n                }));\n\n                this.wrapper.append(loading);\n\n                var progressBar = $(\"<div class='k-loading-pdf-progress'>\")\n                    .appendTo(loading)\n                    .kendoProgressBar({\n                        type: \"chunk\",\n                        chunkCount: 10,\n                        min: 0,\n                        max: 1,\n                        value: 0\n                    }).data(\"kendoProgressBar\");\n\n                deferred.progress(function(e) {\n                    progressBar.value(e.progress);\n                })\n                .always(function() {\n                    kendo.destroy(loading);\n                    loading.remove();\n                });\n            };\n\n            TreeList.prototype._drawPDF_autoPageBreak = function(progress) {\n                var treeList = this;\n                var result = new $.Deferred();\n                var dataSource = treeList.dataSource;\n                var allPages = treeList.options.pdf.allPages;\n                var origBody = treeList.wrapper.find('table[role=\"treeList\"] > tbody');\n                var cont = $(\"<div>\")\n                    .css({ position: \"absolute\", left: -10000, top: -10000 });\n                var clone = treeList.wrapper.clone().css({\n                    height: \"auto\", width: \"auto\"\n                }).appendTo(cont);\n                clone.find(\".k-grid-content\").css({ height: \"auto\", width: \"auto\", overflow: \"visible\" });\n                clone.find('table[role=\"treeList\"], .k-grid-footer table').css({ height: \"auto\", width: \"100%\", overflow: \"visible\" });\n                clone.find(\".k-grid-pager, .k-grid-toolbar, .k-grouping-header\").remove();\n                clone.find(\".k-grid-header, .k-grid-footer\").css({ paddingRight: 0 });\n\n                this._initPDFProgress(progress);\n\n                var body = clone.find('table[role=\"treeList\"] > tbody').empty();\n                var startingPage = dataSource.page();\n\n                function resolve() {\n                    if (allPages && startingPage !== undefined$1) {\n                        dataSource.one(\"change\", draw);\n                        dataSource.page(startingPage);\n                    } else {\n                        treeList.refresh();\n                        draw();\n                    }\n                }\n\n                function draw() {\n                    cont.appendTo(document.body);\n                    var options = $.extend({}, treeList.options.pdf, {\n                        _destructive: true,\n                        progress: function(p) {\n                            progress.notify({\n                                page: p.page,\n                                pageNumber: p.pageNum,\n                                progress: 0.5 + p.pageNum / p.totalPages / 2,\n                                totalPages: p.totalPages\n                            });\n                        }\n                    });\n                    kendo.drawing.drawDOM(clone, options)\n                        .always(function() {\n                            cont.remove();\n                        })\n                        .then(function(group) {\n                            result.resolve(group);\n                        })\n                        .fail(function(err) {\n                            result.reject(err);\n                        });\n                }\n\n                function renderPage() {\n                    var pageNum = dataSource.page();\n                    var totalPages = allPages ? dataSource.totalPages() : 1;\n                    body.append(origBody.find(\"tr\"));\n                    if (pageNum < totalPages) {\n                        dataSource.page(pageNum + 1);\n                    } else {\n                        dataSource.unbind(\"change\", renderPage);\n                        resolve();\n                    }\n                }\n\n                if (allPages) {\n                    dataSource.bind(\"change\", renderPage);\n                    dataSource.page(1);\n                } else {\n                    renderPage();\n                }\n\n                return result.promise();\n            };\n        }\n\n        extend(true, kendo.data, {\n            TreeListDataSource: TreeListDataSource,\n            TreeListModel: TreeListModel\n        });\n\n        ui.plugin(TreeList);\n        ui.plugin(TreeListPager);\n\n    })(window.kendo.jQuery);\n\n}));\n"]}