/**
 * Kendo UI v2023.1.117 (http://www.telerik.com/kendo-ui)
 * Copyright 2023 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(t){"function"==typeof define&&define.amd?define(["kendo.core.min","kendo.draganddrop.min"],t):t()}((function(){var t,e,r,n,a,i,o,d,s,l,g,c,u,p;t=window.kendo.jQuery,e=window.kendo,r=e.ui.Widget,n=e._outerWidth,a=e.attr,i=t.extend,o=t.each,d=!1,s="asc",l="group-sort",g=".kendoGroupable",c=function(r){var n=r.attr(e.attr("title"));return n&&(n=e.htmlEncode(n)),t('<div class="k-group-clue k-drag-clue" />').html(n||r.attr(e.attr("field"))).prepend('<span class="k-icon k-drag-status k-i-cancel"></span>')},u=t('<div class="k-grouping-dropclue"/>'),p=r.extend({init:function(o,p){var f,h,m=this,v=e.guid(),b=m._intializePositions.bind(m),k=m._dropCuePositions=[];r.fn.init.call(m,o,p),d=e.support.isRtl(o),h=d?"right":"left",m.draggable=f=m.options.draggable||new e.ui.Draggable(m.element,{filter:m.options.draggableElements,hint:c,group:v}),m.groupContainer=t(m.options.groupContainer,m.element).kendoDropTarget({group:f.options.group,dragenter:function(t){m._canDrag(t.draggable.currentTarget)&&(t.draggable.hint.find(".k-drag-status").removeClass("k-i-cancel").addClass("k-i-plus"),u.css(h,0).appendTo(m.groupContainer))},dragleave:function(t){t.draggable.hint.find(".k-drag-status").removeClass("k-i-plus").addClass("k-i-cancel"),u.remove()},drop:function(r){var n,a=r.draggable.currentTarget,o=a.attr(e.attr("field")),s=a.attr(e.attr("title")),g=a.attr("id"),c=m.indicator(o),p=m._dropCuePositions,f=p[p.length-1],h=i({},m.options.sort,a.data(l)),v=h.dir;(a.hasClass("k-group-indicator")||m._canDrag(a))&&(f?(n=m._dropCuePosition(e.getOffset(u).left+parseInt(f.element.css("marginLeft"),10)*(d?-1:1)+parseInt(f.element.css("marginRight"),10)))&&m._canDrop(t(c),n.element,n.left)&&(n.before?n.element.before(c||m.buildIndicator(o,s,v,g)):n.element.after(c||m.buildIndicator(o,s,v,g)),m._setIndicatorSortOptions(o,h),m._change()):(m.groupContainer.empty(),m.groupContainer.append(m.buildIndicator(o,s,v,g)),m._setIndicatorSortOptions(o,h),m._change()))}}).kendoDraggable({filter:"div.k-group-indicator",hint:c,group:f.options.group,dragcancel:m._dragCancel.bind(m),dragstart:function(t){var e=t.currentTarget,r=parseInt(e.css("marginLeft"),10),a=e.position(),i=d?a.left-r:a.left+n(e);b(),u.css("left",i).appendTo(m.groupContainer),this.hint.find(".k-drag-status").removeClass("k-i-cancel").addClass("k-i-plus")},dragend:function(){m._dragEnd(this)},drag:m._drag.bind(m)}).on("click"+g,".k-button",(function(e){e.preventDefault(),m._removeIndicator(t(this).parent())})).on("click"+g,".k-link",(function(e){var r=t(this).parent(),n=r.attr(a("dir"))===s?"desc":s;r.attr(a("dir"),n),m._change(),e.preventDefault()})),f.bind(["dragend","dragcancel","dragstart","drag"],{dragend:function(){m._dragEnd(this)},dragcancel:m._dragCancel.bind(m),dragstart:function(t){var e;m.options.allowDrag||m._canDrag(t.currentTarget)?(b(),k.length&&(e=k[k.length-1].element,parseInt(e.css("marginRight"),10),e.position().left,n(e))):t.preventDefault()},drag:m._drag.bind(m)}),m.dataSource=m.options.dataSource,m.dataSource&&m._refreshHandler?m.dataSource.unbind("change",m._refreshHandler):m._refreshHandler=m.refresh.bind(m),m.dataSource&&(m.dataSource.bind("change",m._refreshHandler),m.refresh())},refresh:function(){var e,r=this,n=r.dataSource.group()||[],d=a("field"),s=a("title");r.groupContainer&&(r.groupContainer.empty(),o(n,(function(n,a){var o=a.field,l=a.dir,g=r.element.find(r.options.filter).filter((function(){return t(this).attr(d)===o}));e=r.buildIndicator(o,g.attr(s),l,g.attr("id")),r.groupContainer.append(e),r._setIndicatorSortOptions(o,i({},r.options.sort,{dir:l,compare:a.compare}))}))),r._invalidateGroupContainer()},destroy:function(){var t=this;r.fn.destroy.call(t),t.groupContainer.off(g),t.groupContainer.data("kendoDropTarget")&&t.groupContainer.data("kendoDropTarget").destroy(),t.groupContainer.data("kendoDraggable")&&t.groupContainer.data("kendoDraggable").destroy(),t.options.draggable||t.draggable.destroy(),t.dataSource&&t._refreshHandler&&(t.dataSource.unbind("change",t._refreshHandler),t._refreshHandler=null),t.groupContainer=t.element=t.draggable=null},events:["change","removeGroup"],options:{name:"Groupable",filter:"th",draggableElements:"th",messages:{empty:"Drag a column header and drop it here to group by that column"},sort:{dir:s,compare:null}},indicator:function(r){var n=t(".k-group-indicator",this.groupContainer);return t.grep(n,(function(n){return t(n).attr(e.attr("field"))===r}))[0]},buildIndicator:function(t,r,n,a){var i;return'<div class="k-group-indicator" data-'+(i={ns:e.ns,field:t.replace(/"/g,"'"),title:r,id:a,dir:n||(this.options.sort||{}).dir||s}).ns+'field="'+i.field+'" '+(i.id?"data-"+i.ns+"id="+i.id:"")+" data-"+i.ns+'title="'+(i.title||"")+'" data-'+i.ns+'dir="'+(i.dir||"asc")+'">\n                <a role="button" title="(sorted '+("asc"==(i.dir||"asc")?"ascending":"descending")+')" href="#" class="k-link">\n                    <span class="k-icon k-i-sort-'+("asc"==(i.dir||"asc")?"asc-sm":"desc-sm")+'" title="(sorted '+("asc"==(i.dir||"asc")?"ascending":"descending")+')"></span>\n                    '+(i.title?i.title:i.field)+'\n                </a>\n                <a href="#" role="button" data-role="button" aria-label="Remove grouping by '+(i.title||i.field)+' field" class="k-button k-button-md k-rounded-md k-button-flat k-button-flat-base k-icon-button">\n                    <span class="k-button-icon k-icon k-i-close"></span>\n                </a>\n             </div>'},_setIndicatorSortOptions:function(e,r){t(this.indicator(e)).data(l,r)},aggregates:function(){var r,n,a;return this.element.find(this.options.filter).map((function(){var i=t(this),o=i.attr(e.attr("aggregates")),d=i.attr(e.attr("field"));if(o&&""!==o)for(r=o.split(","),o=[],n=0,a=r.length;n<a;n++)o.push({field:d,aggregate:r[n]});return o})).toArray()},descriptors:function(){var r,n=this,a=t(".k-group-indicator",n.groupContainer),i=n.aggregates();return t.map(a,(function(a){a=t(a),r=a.attr(e.attr("field"));var o=n.options.sort||{},d=a.data(l)||{};return{field:r,dir:a.attr(e.attr("dir")),aggregates:i||[],colID:a.attr(e.attr("id")),compare:d.compare||o.compare}}))},_removeIndicator:function(t){var r=this;r.trigger("removeGroup",{field:t.attr(e.attr("field")),colID:t.attr(e.attr("id"))}),t.off(),t.removeData(),t.remove(),r._invalidateGroupContainer(),r._change()},_change:function(){var t=this;if(t.dataSource){var e=t.descriptors();if(t.trigger("change",{groups:e}))return void t.refresh();t.dataSource.group(e)}},_dropCuePosition:function(e){var r=this._dropCuePositions;if(u.is(":visible")&&0!==r.length){e=Math.ceil(e);var a=r[r.length-1],i=a.left,o=a.right,s=parseInt(a.element.css("marginLeft"),10),l=parseInt(a.element.css("marginRight"),10);return e>=o&&!d||e<i&&d?e={left:a.element.position().left+(d?-s:n(a.element)+l),element:a.element,before:!1}:(e=t.grep(r,(function(t){return t.left<=e&&e<=t.right||d&&e>t.right}))[0])&&(e={left:d?e.element.position().left+n(e.element)+l:e.element.position().left-s,element:e.element,before:!0}),e}},_drag:function(t){var e=this._dropCuePosition(t.x.location);e&&u.css({left:e.left,right:"auto"})},_canDrag:function(t){var r=t.attr(e.attr("field"));return"false"!=t.attr(e.attr("groupable"))&&r&&(t.hasClass("k-group-indicator")||!this.indicator(r))},_canDrop:function(t,e,r){var n=t.next();return t[0]!==e[0]&&(!n[0]||e[0]!==n[0]||!d&&r>n.position().left||d&&r<n.position().left)},_dragEnd:function(r){var n=this,a=r.currentTarget.attr(e.attr("field")),i=n.indicator(a);r!==n.options.draggable&&!r.dropped&&i&&n._removeIndicator(t(i)),n._dragCancel()},_dragCancel:function(){u.remove(),this._dropCuePositions=[]},_intializePositions:function(){var r,a=t(".k-group-indicator",this.groupContainer);this._dropCuePositions=t.map(a,(function(a){return a=t(a),r=e.getOffset(a).left,{left:parseInt(r,10),right:parseInt(r+n(a),10),element:a}}))},_invalidateGroupContainer:function(){var t=this.groupContainer;t&&t.is(":empty")&&t.html(this.options.messages.empty)}}),e.ui.plugin(p)}));
//# sourceMappingURL=kendo.groupable.min.js.map
